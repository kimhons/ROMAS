Use of image registration and fusion algorithms and techniques in
radiotherapy: Report of the AAPM Radiation Therapy Committee Task
Group No. 132
Kristy K. Brocka)
Department of Imaging Physics, The University of Texas MD Anderson Cancer Center, 1400 Pressler St, FCT 14.6048, Houston,
TX 77030, USA

Sasa Mutic
Department of Radiation Oncology, Washington University School of Medicine, St. Louis, MO, USA

Todd R. McNutt
Department of Radiation Oncology, Johns Hopkins Medical Institute, Baltimore, MD, USA

Hua Li
Department of Radiation Oncology, Washington University School of Medicine, St. Louis, MO, USA

Marc L. Kessler
Department of Radiation Oncology, University of Michigan, Ann Arbor, MI, USA

(Received 7 January 2016; revised 13 February 2017; accepted for publication 19 February 2017;
published 23 May 2017)
Image registration and fusion algorithms exist in almost every software system that creates or uses
images in radiotherapy. Most treatment planning systems support some form of image registration
and fusion to allow the use of multimodality and time-series image data and even anatomical atlases
to assist in target volume and normal tissue delineation. Treatment delivery systems perform registration and fusion between the planning images and the in-room images acquired during the treatment
to assist patient positioning. Advanced applications are beginning to support daily dose assessment
and enable adaptive radiotherapy using image registration and fusion to propagate contours and accumulate dose between image data taken over the course of therapy to provide up-to-date estimates of
anatomical changes and delivered dose. This information aids in the detection of anatomical and
functional changes that might elicit changes in the treatment plan or prescription.
As the output of the image registration process is always used as the input of another process for
planning or delivery, it is important to understand and communicate the uncertainty associated with
the software in general and the result of a specific registration. Unfortunately, there is no standard
mathematical formalism to perform this for real-world situations where noise, distortion, and complex anatomical variations can occur. Validation of the software systems performance is also complicated by the lack of documentation available from commercial systems leading to use of these
systems in undesirable ‘black-box’ fashion.
In view of this situation and the central role that image registration and fusion play in treatment
planning and delivery, the Therapy Physics Committee of the American Association of Physicists in
Medicine commissioned Task Group 132 to review current approaches and solutions for image registration (both rigid and deformable) in radiotherapy and to provide recommendations for quality assurance and quality control of these clinical processes. © 2017 American Association of Physicists in
Medicine [https://doi.org/10.1002/mp.12256]
Key words: adaptive radiotherapy, image fusion, image registration, quality assurance
d. Domain of transformation

TABLE OF CONTENTS

e. Interaction
1. INTRODUCTION

f. Optimization procedure
g. Modalities involved

a. Image data in radiotherapy
b. Use of image registration and fusion in radiotherapy
c. Clinical integration of image registration and fusion QA program
d. Glossary of terms
2. TECHNIQUES FOR IMAGE REGISTRATION
a. Dimensionality
b. Nature of registration basis

Med. Phys. 44 (7), July 2017

i. Limitations and challenges
3. CLINICAL ISSUES AND APPLICATIONS OF IMAGE
REGISTRATION IN RADIOTHERAPY
a. Sources of error due to data acquisition
b. Sources of error in registration
c. Image registration for segmentation

c. Nature of transformation

e43

h. Subject

0094-2405/2017/44(7)/e43/34

© 2017 American Association of Physicists in Medicine

e43

e44

Brock et al.: TG 132: Image registration

e44

d. Image registration for multimodality or adaptive treatment planning

ii. System end-to-end tests with physical phantom

e. Image registration for image-guided radiotherapy

iii. Digital phantom tests

f. Image registration for response assessment
4. METHODS FOR VALIDATION AND QUALITY ASSURANCE
a. General concepts
b. Qualitative evaluation of image registration and accuracy

iv. Example clinical data tests
b. Patient-specific registration verification during clinical practice
6. CLINICAL INTEGRATION OF REGISTRATION TECHNIQUES IN
TREATMENT PLANNING AND DELIVERY

c. Quantitative measures of image registration and accuracy

a. Treatment planning

d. Specific considerations of phantoms

b. Treatment delivery

e. QA at treatment planning

c. Treatment monitoring and adaptation

f. QA at treatment delivery
5. COMMISSIONING OF IMAGE REGISTRATION SOFTWARE
a. Commissioning
i. Software system specific validation

1. INTRODUCTION
1.A. Image data in radiotherapy
The practice of modern radiotherapy involves the quantitative use of several types of image data. Image data from
various modalities are used in treatment planning, treatment
delivery and treatment monitoring. In the process of treatment planning, X-ray computed tomography (CT) is typically used as the primary imaging modality to construct
detailed three dimensional anatomic and physical models of
the patient. These models are used to design beam arrangements and shapes, to calculate the dose delivered by these
beams and as a guide to position the patient for treatment.
Magnetic resonance imaging (MRI) techniques provide
exquisite soft tissue contrast for tissue delineation and estimates of physiologic and metabolic information. Nuclear
medicine imaging techniques such as positron emission
tomography (PET) and single photon emission computed
tomography (SPECT) provide dynamic data on physiologic
and metabolic process such as glucose metabolism and
DNA synthesis.
During the process of treatment delivery, volumetric x-ray
imaging technology has been incorporated into the treatment
rooms as kilovoltage (kV) and megavoltage (MV) CT imaging systems with fan-beam and cone-beam geometries. Realtime volumetric ultrasound (US) can also be used to localize
internal anatomy at the time of treatment. Research and
development is currently ongoing to enable integration of
real-time MR imaging directly with treatment machines. In
addition to general set up and target localization, these onboard images can also be used to monitor and track soft tissue
changes during therapy and to support plan adaptation.

d. Clinical case illustrations
7. CONCLUSIONS
8. APPENDICES
9. REFERENCES

1.B.1. Image registration for segmentation
Image registration is often used to segment (manually, semiautomatically, or automatically) target volumes and normal tissues through anatomical atlases or between images of the same
patient obtained at different time points (e.g., adaptation).
1.B.2. Image registration for multimodality or
adaptive treatment planning
Image registration and fusion are often used in treatment
planning to combine information obtained from different
imaging modalities (e.g., MR, PET, SPECT, and CT)
together for delineation of tumor volumes and/or normal tissues. Registration is also used to map regions of interest
delineations from one imaging study of the patient to another
or from a reference set of anatomical contours to a patientspecific image. Software systems that support adaptive radiotherapy use image registration and fusion to propagate dose
from 3D treatment images back to a reference (planning)
geometry, enable detection of anatomic and functional
changes that might elicit changes in the treatment plan or prescription, and provide up-to-date estimates of delivered dose.
1.B.3. Image registration for image-guided
radiotherapy
Treatment delivery systems use image registration and
fusion between images used for planning and images acquired
at the time of treatment to assist with patient positioning. Registration is required to determine the offset of the patient at the
time of treatment from the planned position. The transformation determined from the image registration is typically used to
perform an adjustment to the patient position.

1.B. Use of image registration and fusion in
radiotherapy

1.B.4. Image registration for response assessment

Image registration is the process of determining the geometric transformation that relates identical (anatomic) points
in two image series: a moving dataset (Study A) and a stationary source dataset (Study B). The main uses of image registration and fusion in radiotherapy can be categorized into
the following three essential steps.

The evaluation of treatment response also uses image registration between the images used for treatment planning and
those obtained at follow-up. Although registration is not
required for simple comparisons of tumor measurements,
more advanced assessment, e.g., changes in functional imaging, requires precision in image registration.

Medical Physics, 44 (7), July 2017

e45

Brock et al.: TG 132: Image registration

The requirements and challenges for timeliness and accuracy vary between the above four main uses. Image registration
for planning has relaxed time constraints, as the process typically spans several days. However, image registration at the
treatment delivery unit has high demands for timeliness, as the
patient is awaiting treatment. This includes registration for
treatment delivery and online treatment adaptation. Although
high levels of accuracy are expected in all applications, the
impact of inaccuracies often depends on the propagation of
that error. Registration errors made during treatment planning
will impact the entire treatment course, therefore resulting in a
high demand for accuracy. Registration errors made at an individual fraction of treatment delivery will likely impact the
delivery of that fraction only. For a treatment course with a
large number of fractions, the impact of an error at one fraction
will be less. Systematic errors in image registration or operator
error in the registration process may impact the delivery of all
treatment fractions. The impact of inaccuracies in adaptation
depends on the timing of the adaptation and the fraction of the
planned dose that will be delivered under the new plan.
1.C. Clinical integration of image registration and
fusion QA program
This task group recommends implementation of a formal
image registration quality assurance (QA) program in individual
facilities. The program should be guided and structured based
on the recommendations provided here with the considerations
described below. The main purpose of the program should be to
ensure accuracy and quality of individual patient image registration. The organization and expectations of the program should
be formally documented and the roles and responsibilities of
individual practitioners in this process should be defined. The
program should be managed by the Quality Assurance Committee (QAC). The program considerations should include:
1. Validation and quality assurance of image registration
and fusion at treatment planning, treatment delivery,
adaptive re-planning, and response assessment
2. Commissioning image registration and fusion software
to ensure accuracy of the tools used
3. Define/assign the role of each team member and tailor
workflow and tolerances appropriately depending on
the intended use of the image registration
4. Clinical verification of image registration for individual
patients.
It is intended that these recommendations will be used in
conjunction with other recommendations of the AAPM task
groups, as indicated in Fig. 1.
Details of the clinical implementation of this task group’s
recommendations can be varied for each specific institution and
depend on a broad scope of aspects which include: the individual clinical setting and resources, the purpose of image registration (Section 1.B), the timeline for an individual image
registration (when a registration is performed in the overall
treatment process), the time allotted for image registration (how
Medical Physics, 44 (7), July 2017

e45

quickly an image registration needs to be performed and verified), the capabilities of a specific registration software package, etc. Figure 1 shows a typical clinical implementation of
image registration process and the possible locations where
this and other task group’s recommendations are applicable.
The figure also shows image registration practices are likely
as diverse as any other process in radiotherapy and global
recommendations, which are universally applicable to all
individual applications, are impractical. The concepts
described here provide a general approach and framework
which individual facilities should consider to ensure that they
perform high-quality and safe radiotherapy. However, it is
ultimately the responsibility of the individual facilities and
their individual QAC to determine the appropriateness of recommendations provided here to their individual use cases
and the needs of their image registration program.
1.D. Glossary of terms
Image registration — the process of determining the geometric transformation that relates identical (anatomic) points
in two image series: a moving dataset (Study A) and a stationary source dataset (Study B).
Image fusion — the combined display of the mapped data
from the moving dataset with the stationary dataset.
Transformation — the function that is applied to the moving image (Study A) to align it to the stationary image (Study B).
Registration (or similarity) metric — quantifies the
degree to which the pair of imaging studies are aligned.
Rigid registration — a registration where the transformation preserves the distance between all points in the image. A
rigid registration can include translation in all directions as
well as rotations in all directions.
Affine registration — a registration that includes the transformations from rigid registration and adds the additional transformations of scaling, shearing, and plane reflection. The distance
between all points is not maintained, as in rigid registration, however parallel lines remain parallel after the transformation.
Deformable registration — a registration transformation
can also be spatially variant where the number of degrees of
freedom can be as large as three times the number of voxels
in the source dataset (e.g., a unique displacement vector for
every voxel in the source dataset).
2. TECHNIQUES FOR IMAGE REGISTRATION
A brief review of image registration and fusion algorithms is
presented here. However, for a comprehensive description, the
reader is referred to the literature.1–7 For generalization purposes,
the following nomenclature will be used throughout the report:
Study A and Study B will refer to any two image sets to be registered in which A is the moving dataset (e.g., the dataset that is
being transformed or deformed to match another image), while
B is the stationary dataset (e.g., the dataset that another image is
being registered to). It is important to note that these terms are
intentionally general as the radiotherapy application will dictate
which image is moving and which image is stationary. For

e46

Brock et al.: TG 132: Image registration

e46

FIG. 1. Image data and processing workflow in radiotherapy planning, treatment, and adaptation. Task Groups from the American Association of Physicists in
Medicine [TG]. [Color figure can be viewed at wileyonlinelibrary.com]

example, in radiation therapy treatment planning, if an MR
image is to be registered to the CT planning image, the MR
image is the moving image and the CT is the stationary image.
However, for adaptive radiotherapy, the original planning CT
may be the moving image and the mid-treatment CT the stationary image to enable the dose from the original CT to be mapped
onto the new CT. Transformation T will refer to the registration
matrix (rigid, affine, or deformable; as defined below) that will
describe where a point from the moving image maps on the fixed
image. A prime symbol will be used to denote the application of
the transformation matrix to the image set (e.g., Study A’ will
indicate the result of applying a transformation T to Study A to
create an image that is registered to Study B).
As summarized by Maintz and Viergever,8 registration is
defined by 9 criteria:
A. Dimensionality
B. Nature of registration basis
C. Nature of transformation
D. Domain of transformation
E. Interaction
Medical Physics, 44 (7), July 2017

F. Optimization procedure
G. Modalities involved
H. Subject
I. Object

2.A. Dimensionality
Images in radiotherapy can have a dimensionality of 2D or
3D. For generalization and comprehensiveness, the images
are assumed to be 3D; however, the same principles apply for
a 2D to 2D registration, only with fewer parameters reflecting
only translation in two dimensions and rotation in one dimension. Due to the inherent limitation in the data, 2D to 2D registration is generally limited to rigid registration in practical
applications.
2.B. Nature of registration basis
The nature of the registration basis, whether the registration is extrinsic, e.g., using invasive or noninvasive frames,

e47

Brock et al.: TG 132: Image registration

molds, or fiducials, or intrinsic, using image features or voxel
properties can simplify the registration and guide the user to
select the best registration metric.
A registration metric must be devised which quantifies the
degree to which the pair of imaging studies are aligned.
Using standard optimization techniques, the transformation
parameters are iteratively manipulated until this metric is
minimized or maximized, where the minimization or maximization of the metric corresponds to the best alignment of
the two images. Most registration approaches in use today
can be classified as either geometry-based or intensity-based.
Geometry-based metrics make use of features extracted from
the image data such as anatomic or artificial landmarks and
organ boundaries while intensity-based metrics use the image
voxel data directly.
2.B.1 Geometry or feature-based metrics
The most common geometry-based registration metrics
involve the use of point matching or surface matching. For
point matching, the coordinates of pairs of corresponding
points from Studies A and B [pA and pB in Eq. (1)] are used
to define the registration metric. These points can be anatomic landmarks or implanted or externally placed fiducial
markers. The registration metric R is defined as the sum of
the squared distances between corresponding points, where N
is the total number of points;
X
R¼
ðpA0  pB Þ2 =N.
(1)
In Eq. (1), the summation is over the number of matched
points or surface points, N, and the division of the summation
by N is to normalize the metric. To compute the rotations and
translations for a rigid transformation, a minimum of three
pairs of points are required. For affine transformations, a
minimum of four pairs of noncoplanar points are required.
Alternatively, surface matching does not require a one to
one correspondence of specific points but rather tries to maximize the overlap between corresponding surfaces extracted
from two image studies, such as the brain or skull surface or
pelvic bones. The surfaces from Study B are represented as a
binary volume or as a polygon surface and the surfaces from
Study A are represented as a set of points sampled from the
surface. The metric, which represents the degree of mismatch
between the two datasets, can be computed as the sum or
average of the squared distances of closest approach from the
points from Study A [pA’ in Eq. (2)] to the surfaces from
Study B (SB), where N is the number of points in Study A. It
is written as
X
R¼
distðpA0 ; SB Þ2 =N,
(2)
where dist(pA’, SB) computes the (minimum) distance between
point pA’ and the surfaces SB. In Eq. (2), the summation is
over the number of points, N, in Study A and the division of
the summation by N is to normalize the metric.
As a surface matching technique, Chamfer matching is
statistically similar to correlation; however, it is simplified to
Medical Physics, 44 (7), July 2017

e47

improve computational speed.9–12 In Chamfer matching, the
corresponding region in each image is segmented (either
automatically, often using thresholding techniques, or manually). The segmentation is then simplified into an image with
0 and 1 values indicating the edge of the segmented region.
The optimization is then performed to minimize the distance
between the two segmented surfaces.
2.B.2. Intensity-based metrics
To overcome some of the limitations of using explicit geometric features to register image data, another class of registration metrics has been developed which uses the numerical
grayscale information directly to measure how well two studies are registered. These similarity metrics are also referred to
as similarity measures as they determine the similarity
between the distributions of corresponding voxel values from
Study B and a transformed version of Study A (e.g., A’). Several mathematical formulations are used to measure this similarity. The more common similarity measures in clinical use
include: sum of squared differences, cross-correlation, and
mutual information.
The sum of squared differences (SSD)13–17 metric is computed as the average squared intensity (IA and IB) difference
between Study A and Study B, where N is the number of voxels evaluated.
SSD ¼

X
ðIA0  IB Þ2 =N.

(3)

In Eq. (3), the summation is over the number of voxels
evaluated, N, and the division of the summation by N is to
normalize the metric. This metric is simple to compute and is
effective for registering two imaging studies which have
essentially identical intensities for corresponding anatomy,
such as serial or 4-D CT data.
An alternative technique is the use of the cross-correlation
(C)18–23 metric, which measures the similarity in the image
signal. Rather than minimizing the intensity difference,
cross-correlation registration maximizes the intensity product, as shown in 4A. The limitation of this metric is that it is
sensitive to the changes in the voxel value (increases in the
intensity values of one image increases the cross-correlation).
C¼

X
~
x

~Þ  TðAðx
~ÞÞ
Bðx

(4A)

To overcome these limitations, the normalized version of
the cross-correlation metric (correlation coefficient) can be
used, which is shown in Eq. (4B). The assumption in the correlation coefficient is that there is a linear relationship
between the intensity values in each image, therefore, this
metric can handle differences in image contrast and brightness in the image.
P


~Þ  AÞðTðBðx
~ÞÞ  BÞ
ðAðx
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ﬃ
q
(4B)
CC ¼ P ~x
2P
2


~Þ
~ÞÞ
~
~
x ðAðx  AÞ
x ðTðBðx  BÞ

e48

Brock et al.: TG 132: Image registration

e48

For data from different modalities where the pixel intensities of corresponding anatomy are typically (and inherently)
different, registration metrics based on simple differences or
products of intensities are not effective. In these cases,
sophisticated metrics based on intensity statistics are more
appropriate. When using these metrics, there is no dependence on the absolute intensity values. One such metric that
has proven very effective for registering image data from different modalities is called mutual information (MI).24–43
Mutual information seeks to align voxels whose values have
common probabilities of being present in their respective
image sets. In Eq. (5), the summation is over the intensity
levels in image A’ (IA’) and Image B (IB), where p(IA’) and p
(IB) are the probability distribution functions of the intensities
IA’ and IB, respectively and p(IA’, IB) is the joint probability
distribution function.
MIðIA0 ; IB Þ ¼

XX
B

PðIA0 ; IB Þ log2 ½pðIA0 ; IB Þ=pðIA0 ÞpðIB Þ

A

(5)
Commonly used similarity metrics are listed in Table I.
2.C. Nature of transformation
Image registration algorithms require four components: a
geometric transformation T, a registration metric (described
above in B), an optimizer (described below in F) which drives
the algorithm to find the best result of the registration metric
such as maximization of mutual information between A’ and
B, as illustrated in Fig. 2, and finally image resampling and
application of the transformation.
The fundamental task of image registration is to find the
transformation T. The transformation T is applied to the moving image (Study A) to align it to the stationary image (Study
B). In general, this transformation can be written as
XB ¼ TðXA ; fbgÞ

(6)

where XA is the coordinate of the point in the moving dataset
A, XB is the coordinate of the same anatomic point in the stationary dataset B, and {b} is the set of parameters of the
transformation. The output of the image registration process
is the parameters {b} for a particular pair of imaging studies
(Fig. 2). The number of the parameters required to determine

FIG. 2. Basic mechanics of image registration algorithms.

the transformation depends on the form of T, which in turn
depends on the anatomical site, clinical application, and the
imaging modalities involved. The transformation Τ can be
simple, representing a rigid body, consisting of three translation and three rotation parameters (referred to as rigid registration). This can be expanded to nine or twelve parameters
to account for affine transformation (e.g., accounting for scaling, shearing, and plane reflection). The transformation can
also be spatially variant where the number of degrees of freedom can be as large as three times the number of voxels in
the source dataset (e.g., a unique displacement vector for
every voxel in the source dataset), referred to as deformable
registration. Typically, these spatially variant vector fields are
constrained by a regularization function to ensure that they
represent an anatomical and physiologically realistic transformation. A regularization function is used to restrict unrealistic motion and to generate a smooth deformation field (i.e.,
classifying a region as bone and restricting the degree of
deformation in this region). Commonly used image registration transformation algorithms are listed in Table II, organized by class of transformation: those that have a physical
basis for the transformation and those that are a geometric
construct. The registration matrix resulting from a deformable registration is often referred to as a deformation vector
field, as there can be a unique 3D transformation for each
image voxel.
Ideally the transformation T is invertible, but that is not
always the case in complex cases (tissue that is only present
in 1 of the images) or for transformations that are not well
behaved (e.g., the transformation is significantly different
when mapping A to B and B to A). Therefore, the user must
consider the purpose of the registration and how the

TABLE I. Similarity metrics.
Class
Voxel intensity-based

Feature-based

Metric

Description

Sum of the squared difference (SSD)
(Mean squared difference, MSD)

Assumes an equivalent relationship between voxel intensities in 2 images, single modality

Correlation coefficient (CC)

Assumes linear relationship between voxel intensities in 2 images, single modality or possibly
small region of multimodality

Mutual Information (MI)

Assumes statistical relationship between voxel intensities in 2 images, single or multimodality

Point-based

Assumes direct relationship between points identified on 2 images, single or multimodality

Contour-based

Assumes direct relationship of identified boundaries of regions of interest in 2 images, single
or multimodality

Medical Physics, 44 (7), July 2017

e49

Brock et al.: TG 132: Image registration

e49

TABLE II. Commonly used transformation models. (N = number of voxels in an image).

Class
Geometric

Physical

Transformation

Maximum dimensionality of
transformation

Description

Rigid

6

Allows translation in 3 directions and rotations about 3 axes

Affine

12

In addition to translation/rotation, allows uniform scaling
and sheer (e.g., parallel lines stay parallel)44–48

Free-form

3N

Local, voxel-based deformation, often regularized by a
smoothing parameter

Global spline-based methods (e.g., thin plate splines)

3N

Parameterizes deformation using a parametric grid of basis
function control points with constrained global influence
(e.g., deformation is global)34,49–66

Local spline-based methods (e.g., B-spline)

3N

Parameterizes deformation using a weighted grid of control
points of basis functions with local influence
(e.g. deformation is local)17,67–101

Viscous/elastic/optical flow (e.g., demons)

3N

Spatially variant voxel displacement voxel displacement by
a vector field in a deforming medium, by intensity gradients
(deformation is local)102–110

Finite element methods (FEM)

3N

Spatially variant voxel displacement voxel displacements
governed by biomechanical tissue properties
(deformation is local)55,92,111–135

transformation will be used to determine which direction the
transformation should be generated.
2.E. Interaction
It is prudent to acknowledge the role of the user in image
registration. The registration can be interactive, semiautomatic, or completely automated. Image registration can be,
and has been for many years, performed either completely
manually or with manual intervention. The role of the user
may be to provide an initial registration when two images
have a substantial (i.e., several cm) shift or to adjust the output of the image registration when the user does not feel that
an optimal solution has been found. The manual adjustment
of the registration following automated registration should be
restricted to rigid registration. The direct, unguided manual
adjustment of a deformation vector field is not recommended
and could lead to erroneous results that are not obvious, however iterative refinement or principled adjustment may aid in
achieving a realistic and more accurate registration.

algorithms are used from gradient-based methods that
employ the gradient of the similarity metric with respect to
the transformation parameters to best choose search directions to more stochastic methods that randomly sample the
search space in a controlled fashion. Another important
attribute of the optimizer is in how it manages parameter
constraints. For example, in deformable image registration,
a smoothness constraint may be applied to ensure that a
deformation map does not contain any high frequency
deformations that are unrealistic. To do this, the transformation parameters themselves will be constrained, and the
optimizer has to be able to handle these constraints without
generating instabilities in the overall optimization process.
Several such considerations are important to the optimization and are dependent on the type of transformation and
parameter constraints being used. It is important to understand the optimization approach used by your clinical solution to better appreciate how it converges and where it may
have pitfalls.
2.G. Modalities involved

2.F. Optimization procedure
A myriad of optimization methods are used in rigid and
deformable registration algorithms.136–146 The goal of the
optimization is to find the best set of parameters of the
transformation to obtain the best image alignment given by
the similarity metric. For image-based similarity metrics
most optimizers are iterative in nature and will repeatedly
try different transformation parameters until the resulting
value of the similarity metric converges to an optimal
value. The primary goal of the optimizer is to be efficient
by intelligently finding search directions through the
parameter space while also searching the entire parameter
space to find the most accurate solutions. Several
Medical Physics, 44 (7), July 2017

Image registration for radiotherapy applications often
involves several different imaging modalities including CT,
PET, SPECT, MR, ultrasound, CBCT, an MVCT. Image registration can therefore be between two images of the same
modality or between images of different modalities.
2.H. Subject
Image registration can also be performed between images
of the same subject, between images of different subjects, or
between an atlas and an individual patient. Image registration
between images of the same subject is most common in
radiotherapy; however, between images of different subjects

e50

Brock et al.: TG 132: Image registration

can be useful to characterize disease or motion across a population. Registration between patient images and an atlas can
also be performed for segmentation purposes.
2.I. Limitations and challenges
Restricting the registration of two images to simple rigid
transformations is often met with remaining uncertainties due
to the deformable nature of soft tissue. However, at the present time, the majority of radiotherapy clinics are limited to
rigid registration at treatment planning and delivery. In these
cases, the user should make tradeoffs to optimize the registration in a way that reduces the uncertainties in the most important regions for the task and account for the uncertainties as
appropriate for the clinical care.
Even when deformable registration is available for use,
limitations and challenges remain. Regardless of which algorithm is chosen, deformable registration is ill-defined and
over-constrained. All algorithms use a model to describe the
deformation and as a result will have limitations. For example, many deformable registration algorithms assume
smoothness of the vector field. This expectation will lead to
registration error when singularity of the vector field exists,
such as when registering an open mouth to a closed mouth,
an image with a vaginal applicator to one without, or when
registering two images where a structure is present in one and
not in the other. The large numbers of degrees of freedom in
deformable registration may lead to ambiguity in the deformation vector field for some algorithms, such as areas with
very low tissue contrast and registration in these areas can be
prone to inaccuracies.147,148

3. CLINICAL ISSUES AND APPLICATIONS OF
IMAGE REGISTRATION IN RADIOTHERAPY
3.A. Sources of error due to data acquisition
The extent, scan parameters, and the quality of individual
imaging studies can affect the accuracy of their registration
with other studies.

• Extent: A potential complication exists when the physi-

cal extent of two studies to be registered are significantly different, leading to limited volumes available for
registration and evaluation of its accuracy. The limited
extents are typically in patient’s cranio-caudal direction,
where one study is shorter than the other, but with MR
acquisitions, the limited extent can be in all directions,
particularly with nonaxial plane acquisitions.
• Scan Parameters: Scan parameters of the registered
imaging studies affect the integrity (sampling/resampling effects) and the size of their voxels (resolution).
The voxel integrity can be a problem with MR studies
where images acquired in oblique volumes with rectangular voxels need to be significantly manipulated and
resampled to match the axial orientation of the CT
study. Spatial resolution of PET images can be lower
Medical Physics, 44 (7), July 2017

e50

than that of CT or MR studies and can lead to significant resizing and resampling which in turn can affect
the values of reconstructed voxels.
• Quality: Images of some registered studies can be noisy
and of poor quality (by design, e.g., to limit dose, or
due to confounding factors, e.g., motion during scanning) leading to a difference in the appearance of
images being registered.
The above examples demonstrate the natural variability
and possible alterations of imaging studies being registered.
Due to the potential and unpredictability of imaging data, it is
important to evaluate the appearance of registered studies as
well as the registration accuracy for each individual registration. Solutions to address these issues will vary based on
extent of the image alteration, options available in the registration system, and the subsequent use of the registered
image.
3.B. Sources of error in registration
The process of registration can introduce uncertainties, so
it is therefore important that quality assurance and quality
control techniques are designed to understand, evaluate,
reduce, and account for these uncertainties. Sources of error
can generally be divided into input, algorithm, and output.
Uncertainties in the images, the input to the registration,
can cause error in the image registration. Artifacts are a common source of uncertainties in images. Image artifacts can be
due to the anatomy (such as dental fillings or stents) or
motion (e.g., breathing, peristalsis, heartbeat). These image
artifacts limit the geometric fidelity of the image by presenting inconsistent anatomy and can lead to errors in the registration. Artifacts in the image due to acquisition (e.g., MR
distortion, lack of calibration of the imaging equipment) can
also cause errors in the registration. Care should be taken to
calibrate the imaging equipment, select the most optimal
imaging parameters for acquisition, and avoid anatomy-based
artifacts. Other information in the images that are not artifacts
can be a source of error, such as large changes in the anatomy
between images (e.g., response to therapy or weight loss).
Large changes in the tissue especially in areas that lack information (e.g., features and contrast variation) can be especially
prone to errors in the registration.
The image registration algorithm can also be a source of
error. Optimal selection of the main algorithm components,
e.g., similarity metric, transformation model, and optimizer,
can aid in mitigating these errors. Using too many or too few
degrees of freedom can cause errors in the algorithm. Poorly
designed optimizers can result in the algorithm finding a
solution in local minima instead of the global minima. Uncertainties in the selection of features or the manual contouring
of structures that drive the registration can also be a source of
error. Limitations in the model used for the registration can
cause errors, such as the inability to handle tissue interfaces
that are sliding (e.g., the lung sliding along the rib cage) or
tissue loss or gain (e.g., weight loss/gain or tumor response).

e51

Brock et al.: TG 132: Image registration

Models with limited capabilities can introduce error when
registering images that show complex changes.
Finally, the use of the registration, the output, can be a
source of error. Incorrect interpolation of the registration
results can cause error as well as improper extrapolation of
the registration field of view. Invalid use of the registration
results can also be a source of error for downstream processes, such as contour propagation, dose accumulation, or
image guidance.
3.C. Image registration for segmentation
One motivation for registering imaging studies is to be
able to map information derived from one study to another
(e.g., for image segmentation) or to directly combine or fuse
the imaging data from the studies to create displays that contain relevant features from each modality. For example, a references image, with all relevant anatomy, can be registered to
a patient-specific image, and the contours can then be copied
onto the patient-specific image. In another example, a tumor
volume more clearly visualized using MR can be fused with
the CT used for treatment planning. If the geometric transformation between the MR study and the treatment planning CT
study is known, the clinician is able to outline the tumor on
the MR and map these outlines to the CT for planning. This
process is called structure mapping and is illustrated in
Fig. 3. This process can also be performed between two
images for the purposes of propagating the set of contours on
one image to the other image.
If the registration involves rotation and translation, the
contours from the secondary image cannot be directly overlaid onto the primary as the image slices do not align. A surface representation of the target volume can be constructed
by tessellating or “tiling” the 2-D outlines. Using the computed transformation, the vertices of the surface are mapped
from the coordinate system of the secondary image to the
coordinate system of the primary image. The transformed surface can be inserted along the image planes of the primary
study. The result is a set of outlines of the secondary image
defined structure that can be displayed over the primary
images. These derived outlines can be used in the same manner as other outlines drawn directly on the primary images.

e51

The goal of the reformatting and interpolation is to create
a version of Study A (Study A’’) with images that match the
size, location, and orientation of those in Study B. The voxel
values for Study A’’ are determined by transforming the coordinates of each voxel in Study A using the appropriate registration transformation (producing Study A’) and interpolating
between the surrounding voxels and reformatting to match
Study B (producing Study A’’). The result is a set of images
from the two studies with the same effective scan geometry.
These corresponding images can then be combined or fused
in various ways to help elucidate the relationship between the
data from the two studies or enable delineation of anatomy on
the fused images, including the use of overlays, pseudo-coloring, and modified grayscales. For example, functional information from a PET imaging study can be merged or fused
with the anatomic information from an MR imaging study
and displayed as a colorwash overlay.
In addition, 3D dose distributions computed in the coordinate system of one imaging study can be mapped to another
(e.g., doses computed on the treatment planning CT can be
displayed on an MR).
3.D. Image registration for multimodality or
adaptive treatment planning
Image registration is necessary when integrating multimodality images (e.g., CT, MR, PET, and/or CBCT) into
treatment planning and plan delivery. The necessary output
of this registration is a transformed image that is in the same
geometric position as the reference image. The use of multiinstance imaging (e.g., inhale and exhale CT) may also
require registration to obtain the motion and/or deformation
that is exhibited by the tumor and surrounding critical structures for incorporation into the planning process and dose
calculation. In this case, it is the transformation, rather than
the transformed image, that is needed.
The complexity of the multimodality image registration
depends on the complexity of the variations in anatomy,
including motion and anatomical changes, between the imaging sessions or acquisitions. In some instances, the imaging
hardware can be joined (i.e., a PET-CT scanner, SPECT-CT,
or PET-MR). This does not guarantee perfect alignment,

FIG. 3. Structure Mapping. (a) Tumor volume outlined on a secondary image (e.g., MR in this case). (b) Outlines stacked and tessellated to create a surface representation.149 (c) The MR-based surface is mapped to the CT coordinate system and resliced along the image planes of the CT study. (d) The derived contours are
displayed over the CT images. [Color figure can be viewed at wileyonlinelibrary.com]
Medical Physics, 44 (7), July 2017

e52

Brock et al.: TG 132: Image registration

however, as physiological processes (bladder filling, breathing, peristalsis, etc.) occur between the acquisitions, as well
as the possibility of small patient movements.
When the imaging hardware is not combined, some of this
complexity can be reduced in multimodality imaging by taking steps to maintain the same patient configuration between
imaging sessions (i.e., use the same immobilization device,
minimize the time interval between the acquisition of the
images to reduce certain physiological motions such as bladder and stomach filling). By taking these steps, it may be possible to use a simple image registration technique (e.g., rigid
registration or rigid registration on a limited field of view) to
achieve an acceptable accuracy. However, some issues cannot
be addressed through imaging protocols, such as the soft tissue deformation that occurs due to breathing motion, internal
organ distortion, and dramatic patient weight loss from planning to plan delivery, where, deformable image registration
may be required to achieve the desired level of accuracy.150
In addition, image registration is a useful tool to assist
with adaptive re-planning, where anatomical changes that are
observed over the course of treatment require a modification
to the treatment plan to maintain the targeted therapeutic
intent and the normal tissue sparing. The complexity that
exists between the initial planning images and the image
acquired for adaptive replanning cannot be resolved by consistent immobilization as it is the shape, size, and position of
the anatomy that has changed. Deformable registration provides the ability to account for these changes and link these
two instances of the patient together.
3.E. Image registration for image-guided
radiotherapy (IGRT)
Image registration for IGRT is performed primarily to
guide patient positioning for individual treatment fractions.
Therefore, the necessary output of the registration, whether
the registration is simple (e.g., rigid) or complex (e.g.,
deformable), is a numerical transformation that will best align
the patient at the time of treatment to the representation of
the patient at the time of planning with respect to the treatment isocenter. The resulting transformed image may also be
used in image fusion for verification of the registration.
In addition, complex anatomical changes may occur
between planning and the treatment fraction, including
changes in the physiological state (e.g., bladder/stomach filling), changes in the gross patient position (e.g., neck flexion), or response of the tumor or normal tissue to treatment
(e.g., tumor volume reduction). The identification of these
changes can be facilitated through image fusion at the treatment fraction.
Both the measurement and the implementation of the measured correction are governed by the system and tools clinically available. Some IGRT-based registration systems allow
for the measurement of patient rotation in either one or all
three imaging planes. It is important to note that the measured
rotation is impacted by the selection of the point of rotation.

Medical Physics, 44 (7), July 2017

e52

The influence that the user has on the location of this point is
determined by the design of the algorithm and should be
investigated by the user prior to using these tools. With
advanced treatment hardware, such as a 6 DOF couch, the
measured rotations can then be corrected for by rotating the
couch. However, if a 6 DOF couch is not available, the user
can choose between rotating the table to correct for 1 rotational DOF, which is typically possible with most standard
equipment, or the user should determine how to best account
for the rotations with only a 3 DOF translation. Murphy provided an excellent technical comment addressing this issue,
which the reader is referred to for further information.151
3.F. Image registration for response assessment
The use of image registration to improve the assessment
of disease response is an active area of research at the time
of this report. Image registration for response assessment
can be performed during or following the completion of
radiation therapy. It is performed between images of the
same or different imaging modalities and the goals often
differ from those for treatment planning or guidance. As the
name indicates, the registration is performed to enable qualitative or quantitative evaluation of the response of the tumor
or normal tissue to radiation. Standard response metrics,
such as Response Evaluation Criteria in Solid Tumors
(RECIST),152 perform simple 2D measurements of the
tumor in its largest dimension. While these techniques are
simple and do not require registration, they also do not
incorporate the heterogeous and complex response of
tumors following irradiation. Response assessment in radiotherapy often requires a comparison of functional imaging
or analysis of soft tissue imaging beyond the RECIST criteria, which requires image registration. These cases challenge
image registration algorithms due to changes in the volume
and mass of the tissue of interest as well as large deformation in tissues. When deformable registration is performed
between two longitudinal images, the magnitude of response
can be evaluated from the deformation vector field. In addition, the complexity of the tumor and normal tissue
response can also be characterized by the deformation.153

4. METHODS FOR VALIDATION AND QUALITY
ASSURANCE
4.A. General concepts
It is important to clearly identify the terminology used to
describe the assurance of quality image registration. The following definitions will be used for this task group report,
consistent with the formal US Food and Drug Administration
(FDA) definitions.
Validation refers to the evaluation of the overall process
and toolset to ensure that accurate image registration can be
performed on a consistent basis for the intended use (e.g.,
contouring, image guidance, etc.).

e53

Brock et al.: TG 132: Image registration

Verification is the process of confirming that the accuracy
of a specific image registration is acceptable for the intended
use (e.g., is the registration of the patient’s MR and CT
accurate).
Quality Assurance is the procedures and process followed
to ensure maintenance of quality in each image registration.
Image registration errors can stem from multiple factors
such as image distortions, inability to reproducibly select
fiducial points represented in both image sets to be registered,
registration algorithm limitations, incorrect selection of registration algorithm parameters, etc. The ability to accurately
assess registration errors partially depends on the tools provided in the image registration software and the ability of the
user to interact with the registration results. Other considerations include spatial distortions (e.g., MR distortion) as well
as the final clinical endpoint for evaluated images. The overall image registration accuracy for the majority of clinical
applications, where an in-plane resolution is ~1 mm and slice
thickness is ~2–3 mm, is typically desired to be within
2 mm. Therefore, the registration evaluation process has to
be able to support this accuracy and evaluation tools need to
be able to detect registration errors in individual directions
that are smaller than the composite error.
The tools needed for registration validation and verification depend on the evaluation method. Software packages
used for image registration in radiotherapy should support
the methods described in section 4. Independent validation
of an application requires access to the geometric transformation. To facilitate this, the software should allow access
to and export of the registration matrix or deformation vector field following registration. This export should ideally
be in Digital Imaging and Communication in Medicine
(DICOM) format, but at minimum in a well-described,
easily accessible format. The choice of evaluation method
used for validation and verification depends on the specific
use of registered images as well as on the registered imaging modalities.
While the registration should be ultimately approved by a
trained member of the radiotherapy team prior to use of

e53

images, data integrity (i.e., the validity of the interpretation of
the image data into a visual image), and registration verification should be performed during each step of image processing and registration and should be the responsibility of the
entire radiotherapy team. The scope of the verification tests
will depend on the registered imaging modalities, capabilities
of the registration system, and the clinical purpose of image
registration. The achievable accuracy also depends on the
images being registered, their associated voxel size, the
degrees of freedom of the registration algorithm, and of
course, the amount of deformation between the two images.
4.B. Qualitative validation and veriﬁcation of image
registration accuracy
For initial commissioning of an image registration system,
quantitative validation is required; however, for patient-specific evaluation of image registration, quantitative verification is
not always possible due to limited time and resources and difficulty in determining the ground truth. In routine clinical
practice, qualitative verification of image registration should
be performed to ensure acceptability of the registration. Common techniques used to enable qualitative evaluation are
described and illustrated below in Fig. 5. These techniques
often rely on the visualization of image fusion.
Once the optimal transformation between a stationary
source and moving target dataset is determined (through the
identification of the maximum value of the similarity metric),
data from the moving dataset can be mapped to the stationary
dataset and combined or displayed on or with the stationary
dataset. This process is called fusion. An example is shown
in Fig. 4.
These displays allow the individual to select the color
mapping, window and level and color blending methods that
best visualize the fused image sets. The appropriate use of
window/level in both images is critical for these assessments,
using different levels to visualize different aspects of the
anatomy. Inadequate display settings can blind the user to
otherwise obvious errors in registration. Appendix A

FIG. 4. An FDG PET image and a CT image, originally not aligned, underwent image registration (center) and image fusion (right). [Color figure can be viewed
at wileyonlinelibrary.com]
Medical Physics, 44 (7), July 2017

e54

Brock et al.: TG 132: Image registration

e54

color maps and the fraction of reference and floating image
in the blended display.
4.B.3. Difference image displays

(a)

(b)

(c)

(d)

(e)
FIG. 5. (a) Image–image visual validation using split screen displays of
native MR and reformatted CT study. (b) Region of interest delineation overlaid on a fused PET and CT. Contoured are target volumes as identified on
PET image and pelvic and vertebral bones as delineated on CT images. (c)
Image geometry visual validation structure overlay of CT defined brain outlines over MR images. (d) Side-by-side display with linked cursor. (e) Difference image showing good registration (e.g., solid blue) within the liver, the
area of interest, and more uncertainty in the bone and surface (e.g., yellow,
green, red color). [Color figure can be viewed at wileyonlinelibrary.com]

provides a table with site-based guidance of anatomical structures to use for validation of registration.
4.B.1. Split screen and checkerboard displays
Split screen, floating window (i.e., a window on Study B
that shows Study A’), and checkerboard displays as shown in
Fig. 5(a) are the most commonly used form of qualitative
visualization tool for detecting registration error in the clinical setting. They are particularly effective in identifying mismatches between corresponding structures at high contrast
tissue interfaces. The split screen partition and checkerboard
locations are typically a user-controllable aspect of these
displays.154
4.B.2. Image overlay displays
Image overlay displays as shown in Fig. 5(b) produce
images that are the blended composition of registered images.
Often the reference image is presented in gray scale color
map and the floating image is presented in a color scale. The
user is typically able to control the choice of grayscale and
Medical Physics, 44 (7), July 2017

Difference image displays are useful for intramodality visualization of registration accuracy (e.g., CT/CT, MR/MR). The
display is created by subtraction of coregistered voxel intensities. If the absolute value of the difference is used, a perfect
intensity match at the voxel level leads to a display level of 0
(black); as the mismatch gets worse, the color displayed for
the voxel gets brighter, approaching white. The utility of these
displays in the clinical setting is limited as they are very sensitive to the exact voxel values of the registered datasets.
4.B.4. Contour/structure mapping displays
Contour overlays as shown in Figs. 5(b) and 5(c) are useful for multimodality image registration. Anatomical contours
defined on one imaging modality can then be overlaid, in the
same spatial location, on the second imaging modality. Qualitative assessment of correlation of the contour to the anatomy
on the secondary image can aid in validating the registration
results, although this must be interpreted in the context of the
visibility of the anatomy.155,156

4.C. Quantitative measures of image registration
accuracy
4.C.1. Target registration error
The alignment of anatomical points is a simple and direct
way to quantify the accuracy of registration at a specific location. Increasing the number of points improves the validity of
the verification for the overall image registration. The technique is simple in theory, a set of landmarks for corresponding anatomic points are identified on Studies A and B and the
distance between the actual location of the points defined on
Study B and the resulting transformed locations of the points
from Study A’ is computed. This is often referred to as the target registration error (TRE), which is the average residual
error between the identified points on Study B and the points
identified on Study A, mapped onto Study A’ through image
registration.157 A ‘perfect’ registration at the location of the
landmark would result in the landmark being in the exact
same spatial location in both Study A’ and Study B, resulting
in a TRE of 0. In practice, it may be difficult to accurately
and sufficiently define the appropriate corresponding points,
especially when registering multimodality data. There will
always be some degree of uncertainty in the location of the
corresponding landmarks identified in each image, resulting
in a non-zero distance between the landmark identified on
Study A and Study B’, even after the highest quality image
registration. Studies have shown that the uncertainty in point
selection is typically less than the voxel size.34,116 Also, if
deformations are involved, the evaluation is not valid for
regions away from the defined points.

e55

Brock et al.: TG 132: Image registration

4.C.2. Mean distance to agreement and dice
similarity coefﬁcient
The alignment of anatomy or features (e.g., stents) delineated on Study B overlaid onto Study A’ can provide a qualitative assessment of the accuracy of registration. By
contouring the same structure on Study A’, a quantitative
assessment of the accuracy can be obtained. Under perfect
registration (and perfect delineation), the contour of the anatomy on Study B should perfectly match the contour on Study
A’. In practice, they will not perfectly match due to contour
variation. Contour variation depends on the imaging modality
and structure of interest. For example, Persson et.al. quantified the interobserver delineation variation to be 2.6 mm for
SBRT of peripheral lung tumors using a cross-sectional study
design,158 while Brouwer et al. reported a 3D variation about
3.9 mm in delineation of glottis larynx from head-and-neck
cancer patients.159 Interobserver variation is typically larger
than intraobserver variability,158–160 so when evaluating the
accuracy of a registration, having the same observer contour
the structure on both images will reduce the uncertainty in
the metric.
However, the discrepancy between the contours should
be within the variation of the observer contouring. Quantitative comparison between the contours can be performed
using multiple metrics. Two commonly used approaches are
the Dice similarity coefficient (DSC)161 and mean distance
to agreement (MDA),162 also referred to as the mean distance to conformity. DSC is defined as two times the volume where the two contours overlap divided by the total
volume of both contours combined. As the contours
approach agreement, the DSC value approaches 1; as the
volumes diverge into two nonoverlapping structures, the
DSC value goes to 0. At the time of publication, the calculation of DSC in commercially available registration systems
is not standard, although its inclusion in commercial software is a recommendation of this report. However, it is
often possible for the user to calculate this using Boolean
operators typically available. Given a structure image B
(struct_B), the same structure contoured on image A
(struc_A), and the mapping of struct_A onto Image B
through image registration (resulting in image A’ and
struct_A’ both in the geometrically registered space of
Image B) the DSC could be computed as follows: 2*
(struct_A’ AND struct_B)/(struct_A’ OR struct_B). To compute the mean distance to agreement, contour B would be
converted into a series of points and the distance of each
point to contour A’ would be computed. Contour A’ would
then be converted into points and the distance of each point
to contour B would be computed. The average of all distances would then result in the mean distance to agreement.
As with DSC, MDA is not a standard feature in commercial
registration, but recommended for inclusion. Using the same
structure definition described for DSC, the user can estimate
the MDA by manually measuring distances between
struct_A’ and struct_B and calculating the average of these
differences.
Medical Physics, 44 (7), July 2017

e55

4.C.3. Jacobian determinant
Mathematical functions are less commonly used to quantitatively evaluate image registration, often because their
interpretation is less clear. The Jacobian determinant can be
calculated following a deformable registration between two
images and evaluated. The Jacobian determinant identifies
the local volume change as a result of the registration. Jacobian determinants greater than 1 indicate volume expansion,
between 0 and 1 indicate volume reduction, a value of 1
indicates no change, and a value of less than or equal to 0
indicates nonphysical motion (e.g., regions of the image
folded onto itself). A Jacobian determinant of less than or
equal to zero clearly indicates an erroneous physical modeling of the patient and may indicate an error in the registration or a limitation in the algorithm to handle complex
deformation. Any negative values indicate an error in the
registration and these areas should be carefully evaluated for
their influence on the results and further applications of the
registration. However, some volume expansion and contraction is expected in some registrations (e.g., registering an
inhale to exhale lung). Large local changes in the Jacobian
determinant could also indicate a registration error (e.g.,
voxels in a small 2 9 2 region with a Jacobian of 10 while
surrounding voxels have a Jacobian of 1).
Additionally, the metrics used to drive registration (i.e.,
SSD, CC, and MI) can also be used to assess the registration
as long as the metric was not used in the registration algorithm itself. These metrics can be easily and efficiently
employed to assess the registration. However, it is difficult to
convert these metrics into quantitative measures of spatial
accuracy.
4.C.4. Consistency
In addition, quantitative metrics of consistency can be
performed. These do not provide direct verification, but do
provide evidence of a stable and well understood system.
These techniques include performing the registration in both
directions to ensure that the registration is inverse consistent, i.e., registering A to B and then B to A. The registration should be consistent in magnitude but opposite in
direction. When multiple images are to be registered, transitivity can be measured by performing the registration of A
to B and combining this with the registration results of B to
C. This combined registration result should be the same as
the registration of A to C.
The quantitative metrics are summarized in Table III.
As with the qualitative metrics, the tolerance listed is the
target tolerance for the registration. The multidisciplinary
team, including the physicist and physician, should evaluate if additional uncertainty beyond the tolerance should
be added to the uncertainty margin for the patient. This
will depend on the clinical protocol. Tolerances listed are
also for standard treatment, stereotactic radiosurgery tolerances are 1 mm, corresponding to the smaller voxel
dimension.

e56

Brock et al.: TG 132: Image registration

e56

TABLE III. Quantitative metrics to evaluate image registration.
Technique

Evaluation metric

Tolerance

Target registration error (TRE)

Point-based accuracy metric using implanted or naturally
occurring landmarks visualized on a pair of images

Maximum voxel dimension (~2–3 mm)

Mean distance to agreement (MDA)

Mean surface distance between 2 contours on registered images

Within the contouring uncertainty of the structure
or maximum voxel dimension (~2–3 mm)

Dice similarity coefficient (DSC)

Volumetric overlap of 2 contours on registered images

Within the contouring uncertainty of the structure
(~0.80–0.90a)

Jacobian determinant

Volume expansion or contraction resulting from a deformable
image registration

Consistency

Independence of an algorithm to the direction of the registration
(image A to image B or image B to image A)

No negative values, values deviating from 1 as
expected from clinical scenario (0–1 for structures
expected to reduce in volume, greater than 1 for
structures expected to expand in volume)
Maximum voxel dimension (~2–3 mm)

a

DSC calculations are dependent on the volume of the structure, therefore very large or very small structures may have different expected DSC values for contour uncertainty.

4.D. Speciﬁc considerations of phantoms
During commissioning of an image registration system,
phantoms can also be very useful to quantitatively assess the
accuracy of image registration. Phantoms can be physical
(tangible objects and their images can be acquired on various
scanners) or virtual (digital). For physical phantoms, the
unambiguous landmarks (e.g., implanted fiducial markers)
within the image can be mathematically erased (i.e., replacing
the high contrast voxel values of the landmark with the average voxel intensity of the surrounding voxels) to reduce the
bias of the image registration algorithm resulting from the
focus of the registration on that high contrast object. A benefit of physical phantoms is that they can be used to test the
entire image registration process, including image acquisition
with possible distortion and noise, data transfer and import,
and image registration. This process is representative of the
actual process that is used for patient imaging and image
registration.
Virtual phantoms are created or modified from patient
images in software. As such, virtual phantoms can be used to
test only the image registration process. In many situations, it
is desirable to have phantom images with precisely known
translations and rotations. Introduction of exact rotations and/
or translations in virtual phantoms is simple to apply and
extremely precise. Also, for digital phantoms, increasing
complexity can be generated by adding noise to the image to
simulate the realistic variation between image sets.
Both virtual and physical phantoms offer certain advantages and are useful for testing of image registration software
and processes. Phantoms can be classified as rigid or deformable and are used to evaluate the respective registration
algorithms. For rigid registration, either physical phantoms
(imaged, adjusted by a known amount, and reimaged) or digital (images that have a known displacement) phantoms can
be used. For deformable registration, physical phantoms
(with unambiguous points) and digital (images that have a
known deformation field applied) can be used. Further
Medical Physics, 44 (7), July 2017

classifications can be made based on imaging modality compatibility of individual phantoms. It is ideal to have a single
phantom that is compatible with all the imaging modalities,
which may be used for treatment planning of an individual
patient. The final classification is based on image registration
characteristics that can be evaluated with a specific phantom.
Generally, no single phantom is suitable for testing image
data integrity, spatial integrity (i.e., accurate dimensions of
the voxels and overall image), quality integrity (i.e., accurate
display of the voxel values), orientation (i.e., pose of the
patient), chirality (i.e., left–right designation in the presence
of symmetry), registration accuracy, deformation integrity,
and various other system functionalities.
As CT is the primary imaging modality in RT, it is convenient that all phantoms are compatible with CT and the whole
phantom including the shell and contents can be imaged
without any contrast agents. MR, PET, and SPECT require
specialized phantoms that can be filled with contrast agents
and often also require fiducial markers. Test objects contained in these phantoms can also be filled with contrast
agents (with typically different concentration than the background) or can just be solid objects. In many situations, these
phantoms can be designed so they are compatible with all
three imaging modalities: MR, PET, and SPECT. However,
PET and SPECT phantoms present unique challenges due to
radioactive contrast agents and multimodality imaging of
these phantoms requires careful planning.
Ultrasound phantoms are highly customized and can be
compatible with CT and/or MR. Certain clinical applications
require image registration of US and MR images as well.
Such phantoms can be created and generally perform very
well.
Also, either virtual or physical phantoms used for evaluating image registration accuracy can be classified into two
broad categories as geometrical (i.e., combinations of standard shapes) or anthropomorphic (i.e., representing human
anatomy). Well defined dimensions of geometric phantoms
make them suitable for testing the spatial integrity of image

e57

Brock et al.: TG 132: Image registration

registration processes, especially when coordinate transformation and voxel interpolation are involved. Geometric
shapes are generally easier to accurately position on an imaging device and translate and rotate in precise increments. The
main advantage of anthropomorphic phantoms is that they
have anatomical features. This is especially important for testing the accuracy of registration algorithms. Use of geometric
phantoms for these situations may oversimplify the problem
resulting in registration accuracy not obtainable in clinical
images. Digital anthropomorphic phantoms can be generated
based on clinical images (e.g., by applying a known deformation to a clinical image) or based on, but independent from,
clinical images (e.g., nonuniform rational b-splines
(NURBS)-based cardiac-torso (NCAT) phantoms163). They
are limited by the realism with which they represent human
anatomy and many features that are seen in human images
are impossible to reproduce in phantoms.
Anthropomorphic deformable phantoms have been developed to validate deformable registration algorithms, including
physical phantoms164–166 and digital phantoms. Physical
deformable phantoms are complex, requiring motors to
deform the shape and possible computer controllers to introduce deformations in a predictable manner. Deformable
phantoms are typically used for intramodality image registration, mainly kV-CT to kV-CT, CBCT, or MV-CT. Use of
deformable phantoms for multimodality image registration
adds complexity, requiring phantoms to have components
that are optimized for MR, PET, SPECT, and possibly US. It
is considered best practice to ensure that deformation model
used to create the digitally deformed image is not the same
model that the image set is being used to evaluate.
4.E. Quality assurance at treatment planning and
re-planning
It is important to note that during commissioning and software upgrade, there are comprehensive quantitative evaluations available because the user has the ground truth in
phantom data. There is no comprehensive ground truth when
dealing with deformable image registration in patients. Due
to this reason, there is no complete voxel-based quantitative
evaluation possible to find the true accuracy in patient registration. However, users should evaluate if the transformation
is “reasonable” and no obvious error or ill behaviors. Some
quantitative evaluations can be performed, such as using the
Jacobian determinant method, to screen the transformation
matrix for any ill behaviors, however, positive Jacobians do
not automatically guarantee the accuracy of the registration.
Alternatively, the landmark-based evaluation could be used to
evaluate the accuracy of the algorithm if the users can identify corresponding landmarks in two patient images. However, this does not guarantee that the areas without landmarks
or between landmarks will be as accurate as the landmark
registration indicates. Manual selection of landmarks also
carries some uncertainties, especially in low contrast regions.
The validity of the image registration during treatment
planning should be assessed following each registration, at a
Medical Physics, 44 (7), July 2017

e57

minimum using qualitative assessment tools described in section 4.B. When registration of a second image is used to
improve identification of the tumor, the user should evaluate
the registration accuracy of the tumor-bearing organ or
directly neighboring organs, especially in the case where the
tumor itself is not visible on one of the imaging modalities. If
the boundaries of the tumor-bearing or neighboring organs
are not well aligned (as quantitatively or qualitatively determined by the trained reviewer or clinician treating the
patient), the uncertainty of the registration (assessed through
quantitative or estimated through qualitative techniques)
should be included in the PTV margin. For example, in the
treatment planning of a liver tumor, if an MR image is being
registered to a noncontrast CT (where the tumor is not visible) to enable tumor delineation, the user should assess the
correspondence of the liver boundary. Qualitatively, this can
be performed by displaying the CT liver contour on the MR
and evaluating the accuracy of the alignment. Quantitatively,
the liver could be contoured on the CT and the MR and the
mean distance to agreement of the two contours could be calculated. However, it should be noted that alignment of the
boundary of an organ between two images does not guarantee
that the internal volume of that organ is aligned.
Special care should be used when applying a registration
result to a third image. For example, if the CT from a CTPET scanner is registered to an MR and the transformation is
subsequently applied to the PET from the CT-PET, the results
should be carefully evaluated. The user should ensure the
resulting alignment between the MR and PET is accurate,
including first evaluating the alignment of the images
obtained from the joined hardware system (e.g., the PET-CT)
and the feasibility of the applied registration (e.g., if high
activity from the PET is subsequently aligned into bone, this
could possibly indicate an area of misregistration).
The validation for treatment adaptation involves the same
components and process described above. Extra care should
be taken in the QA process and integration of the registration
information into the re-planning process as the anatomical
changes between the two images are often substantial and
pose a significant challenge to image registration algorithms.
4.F. Quality assurance at treatment delivery
The validity of the registration should be assessed prior to
treatment, at a minimum using qualitative assessment tools
described in section 4.A. In standard clinical practice, registration at treatment delivery is limited to rigid registration to
define a translational shift (and possibly a rotation) of the
patient to provide a best-fit registration to the planning position. It is often the case that a rigid registration does not align
all anatomy due to deformation (i.e., neck flexion in the treatment of a tumor in the head and neck, changes in stomach
filling in the abdomen, or changes in bladder/rectum filling
in the pelvis). Following the pretreatment rigid registration, at
minimum the alignment of the tumor and critical normal tissues should be qualitatively assessed. If large discrepancies
are observed the patient should be re-evaluated, repositioned,

e58

Brock et al.: TG 132: Image registration

or the physician should be consulted. Semiquantitative evaluation of the discrepancy between alignment of different tissues is also possible by focusing the registration (through the
use of a clip-box, ROI, etc.) on the tumor, then the normal tissues, and comparing the results of the registration. Retrospective assessment of these deviations over a population of
patients can help provide information for the generation of
planning organ at risk volume (PRV) and PTVs at planning.
AAPM Task Group 179 also provides excellent information
on the importance of QA at treatment delivery.167

5. COMMISSIONING AND VALIDATION OF IMAGE
REGISTRATION SOFTWARE
5.A. Commissioning
As outlined in the previous sections the image registration
process is susceptible to errors that can have a serious impact
in patient treatment or evaluation. Quality assurance (QA) of
the image registration process is essential for the validation of
post-transfer image data quality and spatial integrity, image
orientation and chirality (i.e., absence of image mirroring),
registration and/or deformation accuracy, and other system
functionality. As outlined in the AAPM TG53168 report, general commissioning and routine procedural quality assurance
checks of a multimodality image registration process used for
treatment planning are important to ensure accurate patient
treatments.
While it is impractical to address quality assurance of all
individual systems and features that are commercially available or developed in house, the tasks described here should
be essential elements to any image registration commissioning and quality assurance programs. The exact design of the
commissioning process and routine QA tests will depend on
individual system features and institutional goals. The overall
goal of each QA program should be to ensure that images
used for treatment planning, delivery, and evaluation are
accurately registered with remaining uncertainties accounted
for, free of spatial distortions, and that the overall image quality is preserved through various image manipulations. Furthermore, the QA process should ensure that propagation of
patient treatment planning data (contours, interest points,
dose distribution) through all image datasets used for plan
creation should be consistent and accurate.
Commissioning is performed to investigate the accuracy
and reproducibility of the image registration techniques for
all sites and imaging modalities prior to clinical use. There
are three methods recommended to assess registration results:
physical phantom system end-to-end tests, digital phantom
tests, and clinical data tests. A comprehensive commissioning
process should include all three components. Physical phantom tests enable end-to-end tests to ensure accurate data representation, image transfer, and integrity verification between
image acquisition devices, image registration systems, and
other radiotherapy systems that use the image registration
results. Digital phantoms enable controlled testing of the
image registration accuracy (this may also be performed with
Medical Physics, 44 (7), July 2017

e58

physical phantoms). Clinical data tests ensure final validation
of the accuracy of the system on examples of the images
expected in clinical use.
Recommendations from this report are summarized in
Table IV.
5.A.1. Software system speciﬁc validation
Validation of image registration software performance can
be divided into two broad areas, (a) validation of image transfer and data integrity between different systems and (b) validation of the actual image registration functionality and
accuracy. The data transfer integrity is also performed and
recommended as a part of general commissioning of treatment planning systems and imaging devices used in
RT.164,165 Changes in configuration of software or hardware
or upgrades of any scanner, computer, or network associated
with the RT planning have a potential of introducing errors
and disturbing established communications. Prior to upgrading or modifying any of the components, there should be a
communication regarding which processes may be disturbed
and appropriate arrangements should be made for end-to-end
testing following the changes. Chapter 7 of the AAPM TG53
report discusses in detail issues related to management of
treatment planning systems and networks. The RT QA program should identify individuals responsible for system management and should include tests for validation of proper
communication after system modifications. That component
of the comprehensive RT QA program should already be in
place based on AAPM TG53 and TG66 recommendations
and should satisfy the needs of a multimodality image registration program.
Previously, in Section 4.E, phantoms were described for
use in validation of image registration software. These phantoms can be classified as virtual or physical phantoms. Virtual phantoms can be used for performance of all tests
outlined in Table IV. These tests range from validation of
very basic rigid registration to more complex deformable registration and are the main focus of this report. Physical phantoms are needed for end-to-end tests and for validation of
data transfer integrity as they can be physically imaged on
various imaging devices and then images of these phantoms
can be transferred through the image registration process,
simulating the actual steps that are used for patient data
processing.
5.A.2. System end-to-end tests with physical
phantom
It is the recommendation of this task group that an end-toend test be performed during the commissioning, annually, at
an image acquisition device repair or replacement with the
potential to impact data integrity, or at each major image registration software upgrade, which is consistent with TG53168
and IAEA-430.169 The performance of end-to-end tests is a
critical component to ensure the accuracy and consistency of
the overall function of the image acquisition, registration, and

e59

Brock et al.: TG 132: Image registration

e59

TABLE IV. Quality metrics and tolerances for commissioning, annual QA, and patient-specific QA for image registration.
Use case
Commissioning, annual,
and upon upgrade

Each patient

Quality metric

Tolerance

Data transfer (including orientation, image size, and data integrity),
performed from end-to-end across the entire system using a
physics phantom

Exact

Rigid registration accuracy (digital phantoms, subset)

Baseline, see details in Table VI

Deformable registration accuracy (digital phantoms, subset)

Baseline, see details in Table VI

Example patient case verification ((including orientation,
image size, and data integrity) using real clinical case

Baseline, see details in Table VI

Data transfer

Exact

Patient orientation

Image data matches specified orientation (superior/inferior,
anterior/posterior, left/right)

Image size

Qualitative – no observable distortions, correct aspect ratio

Data integrity and import
Contour propagation

User defined per TG53 recommendations
Visual confirmation that visible boundaries are within
1–2 voxels of contours

Rigid registration accuracy

At planning: confirmation that visible, relevant boundaries of
anatomy in the registered images are within 1–2 voxels of the
registered image; additional error should feed into margins
At treatment: confirmation that visible boundaries are within
PTV/PRV margins (doesn’t account for intrafraction motion)

Deformable registration accuracy

At planning: confirmation that visible, relevant boundaries and
features of anatomy in the registered images are within
1–2 voxels of the registered image; additional error should
feed into margins; evaluate reasonableness of the deformation
vector field; perform quantitative evaluation if results are
questionable or if accuracy requirements are significant
(e.g., SBRT, dose mapping for critical tissues)
At treatment: confirmation that visible boundaries are within
PTV/PRV margins (does not account for intrafraction motion)

planning/delivery procedure. If the registration is a standalone system, integrated between other components, e.g., the
imaging devices and the treatment planning system, the endto-end tests ensure compatibility and accuracy. It is also the
recommendation of this task group that a simple end-to-end
test is performed annually. For smaller, single physicist clinics, this provides the opportunity to invoke a ‘time out’ for
validation. For larger clinics, it ensures that the overall process has not been altered without the knowledge of the physicist responsible for the registration component.
A multimodality (if necessary) physical phantom with
unambiguous internal landmarks and orientation should be
imaged on each scanner in head first supine, head first prone,
feet first supine, feet first prone orientations, and combination
of decubitus and head/feet first orientations. It is important
that each patient orientation be selected when programming
individual image acquisition sequences so the individual orientations of the phantom are listed in DICOM headers of
acquired images and then the correct identification and
manipulation of each patient (image) orientation by the image
registration software can be verified. The images should be
imported into the image registration software and the correct
orientation and image labeling should be verified. Image registration between individual devices should be performed
using standard clinical protocols. Accuracy of the registration

Medical Physics, 44 (7), July 2017

should be assessed by evaluating the registration of unambiguous landmarks in the phantom.
The reliability of image and other data communications
between different hospital systems has been greatly simplified
with wide acceptance of DICOM standard by various manufacturers. While these systems have come a long way, incompatibility and implementation differences of DICOM
standards among various manufacturers are still frequent
sources of errors, and image transfer tests should be performed to verify proper transfer and processing of DICOM
objects. These tests should verify that images transferred
from a scanner (CT, MRI, PET, SPECT), Picture Archiving
and Communication System (PACS), or treatment machine
preserves the following items in the receiving image registration system: pixel size, slice thickness and spacing, orientation (i.e., head/feet first, supine/prone, left/right), scan text
information, and voxel value.
Correct transfer and interpretation of image parameters
should be verified during the commissioning process and after
all software and hardware upgrades as well as for each individual patient. Often, secondary treatment planning datasets
are acquired at various outside institutions and evaluation of
data transfer from these systems cannot always be performed
during commissioning. Validation of such dataset transfer
should then be performed on an individual patient basis.

e60

Brock et al.: TG 132: Image registration

Validation of correct image geometry: Transfer of data
between systems that display images in different resolution or
apply transformations to pixel locations can affect image
geometry due to pixel averaging, down-sampling, and various
other reasons.
Validation of correct image geometry requires a phantom
with test objects spaced at known distances throughout the
phantom. The test involves scanning of the phantom with typical clinical protocols, image transfer, and measurement of
separations between the test objects. Validation should be
performed on each individual software package where contouring or treatment planning work is performed with the
evaluated images. The test objects should be placed so that
the correct image geometry can be evaluated in all three
dimensions. The measurements should be accurate to half the
size of the voxel in the measurement direction. It is important
to note that spatial distortions are not necessarily uniform and
may demonstrate only in one dimension. Validation of image
size in three dimensions ensures correct pixel size, slice thickness and spacing, and overall spatial fidelity. As already
described, MRI images may contain inherent spatial distortions, which should be separated from these tests. Other
imaging modalities should not contain detectable distortions.
The aim of the image geometry tests is to evaluate image
geometrical distortions due to data transfer between systems
and not the inherent image distortions. If significant distortions
are observed in the transferred data, it should be first validated
that these distortions are not present when viewing images on
the scanner console before proceeding with further testing. If
the distortions are inherent to the scanner, data transfer validation should be repeated after the problem is rectified.
Validation of correct image orientation: Validation of correct image transfer orientation should be performed for all
clinically used patient positioning orientations. A nonsymmetrical phantom or a phantom with fiducial markers should
be scanned with all the clinically used patient orientation
combinations. Typical combinations are head first/supine;
head first/prone, feet first/supine, feet first/prone, and combination of decubitus and head/feet first orientation. A successful test results in the correct right/left, head/feet (superior/
inferior), and anterior/posterior labeling assigned to the transferred patient images, and all graphical orientation indicators
are correct.
Commissioning is also the best time to establish routine
use of image orientation fiducials placed either permanently
on a scanner, a treatment machine couch, or directly on
patients. The use of such fiducials is strongly recommended
for all imaging procedures used in the RT patient treatment
process. Systematic use of orientation markers can reduce
likelihood of potentially serious treatment errors. The use of
such markers is relatively straightforward in CT; TG66 has
recommended that two thin aluminum wires be taped on the
bottom of the CT scanner tabletop to indicate patient orientation in CT images. The wires should be taped on the left or
Medical Physics, 44 (7), July 2017

e60

right side of the tabletop and along its entire length. The two
wires should also form the letter “V” which is pointing
toward the gantry. The letter “V” indicates patient’s scan orientation (Head/Feet first). The wires should be small enough
to avoid image artifacts. Such wires can be used on treatment
machine couches as well. Use of couch mounted markers for
MR, PET, and SPECT imaging is much more difficult due to
nature of image acquisition and patient-specific fiducials are
an optimal solution for these modalities.
Validation of correct image parameters and spatial
accuracy: Image files contain patient demographic information, image acquisition parameters, image orientation, voxel
size, voxel locations, and individual voxel values. While
DICOM standards greatly improve accuracy of transferred
image datasets, it is possible that one or several of the above
parameters can become corrupt or misinterpreted during
transfer.
5.A.3. Digital phantom tests
Digital phantoms can be developed in house or purchased
from vendors. The following digital phantom data, shown in
Table V, have been generated by this task group for use in
commissioning and quality assurance programs for image
registration accuracy tests. The datasets were generated using
ImSimQATM software (Oncology System Limited, UK (OSL,
www.imismqa.com)). The datasets, or equivalent datasets,
should be imported into the image registration software and
the tests outlined in Table IV should be performed. An alternating subset of these datasets should be used for testing
annually or at time of upgrades. Image registration using the
datasets in Table V should be performed in the clinical image
registration system, as necessary per clinical activity.
The following Table VI describes the tests and suggested
tolerances for the rigid and deformable registration accuracy
tests, for the digital phantom data described in Table V.
Deformable registration algorithms are currently an area of
active research and commercialization. The selection of these
tolerances was driven by the clinical experience of the task
group and published validation studies.94,105,170 For example,
a multi-institutional study on clinical 4D CT lung data
showed that 18 of the 21 participants could achieve a mean
absolute error of 2.0 mm or less and nine algorithms had a
maximum error of less than 5.0 mm in each direction.171 The
tolerances listed are goals. If an algorithm does not meet the
stated tolerance at commissioning, limitations should be
noted and expected uncertainties should be included in treatment protocols. Areas of larger expected uncertainties and
algorithm limitations should be communicated to the multidisciplinary team.
Evaluating the accuracy of the deformation phantom
should be performed using the DICOM deformation vector
field (DVF) files. As stated in Section 4.A, image registration
algorithms should export a DICOM DVF. The applied deformation is available on the AAPM website for the test

e61

Brock et al.: TG 132: Image registration

e61

TABLE V. Digital phantom dataset generated by ImSimQATM software (Oncology System Limited, UK (OSL, www.imismqa.com)).
Dataset

Description

Basic phantom dataset - 1

Reference dataset — HFS — black image with white and 3 shades of gray images. The voxel dimensions of all
basic phantom datasets are 0.7 9 0.7 9 3 mm. Cone pointing superior, semicircle on right side, cube anterior to
cylinder, 3 skin markers, and 3 internal markers, all in the same reference frame with defined perfect registration by
generation of images with the following parameters:
CT
PET
MRI T1-weighted (TR = 500 ms, TE = 12 ms)
MRI T2-weighted (TR = 4000 ms, TE = 120 ms)
CBCT (with noise added)

Basic phantom dataset - 2

Same as basic phantom dataset - 1 -CT - with the following offsets: to left = 1.0 cm, to anterior = 0.5 cm,
to inferior = 1.5 cm

Basic phantom dataset - 3
Basic phantom dataset - 4

Same as basic phantom dataset - 1 - CT - with the following offsets: to left = 0.5 cm, to anterior = 1.5 cm,
to inferior = 2.0 cm, rotation = 5° about X-axis, +8° about Y-axis, +10° along Z-axis
Same as basic phantom dataset - 1 - CT - except it is FFS

Basic phantom dataset - 5

Same as basic phantom dataset - 1 - CT - except it is HFP

Basic phantom dataset - 6

Same as basic phantom dataset - 1 - CT - except it is FFP

Basic anatomical dataset -1

Reference dataset – CT – HFS — the pelvis phantom provided by ImSimQATM software (oncology system limited,
UK (OSL)) with 3 markers in the region of bladder, prostate, and rectum. The voxel dimensions of the CT, CBCT, and
PET basic anatomical datasets are 0.91 9 0.91 9 3 mm. The voxel dimensions of the MR basic anatomical datasets
are 1.83 9 1.83 9 3 mm.

Basic anatomical dataset -2

Same as basic anatomical dataset -1 – CT - with offsets of: To left = 0.3 cm, to anterior = 0.5 cm, to inferior = 1.2 cm

Basic anatomical dataset -3

Same as basic anatomical dataset -1 - PET – HFS - with offsets of: to left = 0.3 cm, to anterior = 0.5 cm, to
inferior = 1.2 cm

Basic anatomical dataset -4

Same as basic anatomical dataset -1 - MR-T1 – HFS - with offsets of: to left = 0.3 cm, to anterior = 0.5 cm,
to inferior = 1.2 cm

Basic anatomical dataset -5

Same as basic anatomical dataset -1 - MR-T2 – HFS - with offsets of: to left = 0.3 cm, to anterior = 0.5 cm,
to inferior = 1.2 cm

Basic deformation dataset - 1

Same as basic anatomical dataset - 1 with added Gaussian noise variation and the following
global offsets: to left = 0.3 cm, to anterior = 0.5 cm, to inferior = 1.2 cm. Three markers were set inside the prostate,
rectum, and bladder regions, prostate volume increased by 105%, 10° rotation about X-axis, +10° rotation
about Y-axis, +10° rotation about Z-axis.

Clinical lung dataset – end
exhalation and end inhalation

DIR-Lab 4D CT dataset (end exhalation and end inhalation reconstruction only) with semiautomatically selected
bifurcation points (courtesy of the DIR-Lab, www.dir-lab.com/4DCT6.html)

HFS, head first supine; HFP, head first prone; FFS, feet first supine; FFP, feet first prone.

phantoms. The user should then subtract the DICOM images
for each direction (i.e., the LR, AP, and SI directions are individual DICOM files) and determine the percentage of voxels
that are within the tolerance.
5.A.4. Example clinical data tests
Once the standard operating level of the registration software is assessed using the end-to-end tests on the physical
phantoms and the comprehensive validation using the digital
phantoms, an evaluation of the registration accuracy should
be performed using example clinical datasets. These tests
should be designed based on the clinical protocols at each
institution using the quantitative and qualitative metrics
described in Sections 4.B and 4.C.
For example, if a clinical protocol is planned to use
deformable image registration to propagate contours defined
on one phase of a 4D CT onto all other phases of the 4D CT
for lung tumor planning, an example set of 4D CT images
should be collected from the clinic (e.g., 10 4D CT image sets
Medical Physics, 44 (7), July 2017

obtained from typical patients previously treated in the
clinic). The planned registration protocol should be performed on these 10 datasets and the results should be evaluated using the quantitative and qualitative verification
techniques described in Sections 4.B and 4.C. The magnitude of the registration uncertainties resulting from these tests
should be incorporated into the treatment protocols (e.g., into
the uncertainty margins).
5.B. Patient-speciﬁc registration veriﬁcation during
clinical practice
Even the most comprehensive commissioning of the
image registration algorithm cannot capture the entire scope
of registration challenges that will be encountered in the
clinic. A well-documented patient-specific verification protocol for routine practice is therefore essential as the image registration is used for many activities during the radiotherapy
planning and treatment. Frequently, the registration is performed by one team member for use by another member for

e62

Brock et al.: TG 132: Image registration

e62

TABLE VI. Recommended tests and tolerances for the digital phantom test cases. See Table IV for recommended testing schedule. Here the voxel dimension
should be the calculated as the 3D vector magnitude of the image with the largest voxel size to reflect the nonisotropic size of most imaging voxels.
Stationary image

Moving image

All datasets

Test

Tolerance

Voxel intensity
Orientation

Exact
Exact

Each modality image in
Basic phantom dataset – 1
Each modality image in
Basic phantom dataset – 1

Rigid registration – Translation
only
Rigid registration – Translation
and rotation

Maximum cardinal direction error less than
0.5*voxel dimension
Maximum cardinal direction error less than
0.5*voxel dimension

Basic anatomical dataset - 1

Basic anatomical dataset - 2

Registration – translation only

Maximum cardinal direction error less than
0.5*voxel dimension size

Basic anatomical dataset - 1

Basic anatomical dataset - 3

Registration – translation only

Maximum cardinal direction error less than
0.5*voxel dimension size

Basic anatomical dataset - 1

Basic anatomical dataset - 4

Registration – translation only

Maximum cardinal direction error less than
0.5*voxel dimension size

Basic anatomical dataset - 1

Basic anatomical dataset - 5

Registration – translation only

Basic anatomical dataset - 1

Basic deformation dataset - 1

Deformable Registration

Maximum cardinal direction error less than
0.5*voxel dimension size
95% of voxels within the phantom within 2 mm
Max error less than 5 mm

Sliding deformation dataset - 1

Sliding deformation dataset - 2

Deformable Registration

95% of voxels within the phantom within 2 mm
Max error less than 5 mm

Clinical 4DCT dataset

(Deformation can be processed
in either direction)

Deformable registration

Mean vector error of all landmark points less than 2 mm
Max error less than 5 mm

Basic phantom dataset - 2
Basic phantom dataset – 3

TABLE VII. Registration uncertainty assessment level and description.
Uncertainty assessment

Phrase

0

Whole scan aligned

1

Locally aligned

2

Useable with risk of deformation

Description

• Anatomy within 1 mm everywhere
• Useful for structure definition everywhere
• Appropriate for stereotactic localization
• Anatomy local to the area of interest is undistorted and aligned within 1 mm
• Useful for structure definition within the local region
• Appropriate for localization provided target is in locally aligned region
• Aligned locally, with mild anatomical variation
• Acceptable registration required deformation which risks altering anatomy
• Registered image shouldn’t be used solely for target definition as target may be deformed
• Increased reliance on additional information is highly recommended
• Registered image information should be used in complimentary manner and
no image should be used by itself

3

Useable for diagnosis only

4

Alignment not acceptable

• Registration not good enough to rely on geometric integrity
• Possible use to identify general location of lesion (e.g., PET hot spot)
• Unable to align anatomy to acceptable levels
• Patient position variation too great between scans (e.g., surgical resection of the
anatomy of interest or dramatic weight change between scans)

various tasks, therefore documentation of the registration
technique and patient-specific accuracy is essential to ensure
appropriate treatment of the patient.
Communication regarding the needs and results of the
image registration between the multidisciplinary team is
essential for the safe and efficient integration of image
Medical Physics, 44 (7), July 2017

registration in radiotherapy. The most effective procedure for
ensuring effective communication depends on clinic size and
structure. This task group recommends an image registration
directive analogous to treatment planning directives. The two
main communication interactions to address are the request
and the report. The request for an image registration

e63

Brock et al.: TG 132: Image registration

procedure should clearly identify the intended use of the
result as well as indicate the region(s) of greatest importance.
Also, when the registration is performed at a time prior to the
use of the registration, the registration results should be
reported back to the multidisciplinary team with appropriate
indications of the accuracy of the registration and in which
local regions unusable results. Each use case poses its own
challenges and requirements, but in every case, clinical errors
can be made if the communications related to image registration are misinterpreted. Language is proposed in Table VII to
describe the accuracy of an image registration.
In general, the following elements of communication
should be exchanged:

e63

e. Sample fused images in report with annotations
f. Documentation from system used for fusion
Appendix B provides examples of an Image Registration Request and Report form.

6. CLINICAL INTEGRATION OF REGISTRATION
TECHNIQUES IN TREATMENT PLANNING AND
DELIVERY
The clinical integration of successful image registration
programs should provide an efficient and safe practice. In
order to ensure the safe use of image registration, this task
group recommends the following steps:

1. Request
a. Clear identification of the image set(s) to be registered
i. Explicit identification of the primary reference
image and the images to register to it
b. An understanding of the local region(s) of importance
i. Anatomical regions and target location(s) or
ii. Local landmarks or
iii. Bounding box or other indicators on image
c. The intended use of the result
Examples:
i. Target delineation
ii. Dose compositing (retreatment)
iii. 4D change assessment (normal and tumor tissue)
d. Techniques to use (appropriate for the intended use
i. Deformable
ii. Rigid
e. The accuracy required for the final use:
i. Explicitly stated or
ii. Implicitly defined by therapy plan scenario (e.g.,
stereotactic) or
iii. Implicitly defined by intended use
2. Report
a. Identify actual images used
b. Indicate the uncertainties in the final registration for
local regions of importance and anatomical landmarks
i. Identify any critical inaccuracies to alert the user
c. Verify acceptable tolerances for use
d. Techniques used to perform registration

Medical Physics, 44 (7), July 2017

1). Clear guidelines are provided to the personnel implementing the image registration,
2). An efficient, patient-specific verification is performed
for each image registration prior to its use (e.g., qualitative assessment of registration results),
3). Registration accuracy is assessed at a frequency to
minimize the effect of errors without prohibiting clinical flow,
4). Clear identification of the accuracy of the registration
is provided to the consumer of the image fusion so
they are fully aware of and can account for any
uncertainties.
Commercially available systems provide advanced tools
for image registration and fusion. In order to improve
usability by a variety of users, the complexity, and often the
algorithms, is hidden from the user. The resulting risk is
that the commercial systems provide capabilities to users
that may not be fully understood. The inappropriate use of
these technologies can lead to potential errors in the treatment process. It is likely that all members of the multidisciplinary radiotherapy team will use or request the results of
the registration system. However, comprehensive knowledge
of the algorithm and its limitations cannot be assumed for
all personnel. Therefore, for clinical implementation, it is
the responsibility of the physicists to ensure proper training
of the personnel performing the image registration, that the
personnel have an adequate understanding of how to use the
system for each particular patient case, and that the algorithm is used in a safe manner, accounting for its uncertainties and limitations.
In addition, a patient-specific registration verification process should take place before the resulting data are used in
the clinic. This might include quantitative measurements as
described above in Section 4.C, but should always include a
qualitative evaluation across the entire dataset, described in
Section 4.B. This patient-specific quality check serves to
provide confidence to the user and helps to ensure safe operation of these systems. In clinical practice, this verification
should be communicated to consumers of the results of the
registration.

e64

Brock et al.: TG 132: Image registration

6.A. Treatment planning
The first critical component of image registration for treatment planning is a consistent patient position between all
imaging studies. For this reason, it is highly desirable to have
a process that allows imaging of the patient in the treatment
position, and ideally in the immobilization used for treatment.
This is not always practical, but any steps that can be made to
better align the patient positions between multimodality
imaging and that used for treatment is beneficial to the program. External fiducial marker placement may also assist in
the preparation.
Second, it is the recommendation of this task group that a
trained member of the radiotherapy team perform the image
registration and fusion prior to treatment planning. This person may also generate the report and recommend a level of
uncertainty assessment, defined in Table VII.
Third, the user of the registration results (i.e., the radiation
oncologist) should assess the registration accuracy and any
tradeoffs made in the registration using methods described in
Sections 4.B and 4.C. The final review of the image registration for clinical use by the treating radiation oncologist is
analogous to the final review of the dosimetric planning
tradeoffs made by the radiation oncologist.
Fourth, residual error in the registration that cannot be
resolved should be accounted for, e.g., in the treatment margins (PTV).
As an example, referring back to the MR-CT registration
for liver cancer described in 4.E. If an MR image is registered
to a CT for treatment planning, and the MR is used to delineate the GTV and the CT is used to delineate the normal tissues and calculate the dose, an assessment of the registration
accuracy should be performed. This could be a visual evaluation of the liver boundary using a checkerboard technique or
comparison of the spatial location of an identifiable marker
(i.e., a clip or a branch in a blood vessel) on both images. If
notable discrepancies are detected (i.e., greater than the voxel
size), the uncertainty should be estimated (by measuring the
distance between the boundaries of the liver or the difference
in location of the marker). The closer the measured uncertainty is to the GTV, the more representative it will be of the
GTV registration accuracy. It may be appropriate to account
for this uncertainty as a potential systematic error in the process. There are different philosophies that describe the incorporation of these uncertainties into the treatment margin, e.g.,
linear addition of the uncertainties or addition in quadrature,
and a clear consensus within the radiation oncology community has not been reached.
6.B. Treatment delivery
For each treatment site, a written protocol (e.g., registration request) should be developed providing a description of
what aspects of the image should be aligned for treatment
and identification of landmarks that can be used for verification. For example, for prostate, one may want to align the
prostate rectum boundary for treatment, and use the apex of
Medical Physics, 44 (7), July 2017

e64

the prostate for verification. Image registration for treatment
delivery is typically performed and applied by the same team
of users; therefore, the communication of the registration
results can be performed verbally within the team. It is imperative that the users are trained on how to quickly verify the
accuracy. A detailed protocol will provide a guide for therapists, and will make the registration process consistent for
every patient case. If image guidance is to be used for an
uncommon case for which no protocol has been developed, a
clear directive of what is to be aligned for treatment and what
accuracy is required should be provided to the therapists prior
to the onset of treatment or the physician should evaluate the
registration prior to treatment.
This task group recommends that the radiation therapist,
adequately trained in image registration and the specific
protocol, perform the image registration for treatment delivery. This will facilitate efficient integration of image registration into the treatment delivery process. Final validation
and use of image guidance should be decided on an institutional and protocol specific basis based on the training and
experience of the multidisciplinary team, the interplay
between the IGRT technique and treatment margins, and
regulatory guidelines. It is important that clinical operating
principles be developed to avoid complacency and ensure
efficient and safe treatment for patients. For final validation
of image guidance for standard dose fractionation, it is often
recommended that the radiation oncologist approve each
image registration used for treatment prior to the subsequent
treatment fraction delivered to the patient. Special consideration should be given to higher fractional doses, greater
than 5 Gy, such as that used in stereotactic radiosurgery.
The current recommendation from the American Society for
Radiation Oncology (ASTRO) and American College of
Radiology (ACR) Practice Guideline for the Performance of
Stereotactic Body Radiation Therapy is for approval of the
image registration prior to delivery of the radiation by a
radiation oncologist.172
6.C. Treatment monitoring and adaptation
Recently, the development of deformable image registration platforms has enabled sophisticated treatment monitoring, including dose accumulation in deforming anatomy,
e.g., the quantification of the dose delivered to subunits of
the tissue over the course of treatment accounting for variations in position and shape of organs through deformable
registration, and the ability to perform more sophisticated
adaptive replanning when anatomical or functional changes
in the patient are observed. The validation requirements for
this clinical process include those described above for both
treatment planning and image guidance. Verification of
each image registration should be performed prior to the
use of the registration to accumulate the dose. However, it
is important to note the use of deformable registration to
accumulate dose has additional demands on accuracy compared to the use of deformable registration for contour
propagation. For dose accumulation, the correspondence of

e65

Brock et al.: TG 132: Image registration

every voxel receiving significant dose should be accurately
aligned, whereas for contour propagation the accuracy is
most important at the boundary of the organ. The use of
deformable registration for dose accumulation and subsequent adaptive replanning is outside of the scope of this
task group. It is recommended that these issues be
addressed in a subsequent task group. Protocols should be
defined to guide the process for each treatment site,
accounting for expected uncertainties and ensure detection
of unexpected levels of uncertainties. In addition, when
using image registration for treatment adaptation or retreatment of patients where there is a risk of exceeding normal
tissue toxicity levels, the multidisciplinary team should discuss the uncertainties and limitations of the image registration. This is currently an area of rapid innovation and
caution should be used when employing these new techniques until they are well understood.

e65

• Two separate rigid registrations were performed, one to
align T2 and the other to align T7
• Accuracy on the order of 1 mm was obtained for the
vertebral bodies, determined by evaluating boundary of
the bony structure and small, point-like calcifications
The registration was approved; the target was contoured
on the fused dataset using the fusion that was appropriate for
each vertebral body. No expansion was applied for the registration uncertainty.
2. A liver patient is contrast intolerant and has a prior
MRI scan that clearly identifies the lesions in the left
lobe to be treated. The MRI was acquired in an arbitrary voluntary breath hold state and the patient is to be
treated at an externally assisted exhale breath hold
state.
Request

6.D. Clinical case illustrations
6.D.1. Target and critical structure segmentation at
planning
Below are two clinical case illustrations for the planning
request for image registration for structure segmentation, the
results of the registration, and the subsequent report.
1. A spinal stereotactic procedure is to be performed for
two lesions in T2 and T7 vertebral bodies. The physician has reviewed the diagnostic MRI scans with 1 mm
voxel resolution and requests that they be registered to
the treatment planning CT scan, with 1 mm slice thickness, to identify the target volumes for treatment.
In this case the request should include the following
information
Request

• Which MRI scan(s) from which study (i.e., Sagittal T1
axial post contrast)

• Treatment Planning CT is the primary
• Regions of T2 and T7 vertebral bodies are most critical
• Intended use is target definition for stereotactic RT
• Rigid registration should be used to avoid deforming
the tumor

• Desired accuracy is on the order of 1 mm to be consis-

tent with the expected 1 mm accuracy of alignment at
treatment

Upon performing the image registration, it was noticed
that the spine was arched more in the MRI making it impossible to align both T2 and T7 vertebral bodies with a single
rigid registration. It was decided to use two separate rigid
registrations to accomplish the goal.
Report

• Sagittal T1 axial post contrast was registered with the
treatment planning CT

Medical Physics, 44 (7), July 2017

• Which MRI scan(s) from which study (i.e., Sagittal T1
axial post contrast)
• Treatment Planning CT is the primary
• Left lobe of the liver is the most critical
• Intended use is target definition
• Uncertainty in registration should be reported and
added to the PTV margin

Upon performing the registration, it was noted that deformation was present between the MR and CT scans. The registration focused on the left lobe containing the tumor. The left
lobe of the liver aligned very well, the boundary of this lobe
matched to within the voxel size.
Report

• T2 axial MR was registered with the treatment planning

CT
• Rigid registration focused on the left lobe, for purposes
of tumor definition
• Accuracy on the order of 2 mm was obtained for the left
lobe
The registration was approved, the tumor contour was generated based on the fused MR, and no expansion was deemed
necessary for the registration uncertainty.
6.D.2. Target registration and normal tissue
avoidance at treatment delivery
The use of image registration in the treatment room should
be designed within the whole context of the planning and
delivery workflow. An example workflow is shown in Fig. 6.
Currently, standard in-room image guidance requires a single
translation (plus possible rotation) to be applied to the
patient. This constraint in using the image registration
requires tradeoffs in the registration process (i.e., the distribution of the residual errors following registration). These tradeoffs should be accounted for in the planning process (e.g., if

e66

Brock et al.: TG 132: Image registration

FIG. 6. Summary of an example image guidance protocol.

Medical Physics, 44 (7), July 2017

e66

e67

Brock et al.: TG 132: Image registration

targeting the tumor is the primary focus at treatment, a PRV
may be necessary at planning to ensure that the normal tissue
is not overdosed). Advances in the field may reduce these
requirements through the use of adaptive and real-time, inroom planning. The template for guidance shown above illustrates the need for image registration and assessment of registration in the treatment room.
Following patient setup and acquisition of the in-room
image, the field of view should be set for the image registration. This may be the entire image, a specific region of interest (e.g., the tumor), or a larger region of interest (e.g., the
entire neck). Once the field of view is set, the registration
technique should be selected, this should be designated in a
treatment protocol for the patient or class of patients. This
should include the similarity metric, transformation algorithm, and optimization technique (as applicable). Following
registration, the shift should be assessed to decide if the magnitude is within specification and treatment should move forward or if an intervention should occur (e.g., reset up the
patient). If moving forward, the registration accuracy should
be assessed. It is important at this step that the registration
accuracy is assessed everywhere, not just within the specific
region of interest, to ensure that normal tissue avoidance is
maintained. The plan adequacy should be evaluated (e.g.,
with the applied correction, can the intended plan be delivered to within an allowable level of deviation). These criteria
will vary based on treatment site, protocol, and institution.
7. CONCLUSIONS
Image registration and fusion has the potential to improve
the planning, delivery, and assessment of radiotherapy. However, as with any advanced technology used in the treatment
of patients, it should be commissioned and integrated into the
clinic in a safe and efficient manner. As the complexity of the
registration increases the validation, quality assurance, and
verification methods needed in the commissioning and clinical integration of the software also increases. As described in
this task group report, the commissioning and quality assurance program associated with an image registration application is multifaceted. Only through the combination of
multiple tests, can a complete assessment of the accuracy be
obtained.
At the time of publication of this document, the tools
needed to complete all recommended commissioning steps
outlined in this report are not standard in all commercial
algorithms. The purpose of this report was to also provide
guidance to the vendors on the tools that are needed to efficiently perform these tasks within the commercial system.
The recommendations of this task group can be summarized as follows:
7.A. Clinical recommendations
1. Understand the basic image registration techniques and
methods of visualizing image fusion
Medical Physics, 44 (7), July 2017

e67

2. Understand the basic components of the registration
algorithm used clinically to ensure its proper use
3. Perform end-to-end tests, using a physical phantom, of
imaging, registration, and planning/treatment systems
if image registration is performed on a stand-alone system
4. Perform comprehensive commissioning of image registration using the provided digital phantom data (or similar data) as well as clinical data from the user’s
institution
a. Estimation of registration error should be assessed
using a combination of the quantitative and qualitative
evaluation tools described in Tables III and IV. Regions
with larger estimated errors should be accounted for in
the uncertainty margins used.
5. Develop a request and report system to ensure communication and documentation between all users of image
registration
6. Establish a patient-specific QA practice for efficient
evaluation of image registration results

7.B. Vendor recommendations
1. Disclose basic components of their registration algorithm to ensure its proper use
2. Provide the ability to export the registration matrix or
deformation vector field for validation
3. Provide tools to qualitatively evaluate the image
registration
4. Provide the ability to identify landmarks on two images
and calculate the TRE from the registration
5. Provide the ability to calculate the DSC and MDA
between the contours defined on an image and the contours mapped to the image via image registration
6. Support the integration of a request and report system
for image registration
This task group report aims to provide a comprehensive, yet feasible, commissioning and QA system. The
image registration system should be commissioned for
clinical use, as per all other devices in the clinic. It is
essential that the physicist understand the fundamental
components of the algorithm to ensure its safe and appropriate use in the clinic. In addition to commissioning, a
quality assurance process should be in place to ensure that
the clinical use of the registration is appropriate. The tests
described in this report propose guidelines for both the
frequency and tolerance recommended to aid in the safe
and effective use of image registration in the clinic. The
individual protocols for each clinical department will drive
further tailoring of these guidelines to include the additional steps necessary for safe execution of the use of
image registration.

e68

Brock et al.: TG 132: Image registration

ACKNOWLEDGMENTS
Portions of the text from Sections 2 and 3 and Figs. 2,
4, and 5 are reprinted with permission of Springer
Science+Business Media from New Technologies in Radiation Oncology, Medical Radiology 2006, pp. 41-52, Image
Registration and Data Fusion for Radiotherapy Treatment
Planning, Authors: Marc L. Kessler PhD, Michael Roberson BS, © Springer-Verlag Berlin Heidelberg 2006. The
authors thank Joanne Moseley, Princess Margaret Cancer
Center, for the development of the pseudo-code available
on the AAPM website. The authors thank Oncology Systems Limited, UK (OSL, www.imsimqa.com) for the generous use of their ImSimQATM digital phantom data which
will be made available for download on the AAPM website. The authors thank Richard Castillo, Ph.D., DABR,

e68

and the DIR-lab, www.dir-lab.com for the generous use of
one of the 4DCT datasets.
CONFLICT OF INTEREST
Kristy Brock has a licensing agreement with RaySearch
Laboratories and a codevelopment agreement with Varian
Medical Systems. Sasa Mutic has a licensing agreement
with Modus, research and licensing agreements with Varian
Medical Systems, is a shareholder in Radialogica and a
Treat safely Partner. Todd McNutt has a collaboration
agreement with Philips Medical Systems and a licensing
agreement with Elekta Oncology Systems. Hua Li has a
research agreement with Philips Medical Systems. Marc
Kessler has a research and codevelopment agreement with
Varian Medical Systems.

APPENDIX A
RECOMMENDED ANATOMY TO QUALITATIVELY ASSESS IMAGE REGISTRATION ON A SITE-SPECIFIC
BASIS.

IMAGE REGISTRATION

Site

Anatomical landmark match

Brain

Orbits, optic nerves, brainstem, ventricles, Sella Turcica, nose, external auditory canal (may be useful for minimizing rotation/roll),
and Clivus (for minimizing rotation/yaw errors) sagittal suture

Head and neck

If anterior facial tumor, fuse by maxilla, brainstem and orbits, and nose

Neck

Cervical spine (one vertebral body above and below treatment site)

Chest

T-spine or L-spine near the area

Chest wall

Adjust T-spine in the area of treatment, then adjust to the closest ribs or by sternum

Abdomen

Liver, spleen, and/or kidney boundary
Axial alignment of the abdominal aorta

Hand

Metacarpals or phalanges

Wrist

Carpal bones

Long bones

Fuse joint to joint. If only one joint available, start there. Femoral head or humeral head depending on tumor location.

Pelvis

Symphysis pubis, sacroiliac joint, sacrum, iliac crest, femoral head (may be useful for minimizing rotation/roll)
Prostate cancer: prostate, penile bulb
Calcaneus and Tarsals or Metatarsals only if foot is flexed

Foot

Medical Physics, 44 (7), July 2017

e69

Brock et al.: TG 132: Image registration

e69

APPENDIX B
EXAMPLE TEMPLATES OF AN IMAGE REGISTRATION REQUEST AND REPORT.
Image Registration Request
Primary Reference Image
‫ ס‬Simulaon CT ‫ ס‬MRI ‫ ס‬PET

Date____________ Details_________________________

Images to be registered to the primary reference image
‫ ס‬CT ‫ ס‬PET ‫ ס‬MRI (‫ ס‬sag ‫ ס‬cor ‫ ס‬axial) Date____________ Details_________________________
‫ ס‬CT ‫ ס‬PET ‫ ס‬MRI (‫ ס‬sag ‫ ס‬cor ‫ ס‬axial) Date____________ Details_________________________

Intended Use
‫ ס‬Target or structure delineaon

‫ ס‬Dose composing

‫ ס‬Moon management

‫ ס‬Disease progression or response

Comment: ___________________________________________________________________________
Local Regions of Importance
Region

Comment

Landmarks

1. _______________

____________________________

_________________________

2. _______________

____________________________

_________________________

3. _______________

____________________________

_________________________

4. _______________

____________________________

_________________________

Registraon Technique
‫ ס‬Rigid Only

‫ ס‬Rigid and Deformable

‫ ס‬Deformable only

Accuracy Requirements
⃝ 0: Whole Scan Aligned
⃝ 1: Locally Aligned
⃝ 2: Useable if deformaon exists (registered image for complimentary informaon only)
⃝ 3: Registraon for diagnosis only (registraon needed to idenfy general area)
Comment: ______________________________________________
Requesng Physician: _________________________
Date: _________________________
Signature: _________________________

Medical Physics, 44 (7), July 2017

e70

Brock et al.: TG 132: Image registration

e70

Image Registration Report
Primary Reference Image:
Modality_________ Date____________ Details_________________________
Images to be registered to the primary reference image
Modality_________ Date____________ Details_________________________ Technique___________
Modality_________ Date____________ Details_________________________ Technique___________
Intended Use
‫ ס‬Target or structure delineaon

‫ ס‬Dose composing

‫ ס‬Moon management

‫ ס‬Disease progression or response

Comment: ___________________________________________________________________________
Local Region Alignment Accuracy
Region/Metric

Accuracy Level

Comment

Screen Shot

1. ____________

________________________

______________________

‫ס‬

2. ____________

________________________

______________________

‫ס‬

3. ____________

________________________

______________________

‫ס‬

4. ____________

________________________

______________________

‫ס‬

Accuracy Level
⃝ 0: Whole Scan Aligned
⃝ 1: Locally Aligned
⃝ 2: Useable with risk of deformaon (addional PTV/PRV margin may be required)
⃝ 3: Useable for diagnosis only (registraon only suitable to idenfy general area)
⃝ 4: Alignment not acceptable (Do Not Use!)
Comment: ________________________________________________________________
Notes:_______________________________________________________________________________
_____________________________________________________________________________________
_____________________________________________________________________________________
Clinician Performing Registraon: ____________________________
Signature: _________________________ Date: ________________________

Medical Physics, 44 (7), July 2017

e71

Brock et al.: TG 132: Image registration

APPENDIX C
SCREENSHOTS OF PHANTOM DATASETS.

FIG. C1. Simple geometric CT Phantom. [Color figure can be viewed at wileyonlinelibrary.com]

Medical Physics, 44 (7), July 2017

e71

e72

Brock et al.: TG 132: Image registration

FIG. C2. Pelvis CT Phantom. [Color figure can be viewed at wileyonlinelibrary.com]

Medical Physics, 44 (7), July 2017

e72

e73

Brock et al.: TG 132: Image registration

a)

Author to whom correspondence should be addressed. Electronic mail:
kkbrock@mdanderson.org.

REFERENCES
1. Ashburner J. A fast diffeomorphic image registration algorithm.
NeuroImage. 2007;38:95–113.
2. Brown LG. A survey of image registration techniques. ACM computing
surveys (CSUR). 1992;24:325–376.
3. Collignon A, Maes F, Delaere D, Vandermeulen D, Suetens P, Marchal
G. Automated multi-modality image registration based on information
theory. Inform Process Med Imaging. 1995;3:263–274.
4. Hill DL, Batchelor PG, Holden M, Hawkes DJ. Medical image registration. Phys Med Biol. 2001;46:R1.
5. Jenkinson M, Bannister P, Brady M, Smith S. Improved optimization
for the robust and accurate linear registration and motion correction of
brain images. NeuroImage. 2002;17:825–841.
6. Maes F, Vandermeulen D, Suetens P. Comparative evaluation of multiresolution optimization strategies for multimodality image registration by maximization of mutual information. Med Image Anal.
1999;3:373–386.
7. Zitova B, Flusser J. Image registration methods: a survey. Image Vis
Comput. 2003;21:977–1000.
8. Maintz JA, Viergever MA. A survey of medical image registration.
Med Image Anal. 1998;2:1–36.
9. van Herk M, de Munck JC, Lebesque JV, Muller S, Rasch C, Touw A.
Automatic registration of pelvic computed tomography data and magnetic resonance scans including a full circle method for quantitative
accuracy evaluation. Med Phys. 1998;25:2054–2067.
10. Cai J, Chu JC, Recine D, et al. CT and PET lung image registration
and fusion in radiotherapy treatment planning using the chamfer-matching method. Int J Radiat Oncol Biol Phys. 1999;43:883–891.
11. Jobse M, Davelaar J, Hendriks E, Kattevilder R, Reiber H, Stoel B. A
new algorithm for the registration of portal images to planning images
in the verification of radiotherapy, as validated in prostate treatments.
Med Phys. 2003;30:2274–2281.
12. van Herk M, Kooy HM. Automatic three-dimensional correlation of
CT-CT, CT-MRI, and CT-SPECT using chamfer matching. Med Phys.
1994;21:1163–1178.
13. Papavasileiou P, Flux GD, Guy MJ, Flower MA. A novel four-dimensional image registration method for radionuclide therapy dosimetry.
Phys Med Biol. 2004;49:5373–5391.
14. Sarrut D, Boldea V, Miguet S, Ginestet C. Simulation of four-dimensional CT images from deformable registration between inhale and
exhale breath-hold CT scans. Med Phys. 2006;33:605–617.
15. Shekhar R, Lei P, Castro-Pareja CR, Plishker WL, D’Souza WD. Automatic segmentation of phase-correlated CT scans through nonrigid
image registration using geometrically regularized free-form deformation. Med Phys. 2007;34:3054–3066.
16. Kunzler T, Grezdo J, Bogner J, Birkfellner W, Georg D. Registration of
DRRs and portal images for verification of stereotactic body radiotherapy: a feasibility study in lung cancer treatment. Phys Med Biol.
2007;52:2157–2170.
17. Yin Y, Hoffman EA, Lin CL. Mass preserving nonrigid registration of
CT lung images using cubic B-spline. Med Phys. 2009;36:4213–4222.
18. Moseley J, Munro P. A semiautomatic method for registration of portal
images. Med Phys. 1994;21:551–558.
19. Kano A, Doi K, MacMahon H, Hassell DD, Giger ML. Digital image
subtraction of temporally sequential chest images for detection of interval change. Med Phys. 1994;21:453–461.
20. Dong L, Boyer AL. An image correlation procedure for digitally reconstructed radiographs and electronic portal images. Int J Radiat Oncol
Biol Phys. 1995;33:1053–1060.
21. McParland BJ, Kumaradas JC. Digital portal image registration by
sequential anatomical matchpoint and image correlations for real-time
continuous field alignment verification. Med Phys. 1995;22:1063–1075.
22. Flynn AA, Green AJ, Boxer G, Pedley RB, Begent RH. A comparison
of image registration techniques for the correlation of radiolabelled
antibody distribution with tumour morphology. Phys Med Biol.
1999;44:N151–N159.

Medical Physics, 44 (7), July 2017

e73
23. Tanaka R, Sanada S, Suzuki M, et al. Breathing chest radiography
using a dynamic flat-panel detector combined with computer analysis.
Med Phys. 2004;31:2254–2262.
24. Studholme C, Hill DL, Hawkes DJ. Automated three-dimensional registration of magnetic resonance and positron emission tomography
brain images by multiresolution optimization of voxel similarity measures. Med Phys. 1997;24:25–35.
25. Bruckner T, Lucht R, Brix G. Comparison of rigid and elastic matching
of dynamic magnetic resonance mammographic images by mutual
information. Med Phys. 2000;27:2456–2461.
26. Kim J, Fessler JA, Lam KL, Balter JM, Ten Haken RK. A feasibility
study of mutual information based setup error estimation for radiotherapy. Med Phys. 2001;28:2507–2517.
27. Klabbers BM, de Munck JC, Slotman BJ, et al. Matching PET and CT
scans of the head and neck area: development of method and validation.
Med Phys. 2002;29:2230–2238.
28. Bond JE, Smith V, Yue NJ, Knisely JP. Comparison of an image registration technique based on normalized mutual information with a standard method utilizing implanted markers in the staged radiosurgical
treatment of large arteriovenous malformations. Int J Radiat Oncol Biol
Phys. 2003;57:1150–1158.
29. Clippe S, Sarrut D, Malet C, Miguet S, Ginestet C, Carrie C. Patient
setup error measurement using 3D intensity-based image registration
techniques. Int J Radiat Oncol Biol Phys. 2003;56:259–265.
30. Dekker N, Ploeger LS, van Herk M. Evaluation of cost functions for
gray value matching of two-dimensional images in radiotherapy. Med
Phys. 2003;30:778–784.
31. Miga MI. A new approach to elastography using mutual information
and finite elements. Phys Med Biol. 2003;48:467–480.
32. Brock KM, Balter JM, Dawson LA, Kessler ML, Meyer CR. Automated generation of a four-dimensional model of the liver using warping and mutual information. Med Phys. 2003;30:1128–1133.
33. Wu X, Dibiase SJ, Gullapalli R, Yu CX. Deformable image registration
for the use of magnetic resonance spectroscopy in prostate treatment
planning. Int J Radiat Oncol Biol Phys. 2004;58:1577–1583.
34. Coselmon MM, Balter JM, McShan DL, Kessler ML. Mutual
information based CT registration of the lung at exhale and
inhale breathing states using thin-plate splines. Med Phys.
2004;31:2942–2948.
35. Lavely WC, Scarfone C, Cevikalp H, et al. Phantom validation of
coregistration of PET and CT for image-guided radiotherapy. Med
Phys. 2004;31:1083–1092.
36. Roberson PL, McLaughlin PW, Narayana V, Troyer S, Hixson GV,
Kessler ML. Use and uncertainties of mutual information for computed
tomography/ magnetic resonance (CT/MR) registration post permanent
implant of the prostate. Med Phys. 2005;32:473–482.
37. Ji S, Wu Z, Hartov A, Roberts DW, Paulsen KD. Mutual-informationbased image to patient re-registration using intraoperative ultrasound in
image-guided neurosurgery. Med Phys. 2008;35:4612–4624.
38. Klein S, van der Heide UA, Lips IM, van Vulpen M, Staring M, Pluim
JP. Automatic segmentation of the prostate in 3D MR images by atlas
matching using localized mutual information. Med Phys.
2008;35:1407–1417.
39. Park SB, Rhee FC, Monroe JI, Sohn JW. Spatially weighted mutual
information image registration for image guided radiation therapy. Med
Phys. 2010;37:4590–4601.
40. Marinelli M, Martinez-Moller A, Jensen B, et al. Registration of
myocardial PET and SPECT for viability assessment using mutual
information. Med Phys. 2010;37:2414–2424.
41. Chappelow J, Bloch BN, Rofsky N, et al. Elastic registration of multimodal prostate MRI and histology via multiattribute combined mutual
information. Med Phys. 2011;38:2005–2018.
42. Wells WM 3rd, Viola P, Atsumi H, Nakajima S, Kikinis R. Multimodal volume registration by maximization of mutual information.
Med Image Anal. 1996;1:35–51.
43. Viola P, Wells WM III. Alignment by maximization of mutual information. Int J Comput Vision. 1997;24:137–154.
44. Hadjiiski L, Chan HP, Sahiner B, Petrick N, Helvie MA. Automated
registration of breast lesions in temporal pairs of mammograms for
interval change analysis–local affine transformation for improved localization. Med Phys. 2001;28:1070–1079.

e74

Brock et al.: TG 132: Image registration

45. Filev P, Hadjiiski L, Sahiner B, Chan HP, Helvie MA. Comparison of
similarity measures for the task of template matching of masses on
serial mammograms. Med Phys. 2005;32:515–529.
46. Xiong L, Viswanathan A, Stewart AJ, et al. Deformable structure registration of bladder through surface mapping. Med Phys.
2006;33:1848–1856.
47. Shi J, Sahiner B, Chan HP, et al. Pulmonary nodule registration in
serial CT scans based on rib anatomy and nodule template matching.
Med Phys. 2007;34:1336–1347.
48. Lamare F, Cresson T, Savean J, Cheze Le Rest C, Reader AJ, Visvikis
D. Respiratory motion correction for PET oncology applications using
affine transformation of list mode data. Phys Med Biol. 2007;52:121–140.
49. Jacobs MA, Windham JP, Soltanian-Zadeh H, Peck DJ, Knight RA.
Registration and warping of magnetic resonance images to histological
sections. Med Phys. 1999;26:1568–1578.
50. Lian J, Xing L, Hunjan S, et al. Mapping of the prostate in endorectal
coil-based MRI/MRSI and CT: a deformable registration and validation
study. Med Phys. 2004;31:3087–3094.
51. Schaly B, Kempe JA, Bauman GS, Battista JJ, Van Dyk J. Tracking the
dose distribution in radiation therapy by accounting for variable anatomy. Phys Med Biol. 2004;49:791–805.
52. Rosu M, Chetty IJ, Balter JM, Kessler ML, McShan DL, Ten Haken
RK. Dose reconstruction in deforming lung anatomy: dose grid size
effects and clinical implications. Med Phys. 2005;32:2487–2495.
53. Venugopal N, McCurdy B, Hnatov A, Dubey A. A feasibility study to
investigate the use of thin-plate splines to account for prostate deformation. Phys Med Biol. 2005;50:2871–2885.
54. Malsch U, Thieke C, Huber PE, Bendl R. An enhanced block matching
algorithm for fast elastic registration in adaptive radiotherapy. Phys
Med Biol. 2006;51:4789–4806.
55. Zhong H, Peters T, Siebers JV. FEM-based evaluation of deformable
image registration for radiation therapy. Phys Med Biol. 2007;52:4721–
4738.
56. Xie Y, Chao M, Lee P, Xing L. Feature-based rectal contour propagation from planning CT to cone beam CT. Med Phys. 2008;35:4450–
4459.
57. Wu QJ, Thongphiew D, Wang Z, Chankong V, Yin FF. The impact of
respiratory motion and treatment technique on stereotactic body radiation therapy for liver cancer. Med Phys. 2008;35:1440–1451.
58. Xie Y, Chao M, Xing L. Tissue feature-based and segmented deformable image registration for improved modeling of shear movement of
lungs. Int J Radiat Oncol Biol Phys. 2009;74:1256–1265.
59. Woo J, Slomka PJ, Dey D, et al. Geometric feature-based multimodal
image registration of contrast-enhanced cardiac CT with gated myocardial perfusion SPECT. Med Phys. 2009;36:5467–5479.
60. Narayanasamy G, LeCarpentier GL, Roubidoux M, Fowlkes JB, Schott
AF, Carson PL. Spatial registration of temporally separated whole
breast 3D ultrasound images. Med Phys. 2009;36:4288–4300.
61. Vasquez Osorio EM, Hoogeman MS, Bondar L, Levendag PC, Heijmen
BJ. A novel flexible framework with automatic feature correspondence
optimization for nonrigid registration in radiotherapy. Med Phys.
2009;36:2848–2859.
62. Bondar L, Hoogeman MS, Vasquez Osorio EM, Heijmen BJ. A symmetric nonrigid registration method to handle large organ deformations
in cervical cancer patients. Med Phys. 2010;37:3760–3772.
63. Xie Y, Chao M, Xiong G. Deformable image registration of liver with
consideration of lung sliding motion. Med Phys. 2011;38:5351–5361.
64. Pallone MJ, Meaney PM, Paulsen KD. Surface scanning through a
cylindrical tank of coupling fluid for clinical microwave breast imaging
exams. Med Phys. 2012;39:3102–3111.
65. Vasquez Osorio EM, Hoogeman MS, Mendez Romero A, Wielopolski
P, Zolnay A, Heijmen BJ. Accurate CTMR vessel-guided nonrigid registration of largely deformed livers. Med Phys. 2012;39:2463–2477.
66. Wognum S, Bondar L, Zolnay AG, et al. Control over structure-specific flexibility improves anatomical accuracy for point-based deformable
registration in bladder cancer radiotherapy. Med Phys. 2013;40:021702.
67. Arganda-Carreras I, Sorzano CO, Thevenaz P, et al. Non-rigid consistent
registration of 2D image sequences. Phys Med Biol. 2010;55:6215–6242.
68. Bai W, Brady M. Regularized B-spline deformable registration for respiratory motion correction in PET images. Phys Med Biol.
2009;54:2719–2736.

Medical Physics, 44 (7), July 2017

e74
69. Blumenfeld J, Studholme C, Carballido-Gamio J, Carpenter D, Link
TM, Majumdar S. Three-dimensional image registration of MR proximal femur images for the analysis of trabecular bone parameters. Med
Phys. 2008;35:4630–4639.
70. Chao M, Penagaricano J, Yan Y, Moros EG, Corry P, Ratanatharathorn
V. Voxel-based dose reconstruction for total body irradiation with helical tomotherapy. Int J Radiat Oncol Biol Phys. 2012;82:1575–1583.
71. Cunliffe AR, Al-Hallaq HA, Labby ZE, et al. Lung texture in serial
thoracic CT scans: assessment of change introduced by image registration. Med Phys. 2012;39:4679–4690.
72. Delmon V, Rit S, Pinho R, Sarrut D. Registration of sliding objects
using direction dependent B-splines decomposition. Phys Med Biol.
2013;58:1303–1314.
73. Faggiano E, Fiorino C, Scalco E, et al. An automatic contour propagation method to follow parotid gland deformation during head-and-neck
cancer tomotherapy. Phys Med Biol. 2011;56:775–791.
74. Hub M, Thieke C, Kessler ML, Karger CP. A stochastic approach to
estimate the uncertainty of dose mapping caused by uncertainties in bspline registration. Med Phys. 2012;39:2186–2192.
75. Jacobson TJ, Murphy MJ. Optimized knot placement for B-splines in
deformable image registration. Med Phys. 2011;38:4579–4582.
76. Karnik VV, Fenster A, Bax J, et al. Assessment of image registration
accuracy in three-dimensional transrectal ultrasound guided prostate
biopsy. Med Phys. 2010;37:802–813.
77. Karnik VV, Fenster A, Bax J, Romagnoli C, Ward AD. Evaluation of
intersession 3D-TRUS to 3D-TRUS image registration for repeat prostate biopsies. Med Phys. 2011;38:1832–1843.
78. Khallaghi S, Leung CG, Hastrudi-Zaad K, Foroughi P, Nguan C, Abolmaesumi P. Experimental validation of an intrasubject elastic registration algorithm for dynamic-3D ultrasound images. Med Phys.
2012;39:5488–5497.
79. Lamare F, Ledesma Carbayo MJ, Cresson T, et al. List-mode-based
reconstruction for respiratory motion correction in PET using non-rigid
body transformations. Phys Med Biol. 2007;52:5187–5204.
80. Mori S, Furukawa T, Inaniwa T, et al. Systematic evaluation of fourdimensional hybrid depth scanning for carbon-ion lung therapy. Med
Phys. 2013;40:031720.
81. Pekar V, Gladilin E, Rohr K. An adaptive irregular grid approach for
3D deformable image registration. Phys Med Biol. 2006;51:361–377.
82. Petibon Y, Ouyang J, Zhu X, et al. Cardiac motion compensation and
resolution modeling in simultaneous PET-MR: a cardiac lesion detection study. Phys Med Biol. 2013;58:2085–2102.
83. Rietzel E, Chen GT. Deformable registration of 4D computed tomography data. Med Phys. 2006;33:4423–4430.
84. Rohlfing T, Maurer CR Jr, O’Dell WG, Zhong J. Modeling liver
motion and deformation during the respiratory cycle using intensitybased nonrigid registration of gated MR images. Med Phys.
2004;31:427–432.
85. Schreibmann E, Waller AF, Crocker I, Curran W, Fox T. Voxel clustering for quantifying PET-based treatment response assessment. Med
Phys. 2013;40:012401.
86. Schreibmann E, Xing L. Narrow band deformable registration of prostate magnetic resonance imaging, magnetic resonance spectroscopic
imaging, and computed tomography studies. Int J Radiat Oncol Biol
Phys. 2005;62:595–605.
87. Shackleford JA, Kandasamy N, Sharp GC. On developing B-spline registration algorithms for multi-core processors. Phys Med Biol.
2010;55:6329–6351.
88. Shusharina N, Sharp G. Analytic regularization for landmark-based
image registration. Phys Med Biol. 2012;57:1477–1498.
89. Staring M, Klein S, Pluim JP. A rigidity penalty term for nonrigid registration. Med Phys. 2007;34:4098–4108.
90. Staring M, Klein S, Pluim JP. Nonrigid registration with tissue-dependent filtering of the deformation field. Phys Med Biol. 2007;52:6879–
6892.
91. Tang Q, Cammin J, Srivastava S, Taguchi K. A fully four-dimensional,
iterative motion estimation and compensation method for cardiac CT.
Med Phys. 2012;39:4291–4305.
92. Tanner C, Schnabel JA, Hill DL, et al. Quantitative evaluation of freeform deformation registration for dynamic contrast-enhanced MR
mammography. Med Phys. 2007;34:1221–1233.

e75

Brock et al.: TG 132: Image registration

93. van der Put RW, Kerkhof EM, Raaymakers BW, JurgenliemkSchulz IM, Lagendijk JJ. Contour propagation in MRI-guided
radiotherapy treatment of cervical cancer: the accuracy of rigid,
non-rigid and semi-automatic registrations. Phys Med Biol.
2009;54:7135–7150.
94. Vandemeulebroucke J, Rit S, Kybic J, Clarysse P, Sarrut D. Spatiotemporal motion estimation for respiratory-correlated imaging of the lungs.
Med Phys. 2011;38:166–178.
95. Vos PC, Hambrock T, Barenstz JO, Huisman HJ. Computer-assisted
analysis of peripheral zone prostate lesions using T2-weighted and
dynamic contrast enhanced T1-weighted MRI. Phys Med Biol.
2010;55:1719–1734.
96. Wang J, Gu X. High-quality four-dimensional cone-beam CT by
deforming prior images. Phys Med Biol. 2013;58:231–246.
97. Wu Z, Rietzel E, Boldea V, Sarrut D, Sharp GC. Evaluation of deformable registration of patient lung 4DCT with subanatomical region segmentations. Med Phys. 2008;35:775–781.
98. Xiong G, Chen C, Chen J, Xie Y, Xing L. Tracking the motion trajectories of junction structures in 4D CT images of the lung. Phys Med Biol.
2012;57:4905–4930.
99. Yan C, Zhong H, Murphy M, Weiss E, Siebers JV. A pseudoinverse
deformation vector field generator and its applications. Med Phys.
2010;37:1117–1128.
100. Zhang C, Villa-Uriol MC, De Craene M, Pozo JM, Macho JM,
Frangi AF. Dynamic estimation of three-dimensional cerebrovascular
deformation from rotational angiography. Med Phys. 2011;38:
1294–1306.
101. Zhong H, Kim J, Chetty IJ. Analysis of deformable image registration accuracy using computational modeling. Med Phys. 2010;37:
970–979.
102. Wang H, Dong L, O’Daniel J, et al. Validation of an accelerated
‘demons’ algorithm for deformable image registration in radiation therapy. Phys Med Biol. 2005;50:2887–2905.
103. Martel AL, Froh MS, Brock KK, Plewes DB, Barber DC. Evaluating
an optical-flow-based registration algorithm for contrast-enhanced
magnetic resonance imaging of the breast. Phys Med Biol.
2007;52:3803–3816.
104. Yang D, Li H, Low DA, Deasy JO, El Naqa I. A fast inverse consistent
deformable image registration method based on symmetric optical flow
computation. Phys Med Biol. 2008;53:6143–6165.
105. Castillo R, Castillo E, Guerra R, et al. A framework for evaluation of
deformable image registration spatial accuracy using large landmark
point sets. Phys Med Biol. 2009;54:1849–1870.
106. Schreibmann E, Nye JA, Schuster DM, Martin DR, Votaw J, Fox T.
MR-based attenuation correction for hybrid PET-MR brain imaging
systems using deformable image registration. Med Phys. 2010;37:2101–
2109.
107. Ehrhardt J, Werner R, Saring D, et al. An optical flow based method
for improved reconstruction of 4D CT data sets acquired during free
breathing. Med Phys. 2007;34:711–721.
108. Wolthaus JW, Sonke JJ, van Herk M, Damen EM. Reconstruction of a
time-averaged midposition CT scan for radiotherapy planning of lung
cancer patients using deformable registration. Med Phys.
2008;35:3998–4011.
109. Gu X, Dong B, Wang J, et al. A contour-guided deformable image registration algorithm for adaptive radiotherapy. Phys Med Biol.
2013;58:1889–1901.
110. Hou J, Guerrero M, Chen W, D’Souza WD. Deformable planning CT
to cone-beam CT image registration in head-and-neck cancer. Med
Phys. 2011;38:2088–2094.
111. Bharatha A, Hirose M, Hata N, et al. Evaluation of three-dimensional
finite element-based deformable registration of pre- and intraoperative
prostate imaging. Med Phys. 2001;28:2551–2560.
112. Brock KK, Hollister SJ, Dawson LA, Balter JM. Technical note: creating a four-dimensional model of the liver using finite element analysis.
Med Phys. 2002;29:1403–1405.
113. Liang J, Yan D. Reducing uncertainties in volumetric image based
deformable organ registration. Med Phys. 2003;30:2116–2122.
114. Brock KK, McShan DL, Ten Haken RK, Hollister SJ, Dawson LA, Balter JM. Inclusion of organ deformation in dose calculations. Med Phys.
2003;30:290–295.

Medical Physics, 44 (7), July 2017

e75
115. Zhang T, Orton NP, Mackie TR, Paliwal BR. Technical note: a novel
boundary condition using contact elements for finite element based
deformable image registration. Med Phys. 2004;31:2412–2415.
116. Brock KK, Sharpe MB, Dawson LA, Kim SM, Jaffray DA. Accuracy
of finite element model-based multi-organ deformable image registration. Med Phys. 2005;32:1647–1659.
117. Brock KK, Dawson LA, Sharpe MB, Moseley DJ, Jaffray DA. Feasibility of a novel deformable image registration technique to facilitate classification, targeting, and monitoring of tumor and normal tissue. Int J
Radiat Oncol Biol Phys. 2006;64:1245–1254.
118. Tanner C, Schnabel JA, Hill DL, Hawkes DJ, Leach MO, Hose DR.
Factors influencing the accuracy of biomechanical breast models. Med
Phys. 2006;33:1758–1769.
119. Alterovitz R, Goldberg K, Pouliot J, et al. Registration of MR prostate
images with biomechanical modeling and nonlinear parameter estimation. Med Phys. 2006;33:446–454.
120. Chi Y, Liang J, Yan D. A material sensitivity study on the accuracy of
deformable organ registration using linear biomechanical models. Med
Phys. 2006;33:421–433.
121. Wu Q, Liang J, Yan D. Application of dose compensation in image-guided
radiotherapy of prostate cancer. Phys Med Biol. 2006;51:1405–1419.
122. Hensel JM, Menard C, Chung PW, et al. Development of multiorgan
finite element-based prostate deformation model enabling registration
of endorectal coil magnetic resonance imaging for radiotherapy planning. Int J Radiat Oncol Biol Phys. 2007;68:1522–1528.
123. Kaus MR, Brock KK, Pekar V, Dawson LA, Nichol AM, Jaffray DA.
Assessment of a model-based deformable image registration approach
for radiation therapy planning. Int J Radiat Oncol Biol Phys.
2007;68:572–580.
124. Nichol AM, Brock KK, Lockwood GA, et al. A magnetic resonance
imaging study of prostate deformation relative to implanted gold fiducial markers. Int J Radiat Oncol Biol Phys. 2007;67:48–56.
125. Brock KK, Nichol AM, Menard C, et al. Accuracy and sensitivity of
finite element model-based deformable registration of the prostate.
Med Phys. 2008;35:4019–4025.
126. Al-Mayah A, Moseley J, Brock KK. Contact surface and material nonlinearity modeling of human lungs. Phys Med Biol. 2008;53:305–317.
127. Al-Mayah A, Moseley J, Velec M, Brock KK. Sliding characteristic
and material compressibility of human lung: parametric study and verification. Med Phys. 2009;36:4625–4633.
128. Nguyen TN, Moseley JL, Dawson LA, Jaffray DA, Brock KK. Adapting liver motion models using a navigator channel technique. Med
Phys. 2009;36:1061–1073.
129. Al-Mayah A, Moseley J, Velec M, Hunter S, Brock K. Deformable
image registration of heterogeneous human lung incorporating the
bronchial tree. Med Phys. 2010;37:4560–4571.
130. Al-Mayah A, Moseley J, Hunter S, et al. Biomechanical-based image
registration for head and neck radiation treatment. Phys Med Biol.
2010;55:6491–6500.
131. Alonzo-Proulx O, Packard N, Boone JM, et al. Validation of a method
for measuring the volumetric breast density from digital mammograms.
Phys Med Biol. 2010;55:3027–3044.
132. Eccles CL, Dawson LA, Moseley JL, Brock KK. Interfraction liver
shape variability and impact on GTV position during liver stereotactic
radiotherapy using abdominal compression. Int J Radiat Oncol Biol
Phys. 2011;80:938–946.
133. Al-Mayah A, Moseley J, Velec M, Brock K. Toward efficient biomechanical-based deformable image registration of lungs for imageguided radiotherapy. Phys Med Biol. 2011;56:4701–4713.
134. Zhong H, Kim J, Li H, Nurushev T, Movsas B, Chetty IJ. A finite element method to correct deformable image registration errors in lowcontrast regions. Phys Med Biol. 2012;57:3499–3515.
135. Han L, Hipwell JH, Tanner C, et al. Development of patient-specific
biomechanical models for predicting large breast deformation. Phys
Med Biol. 2012;57:455–472.
136. Levin DN, Pelizzari CA, Chen G, Chen C, Cooper M. Retrospective
geometric correlation of MR, CT, and PET images. Radiology.
1988;169:817–823.
137. Hill DL, Hawkes DJ, Hardingham CR. Use of anatomical knowledge to
register 3-D blood vessel data derived from DSA with MR images. Med
Imaging. 1991;348–357.

e76

Brock et al.: TG 132: Image registration

138. Fright WR, Linney AD. Registration of 3-D head surfaces using multiple landmarks. IEEE Trans Med Imaging. 1993;12:515–520.
139. Gilhuijs K, Van Herk M. Automatic on-line inspection of patient setup
in radiation therapy using digital portal images. Med Phys.
1993;20:667–677.
140. Hill DL, Hawkes DJ, Harrison NA, Ruff CF. A strategy for automated
multimodality image registration incorporating anatomical knowledge
and imager characteristics. Biennial Int Conf Inf Process Med Imaging.
1993;182–196.
141. Hua P, Fram I. Feature-based image registration for digital subtraction
angiography. Med Imaging. 1993;1993:24–31.
142. Miller MI, Christensen GE, Amit Y, Grenander U. Mathematical textbook of deformable neuroanatomies. Proc Natl Acad Sci.
1993;90:11944–11948.
143. Bettinardi V, Gilardi MC, Lucignani G, et al. A procedure for patient
repositioning and compensation for misalignment between transmission and emission data in PET heart studies. J Nucl Med. 1993;34:
137–142.
144. Van den Elsen PA, Pol E-J, Viergever MA. Medical image matching-a review with classification. IEEE Eng Med Biol Mag.
1993;12:26–39.
145. Woods RP, Mazziotta JC, Cherry SR. MRI-PET registration with automated algorithm. J Comput Assist Tomogr. 1993;17:536–546.
146. Liu A, Pizer SM, Eberly DH, et al. Volume registration using the 3D
core. Visual Biomed Comput. 1994;1994:217–226.
147. Kirby N, Chuang C, Pouliot J. A two-dimensional deformable phantom
for quantitatively verifying deformation algorithms. Med Phys.
2011;38:4583–4586.
148. Juang T, Das S, Adamovics J, Benning R, Oldham M. On the need for
comprehensive validation of deformable image registration, investigated with a novel 3-dimensional deformable dosimeter. Int J Radiat
Oncol Biol Phys. 2013;87:414–421.
149. Christiansen HN, Sederberg TW. Conversion of complex contour line
definitions into polygonal element mosaics. ACM Siggraph Computer
Graphics. 1978;12:187–192.
150. Brock KK. Imaging and image-guided radiation therapy in liver cancer.
Sem Radiat Oncol. 2011;21:247–255.
151. Murphy MJ. Image-guided patient positioning: if one cannot correct
for rotational offsets in external-beam radiotherapy setup, how
should rotational offsets be managed? Med Phys. 2007;34:1880–
1883.
152. Eisenhauer EA, Therasse P, Bogaerts J, et al. New response evaluation
criteria in solid tumours: revised RECIST guideline (version 1.1). Eur J
Cancer. 2009;45:228–247.
153. Badawi AM, Weiss E, Sleeman WC, Hugo GD. Classifying geometric
variability by dominant eigenmodes of deformation in regressing
tumours during active breath hold lung cancer radiotherapy. Phys Med
Biol. 2012;57:395–413.
154. Kessler ML. Image registration and data fusion in radiation therapy. Br
J Radiol. 2006;79:S99–S108.
155. Court LE, Dong L, Taylor N, et al. Evaluation of a contour-alignment
technique for CT-guided prostate radiotherapy: an intra- and interobserver study. Int J Radiat Oncol Biol Phys. 2004;59:412–418.

Medical Physics, 44 (7), July 2017

e76
156. Langen KM, Zhang Y, Andrews RD, et al. Initial experience with
megavoltage (MV) CT guidance for daily prostate alignments. Int J
Radiat Oncol Biol Phys. 2005;62:1517–1524.
157. Fitzpatrick JM, West JB, Maurer CR Jr. Predicting error in rigid-body
point-based registration. IEEE Trans Med Imaging. 1998;17:694–702.
158. Persson GF, Nygaard DE, Hollensen C, et al. Interobserver delineation
variation in lung tumour stereotactic body radiotherapy. Br J Radiol.
2012;85:e654–e660.
159. Brouwer CL, Steenbakkers RJ, vanden Heuvel E, et al. 3D Variation in
delineation of head and neck organs at risk. Radiat Oncol. 2012;7:32.
160. Nelms BE, Tome WA, Robinson G, Wheeler J. Variations in the contouring of organs at risk: test case from a patient with oropharyngeal
cancer. Int J Radiat Oncol Biol Phys. 2012;82:368–378.
161. Dice LR. Measures of the Amount of Ecologic Association Between
Species. Ecology. 1945;26:297–302.
162. Chalana VK, Kim Y. A methodology for evaluation of boundary detection algorithms on medical images. IEEE Trans Med Imaging. 1997;
16:642–652.
163. Segars WP, Tsui BM, Lalush DS, Frey EC, king MA, Manocha D.
Development and application of the new dynamic Nurbs-based Cardiac-Torso (NCAT) phantom. J Nucl Med. 2001;42:23.
164. Kashani R, Hub M, Kessler ML, Balter JM. Technical note: a physical
phantom for assessment of accuracy of deformable alignment algorithms. Med Phys. 2007;34:2785–2788.
165. Serban M, Heath E, Stroian G, Collins DL, Seuntjens J. A deformable
phantom for 4D radiotherapy verification: design and image registration evaluation. Med Phys. 2008;35:1094–1102.
166. Vinogradskiy YY, Balter P, Followill DS, Alvarez PE, White RA,
Starkschall G. Comparing the accuracy of four-dimensional photon
dose calculations with three-dimensional calculations using moving
and deforming phantoms. Med Phys. 2009;36:5000–5006.
167. Bissonnette JP, Balter PA, Dong L, et al. Quality assurance for imageguided radiation therapy utilizing CT-based technologies: a report of
the AAPM TG-179. Med Phys. 2012;39:1946–1963.
168. Fraass B, Doppke K, Hunt M, et al. American Association of Physicists in Medicine Radiation Therapy Committee Task Group 53: quality
assurance for clinical radiotherapy treatment planning. Med Phys.
1998;25:1773–1829.
169. Agency IAE. Commissioning and Quality Assurance of Computerized
Planning Systems for Radiation Treatment of Cancer. Vienna: International Atomic Energy Agency; 2004:281.
170. Kashani R, Hub M, Balter JM, et al. Objective assessment of deformable image registration in radiotherapy: a multi-institution study. Med
Phys. 2008;35:5944–5953.
171. K. K. Brock and D. R. A. Consortium. Results of a multi-institution
deformable registration accuracy study (MIDRAS). Int J Radiat Oncol
Biol Phys. 2010;76:583–596.
172. Potters L, Kavanagh B, Galvin JM, et al., R. American Society for
Therapeutic, Oncology, and R. American College of Radiology. American Society for Therapeutic Radiology and Oncology (ASTRO) and
American College of Radiology (ACR) practice guideline for the performance of stereotactic body radiation therapy. Int J Radiat Oncol Biol
Phys. 2010;76:326–332.


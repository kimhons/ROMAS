Report of the AAPM Task Group No. 105: Issues associated
with clinical implementation of Monte Carlo-based photon
and electron external beam treatment planning
Indrin J. Chettya兲
University of Michigan, Ann Arbor, Michigan 48109
and University of Nebraska Medical Center, Omaha, Nebraska 68198-7521

Bruce Curran
University of Michigan, Ann Arbor, Michigan 48109

Joanna E. Cygler
Ottawa Hospital Regional Cancer Center, Ottawa, Ontario K1H 1C4, Canada

John J. DeMarco
University of California, Los Angeles, Callifornia 90095

Gary Ezzell
Mayo Clinic Scottsdale, Scottsdale, Arizona 85259

Bruce A. Faddegon
University of California, San Francisco, California 94143

Iwan Kawrakow
National Research Council of Canada, Ottawa, Ontario K1A 0R6, Canada

Paul J. Keall
Stanford University Cancer Center, Stanford, California 94305-5847

Helen Liu
University of Texas MD Anderson Cancer Center, Houston, Texas 77030

C.-M. Charlie Ma
Fox Chase Cancer Center, Philadelphia, Pennsylvania 19111

D. W. O. Rogers
Carleton University, Ottawa, Ontario K1S 5B6, Canada

Jan Seuntjens
McGill University, Montreal, Quebec H3G 1A4, Canada

Daryoush Sheikh-Bagheri
The Regional Cancer Center, Erie, Pennsylvania 16505

Jeffrey V. Siebers
Virginia Commonwealth University, Richmond, Virginia 23298

共Received 11 April 2006; revised 11 July 2007; accepted for publication 18 September 2007;
published 27 November 2007兲
The Monte Carlo 共MC兲 method has been shown through many research studies to calculate accurate
dose distributions for clinical radiotherapy, particularly in heterogeneous patient tissues where the
effects of electron transport cannot be accurately handled with conventional, deterministic dose
algorithms. Despite its proven accuracy and the potential for improved dose distributions to influence treatment outcomes, the long calculation times previously associated with MC simulation
rendered this method impractical for routine clinical treatment planning. However, the development
of faster codes optimized for radiotherapy calculations and improvements in computer processor
technology have substantially reduced calculation times to, in some instances, within minutes on a
single processor. These advances have motivated several major treatment planning system vendors
to embark upon the path of MC techniques. Several commercial vendors have already released or
are currently in the process of releasing MC algorithms for photon and/or electron beam treatment
planning. Consequently, the accessibility and use of MC treatment planning algorithms may well
become widespread in the radiotherapy community. With MC simulation, dose is computed stochastically using first principles; this method is therefore quite different from conventional dose
algorithms. Issues such as statistical uncertainties, the use of variance reduction techniques, the
4818

Med. Phys. 34 „12…, December 2007

0094-2405/2007/34„12…/4818/36/$23.00

© 2007 Am. Assoc. Phys. Med.

4818

4819

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

4819

ability to account for geometric details in the accelerator treatment head simulation, and other
features, are all unique components of a MC treatment planning algorithm. Successful implementation by the clinical physicist of such a system will require an understanding of the basic principles
of MC techniques. The purpose of this report, while providing education and review on the use of
MC simulation in radiotherapy planning, is to set out, for both users and developers, the salient
issues associated with clinical implementation and experimental verification of MC dose algorithms. As the MC method is an emerging technology, this report is not meant to be prescriptive.
Rather, it is intended as a preliminary report to review the tenets of the MC method and to provide
the framework upon which to build a comprehensive program for commissioning and routine
quality assurance of MC-based treatment planning systems. © 2007 American Association of
Physicists in Medicine. 关DOI: 10.1118/1.2795842兴
Key words: Monte Carlo dose calculation, clinical treatment planning, experimental verification
TABLE OF CONTENTS
I. INTRODUCTION. . . . . . . . . . . . . . . . . . . . . . . . . . . . 4819
I.A. Motivation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4819
I.B. Objectives for the report. . . . . . . . . . . . . . . . . 4820
I.C. Organization of the report. . . . . . . . . . . . . . . . 4820
II. THE MONTE CARLO METHOD IN
RADIOTHERAPY DOSE CALCULATIONS. . . . . 4820
II.A. Definition of the MC method and historical
background. . . . . . . . . . . . . . . . . . . . . . . . . . . . 4820
II.B. Monte Carlo simulation of electron and
photon transport. . . . . . . . . . . . . . . . . . . . . . . . 4821
II.B.1. Analog simulations. . . . . . . . . . . . . . . . . . . 4822
II.B.2. Condensed history simulations. . . . . . . . . . 4822
II.C. Overview of Monte Carlo-based
radiotherapy dose calculations. . . . . . . . . . . . . 4823
II.D. Variance reduction techniques and efficiency
enhancing methods. . . . . . . . . . . . . . . . . . . . . . 4824
III. MONTE CARLO SIMULATION OF
RADIATION TRANSPORT IN
ACCELERATORS AND PATIENTS. . . . . . . . . . . . 4825
III.A. Review of current Monte Carlo codes. . . . . . . 4825
III.B. Accelerator treatment head simulation. . . . . . 4826
III.B.1. Sensitivity of simulations to electron
beam and other parameters. . . . . . . . . . . . . 4826
III.B.2. Electron beam specifics. . . . . . . . . . . . . . . . 4828
III.C. Modeling of the linear accelerator treatment
head. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4829
III.C.1. General schemes. . . . . . . . . . . . . . . . . . . . . 4829
III.C.2. Patient-specific beam modifiers. . . . . . . . . . 4831
III.C.3. Output ratios. . . . . . . . . . . . . . . . . . . . . . . . 4831
III.C.4. Dose buildup. . . . . . . . . . . . . . . . . . . . . . . . 4831
III.D. Treatment planning: MC-based patient
calculations. . . . . . . . . . . . . . . . . . . . . . . . . . . . 4832
III.D.1. Statistical uncertainties. . . . . . . . . . . . . . . . 4832
III.D.2. Dose prescriptions and monitor unit
calculation. . . . . . . . . . . . . . . . . . . . . . . . . . 4834
III.D.3. CT-to-material conversions. . . . . . . . . . . . . 4835
III.D.4. Dose-to-water and dose-to-medium. . . . . . 4835
III.D.5. IMRT dose calculation and optimization.. 4837
III.D.6. Voxel size effects. . . . . . . . . . . . . . . . . . . . . 4838
Medical Physics, Vol. 34, No. 12, December 2007

III.D.7. Cross sections. . . . . . . . . . . . . . . . . . . . . . . 4839
III.E. Experimental verification. . . . . . . . . . . . . . . . . 4839
III.E.1. Introduction. . . . . . . . . . . . . . . . . . . . . . . . . 4839
III.E.2. Previous work. . . . . . . . . . . . . . . . . . . . . . . 4839
III.E.3. Types of verification experiments. . . . . . . . 4839
III.E.4. Verification of the Monte Carlo transport
algorithm in phantom. . . . . . . . . . . . . . . . . 4840
III.E.5. Dose buildup region. . . . . . . . . . . . . . . . . . 4841
III.E.6. Output ratios. . . . . . . . . . . . . . . . . . . . . . . . 4841
III.E.7. Electron beams. . . . . . . . . . . . . . . . . . . . . . . 4841
III.E.8. Measurement uncertainties. . . . . . . . . . . . . 4842
III.E.9. Example experimental tests. . . . . . . . . . . . . 4842
III.E.10. Timing issues. . . . . . . . . . . . . . . . . . . . . . . . 4842
IV. CLINICAL IMPLICATIONS OF MONTE
CARLO-CALCULATED DOSE
DISTRIBUTIONS. . . . . . . . . . . . . . . . . . . . . . . . . . . 4843
IV.A. Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . 4843
IV.B. Clinical examples. . . . . . . . . . . . . . . . . . . . . . . 4844
IV.B.1. Photon beam treatment planning. . . . . . . . . 4845
IV.B.2. Electron beam treatment planning. . . . . . . 4845
IV.C. Association of Monte Carlo calculated dose
distributions with clinical outcome. . . . . . . . . 4846
V. SUMMARY. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4846
V.A. Treatment head simulation. . . . . . . . . . . . . . . . 4846
V.B. Patient simulation. . . . . . . . . . . . . . . . . . . . . . . 4846
V.B.1. Statistical uncertainties. . . . . . . . . . . . . . . . 4846
V.B.2. Variance reduction techniques, efficiency
enhancing methods, and other parameters.. 4847
V.B.3. Dose prescriptions. . . . . . . . . . . . . . . . . . . . 4847
V.B.4. CT-to-material conversions. . . . . . . . . . . . . 4847
V.B.5. Dose-to-water and dose-to-medium. . . . . . 4847
V.C. Experimental verification. . . . . . . . . . . . . . . . . 4847
V.C.1. Examples of specific tests. . . . . . . . . . . . . . 4847
V.C.2. Verification calculations. . . . . . . . . . . . . . . . 4847
V.C.3. Measurement uncertainties. . . . . . . . . . . . . 4847
I. INTRODUCTION
I.A. Motivation

The accuracy of dose calculations is crucial to the quality of
treatment planning and consequently to the doses delivered
to patients undergoing radiation therapy.1 Among other fac-

4820

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

tors, dose calculations form an integral component in optimizing the therapeutic gain, i.e., maximizing the dose to the
tumor for a given normal-tissue dose, for patients treated
with radiation. Although the clinical benefit of more accurate
dose distributions 共i.e., how the improved dose distributions
will affect tumor recurrence, i.e., local control, and normal
tissue complications兲 has not been adequately quantified and
requires further investigation, evidence exists that dose differences on the order of 7% are clinically detectable.2 Moreover, several studies have shown that 5% changes in dose
can result in 10% − 20% changes in tumor control probability
共TCP兲 or up to 20– 30% changes in normal tissue complication probabilities 共NCTP兲 if the prescribed dose falls along
the steepest region of the dose-effect curves.3–5 Readers interested in further understanding the need for heterogeneity
corrections, among other topics related to dose calculations,
are encouraged to read the AAPM Report No. 85,1 where a
comprehensive review of tissue heterogeneity corrections for
megavoltage photon beams is provided.
In this report we focus our attention on the Monte Carlo
共MC兲 method, a dose calculation algorithm known to be very
accurate when used properly for treatment planning in heterogeneous patient tissues. The issue of lengthy calculation
times has traditionally led to the MC method being viewed in
the medical physics community as a clinically unfeasible approach. However, the development of MC codes optimized
for radiotherapy calculations as well as the availability of
much faster and affordable computers, have substantially reduced processing times. These significant advances have led
to the clinical use of MC algorithms at some treatment centers and the promised availability of MC photon/electron
planning modules among several commercial treatment planning vendors.
In light of the above considerations, MC treatment planning is quickly becoming a reality. An introductory report for
the medical physics community on the understanding, implementation, testing, and use of MC algorithms is therefore
warranted.
I.B. Objectives for the report

We intend this document to be a preliminary report with
the following objectives: 共a兲 to provide an educational review of the physics of the MC method and how it is applied
in external beam radiotherapy dose calculations, 共b兲 to describe the role of the MC method in external beam radiotherapy treatment planning process: from the interaction of
electrons in the target of the linear accelerator to the deposition of dose in the patient tissues, 共c兲 to describe the issues
associated with MC dose calculation within the patientspecific geometry, 共d兲 to discuss the issues associated with
experimental verification of MC algorithms, and 共e兲 to discuss the clinical implications of MC calculated dose distributions.
We expect that areas of concern outlined in this report
will be further investigated and that more detailed reports
providing recommendations on the major issues will be
forthcoming.
Medical Physics, Vol. 34, No. 12, December 2007

4820

I.C. Organization of the report

Following the introductory section 共Sec. I兲 we begin in
Sec. II with a review of the MC method as it applies to
photon and electron transport. We include in this section an
overview of MC simulation from the accelerator treatment
head to the patient as well as a discussion of variance reduction techniques and efficiency-enhancing methods integral to
MC calculations in radiotherapy. Section III begins with a
review of the major MC codes being used in clinical application and is followed by detailed discussions on accelerator
treatment head modeling and patient-specific treatment planning. This section concludes with the topic of experimental
verification, in which guidance is provided on the types of
tests needed to verify the accuracy of MC dose calculation
algorithms. In Sec. IV we provide a review of recent studies
demonstrating the potential clinical impact of MC dose calculations in comparison with conventional algorithms. Finally, we conclude in Sec. V with a summary of the recommendations from this task group report.
II. THE MONTE CARLO METHOD IN
RADIOTHERAPY DOSE CALCULATIONS
II.A. Definition of the MC method and historical
background

Most generally, the MC technique is a statistical method
for performing numerical integrations. MC simulations are
employed in many areas of science and technology. Although
a method based on random sampling was discussed as early
as 1777 by Buffon,6 the MC technique as we know it today
was first developed and named at the end of the second
world war. The motivation was to apply MC techniques to
radiation transport, specifically for nuclear weapons.7 The
driving forces for the initial idea appear to have been Stanislaw Ulam and John von Neumann who saw the development
of ENIAC, the first electronic computer, as an ideal opportunity to develop new applications of statistical sampling.
The developments of MC techniques and computers have
been closely intertwined ever since, with an exponential increase of the application of MC simulations since digital
computers became widely available in the 1950s and 1960s.
Modeling of particle transport problems is ideally suited
for the use of MC methods and has been described by Rogers
and Bielajew as follows: “The Monte Carlo technique for the
simulation of the transport of electrons and photons though
bulk media consists of using knowledge of the probability
distributions governing the individual interactions of electrons and photons in materials to simulate the random trajectories of individual particles. One keeps track of physical
quantities of interest for a large number of histories to provide the required information about the average quantities.”8
As a technique for calculating dose in a patient the underlying physical basis is much simpler in concept than analytic
algorithms because the MC method consists of a straightforward simulation of reality and does not involve complex
approximations nor models of dose deposition, but only a
knowledge of the physics of the various interactions which

4821

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

have been well understood for over 50 years in most cases.
While some of these interactions may be complex to simulate in detail, the basic ideas of each interaction, e.g., an
electron giving off a bremsstrahlung photon, are well understood by medical physicists and, hence, the overall process is
easy to comprehend.
Although MC was used in several particle physics applications to simulate electron-photon showers in the 1950s, the
seminal paper in the field was that of Berger in 1963,9 in
which he described the condensed history technique for electron transport. This technique is the basis of all modern
electron-photon transport MC codes relevant to medical
physics. The ETRAN code, based on these ideas10 was developed by Berger and Seltzer and now forms the basis of electron transport in the MCNP code.11 The release of the EGS4
MC code system in 198512 served as a catalyst for the application of the MC method in radiotherapy calculations of dose
and dosimeter response. The work of Petti et al.,13 Mohan et
al.,14 and Udale15 being early examples of the use of the EGS
MC code system12,16,17 to simulate medical linear accelerators. Even without the direct use of MC simulations, the MC
method already plays a significant role in radiotherapy treatment planning since the energy deposition kernels used in
convolution/superposition algorithms have been calculated
using MC techniques. Linear accelerator calibration protocols 共e.g., AAPM’s TG-51兲18 use factors derived from MC
simulations. MC-based calculations are also used in the design of treatment head components.19,20
Although it has only recently become practical, for over
two decades the application of MC techniques to radiation
treatment planning has been quite clear.21,22 The widely used
23
17
BEAM code system is a pair of EGS4 共now EGSnrc兲 user
codes for simulating radiation transport in accelerators and in
patients represented by CT data sets. These relatively easy to
use tools have sparked intense research in MC-based radiotherapy treatment planning and have lead to two comprehensive reviews of accelerator simulations by Ma and Jiang24
and Verhaegen and Seuntjens.25 Kawrakow and Fippel,
among others, have provided the breakthroughs which have
made clinical treatment planning feasible, as discussed in
Sec. III A. The fast MC codes being developed commercially
are almost all based on the results of this collaboration. As
this report is being written, the first commercial MC systems
have already been introduced into routine clinical treatment
planning for electrons26 and photons.27
II.B. Monte Carlo simulation of electron and photon
transport

The following material represents a very brief introduction into the MC simulation of electron and photon transport.
For more details the reader is referred to the reviews available in the literature.8,28–31 Another source for detailed information is the documentation accompanying some of the general purpose codes, for instance, the EGSnrc,17 MCNP,32 and
34
GEANT4 共Ref. 33兲 manuals, and the PENELOPE paper.
In the energy range of interest for external beam radiotherapy 共megavoltage range兲, photons interact with surroundMedical Physics, Vol. 34, No. 12, December 2007

4821

ing matter via four main processes: incoherent 共Compton兲
scattering with atomic electrons, pair production in the
nuclear or electron electromagnetic field, photoelectric absorption, and coherent 共Rayleigh兲 scattering. The first three
collision types transfer energy from the photon radiation field
to electrons or positrons. In most cases Compton scattering is
the dominant interaction, although pair production becomes
increasingly important with increasing energy, and may even
dominate at higher energies in high-Z components of the
treatment head of medical linear accelerators.
When electrons traverse matter, they undergo a large
number of elastic interactions and lose energy by two main
processes: inelastic collisions with atoms and molecules and
radiative interactions. Inelastic collisions result in excitations
and ionizations. Ionizations lead to secondary electrons,
sometimes referred to as “␦ particles”. Radiative energy
losses, which occur in the form of bremsstrahlung and positron annihilation, transfer energy back to photons and lead to
the coupling of the electron and photon radiation fields. One
therefore speaks of coupled electron-photon showers.
The electron-photon macroscopic radiation field can be
described mathematically by a coupled set of integrodifferential transport equations. These transport equations are prohibitively complicated thereby excluding an analytical treatment except under severe approximations. The MC
technique is a solution method that can be applied for any
energy range and underlying geometry and material composition.
A solution of the transport problem of particles in matter,
which is exact within the existing knowledge of the elementary collision processes, can be obtained by an analog MC
simulation. In an analog simulation all particle interactions
with surrounding atoms and molecules are explicitly simulated, including those of secondary particles created in the
collisions. An analog MC technique is therefore a faithful
simulation of physical reality on a digital computer: particles
共photons for example兲 are “born” according to distributions
describing the source, they travel a certain distance, determined by a probability distribution, to the site of a collision,
and scatter into another energy and/or direction state, possibly creating additional particles. These photons eventually
“die” as a result of pair production or photoelectric events or
when they Compton scatter to energies below a predetermined low-energy photon cutoff, often called PCUT. Analog
simulations, often referred to as “event-by-event” or
“interaction-by-interaction” techniques, are typically used
for the transport of neutral particles. The analog simulation
of charged particle transport is not practical, due to the large
number of interactions they undergo until locally absorbed as
the energy of the charged particle falls below the predetermined low-energy limit for tracking charged particles, often
call ECUT. All general purpose MC codes therefore employ
condensed history schemes for charged particle transport,
discussed in more detail in Sec. II B 2.
Within a MC simulation, quantities of interest can be
computed by averaging over a given set of particle showers
共also referred to as “histories,” “cases,” “trajectories,” or
“tracks”兲. One can calculate both observable 共measurable兲

4822

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

quantities, such as dose or a particle spectrum, and quantities
that cannot easily be measured such as the fraction of particles originating from a certain component of the treatment
head, the dose fraction due to scattered photons, etc. Although there are techniques for scoring quantities at a point
when using Monte Carlo techniques, in treatment planning
applications, it is usual to score quantities 共dose mainly兲 averaged over some finite volume or voxel. As the voxel size is
increased, for a given statistical uncertainty the total calculation time will decrease, but the spatial resolution is reduced
共see Sec. III D 6 for more discussion兲. Another important aspect of MC calculations is the presence of statistical uncertainties due to the statistical nature of the method, which is
discussed in more detail in Sec. III D 1.

II.B.1. Analog simulations
An analog simulation of particle transport consists of four
main steps:
共1兲 Select the distance to the next interaction.
共2兲 Transport the particle to the interaction site taking into
account geometry constraints.
共3兲 Select the interaction type.
共4兲 Simulate the selected interaction.
Steps 1–4 are repeated until the original particle and all
secondary particles leave the geometry or are locally absorbed. A particle is considered to be locally absorbed when
its energy falls below a specified threshold energy.
Step 1 is based on the probability, p共r兲dr, that a particle
interacts in an interval dr at a distance r from its initial
position
p共r兲dr = e−␮r␮dr,

共1兲

where ␮ is the linear attenuation coefficient 共number of interactions per unit length兲. A random distance r distributed
according to p共r兲 can be sampled using the so-called inversetransform method, which equates the cumulative probability
of p共r兲 with a random number ␰ distributed uniformly between zero and unity

冕 ⬘ ⬘
r

p共r 兲dr = ␰ ⇒ r = −

0

ln共1 − ␰兲
.
␮

共2兲

Step 2 involves basic ray tracing, which requires a geometry model that can provide the medium and mass density of
a region together with a computation of the distance to the
next geometry boundary along the particle trajectory.
Step 3 is similar to step 1 except that now the probability
distribution function is discrete, i.e., it involves a fixed number of final states i, corresponding to an interaction of type i.
Suppose that the cross section for interaction of type i is
denoted by ␴i and the total cross section by ␴ = ⌺␴i. A direct
application of the inverse-transform method for n interaction
types yields interaction 1 if ␰ ⱕ ␴1 / ␴, else interaction 2 if ␰
ⱕ 共␴1 + ␴2兲 / ␴, else interaction n, if ␰ ⱕ 共␴1 + ␴2 + ¯ + ␴n兲 / ␴.
Perhaps the most difficult part is step 4, where one must
sample energy/direction changes from the differential cross
Medical Physics, Vol. 34, No. 12, December 2007

4822

section of the selected process. The manuals of the popular
general purpose codes17,32–34 provide details of the methods
employed for the relevant photon interactions.
Based on the above discussion it should be clear that an
analog MC simulation is conceptually quite straightforward.
II.B.2. Condensed history simulations
The condensed history technique was first described comprehensively in the pioneering work by Berger.9 It is based
on the observation that the vast majority of electron interactions lead to very small changes in the electron energy and/or
direction. Many such “small-effect” interactions can therefore be grouped into relatively few condensed history “steps”
and their cumulative effect taken into account by sampling
energy, direction, and position changes from appropriate distributions of grouped single interactions, e.g., multiple scattering, stopping power, etc. Berger defined two main classes
of condensed history implementations. In a class I scheme all
collisions are subject to grouping. The effect of secondary
particle creation above specified threshold energies are taken
into account after the fact 共i.e., independently of the energy
actually lost during the step兲 by setting up and transporting
the appropriate number of secondary particles. In this way
the correlation between large energy losses and secondary
particle creation is lost. In a class II scheme interactions are
divided into “hard” 共sometimes also referred to as “catastrophic”兲 and “soft” collisions. Soft collisions are subject to
grouping as in a class I scheme; hard collisions are explicitly
simulated in an analog manner.
A class II scheme can be described with the same four
basic steps that make up an analog simulation. The two main
differences are that only hard collisions are included and that
step 2 is much more difficult because the particles do not
move on straight lines and because it involves the selection
of energy, direction, and position changes from multiple scattering distributions. It is also frequently necessary to divide
the distance between catastrophic interactions into shorter
condensed history steps to guarantee the accuracy of the
simulation. As in an analog simulation there is a transport
threshold energy. Particle transport thresholds are often the
same as the particle production thresholds dividing hard and
soft collisions, but this is not a necessary condition.
A class II MC simulation is illustrated in Fig. 1. The upper
portion shows a complete electron track including secondary
electrons and photons 共shown with dashed lines and not including their interactions兲 with energies above the hard collision thresholds. The lower portion is a magnified view of
the shaded box. The actual curved path has been simulated
using four condensed history steps. The filled circles and
arrows show the positions and directions at the beginning of
the steps. The shaded area around the electron track indicates
the region where the energy of subthreshold secondary particles is in reality deposited. If this volume is small compared
to the calculation resolution 共i.e., voxel size in the case of
radiotherapy calculations兲, energy deposition can be considered local and modeled using a restricted stopping power
along the electron track. Note that the initial and final posi-

4823

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

FIG. 1. Illustration of a class II condensed history scheme for electron transport. The upper portion shows a complete electron track including secondary
electrons and photons 共shown with dashed lines and not including their
interactions兲 with energies above the hard collision thresholds. The lower
portion is a magnified view of the shaded box.

tions of a step are not connected in the figure to highlight the
fact that a condensed history implementation does not provide information on how the particle goes from A to B 共the
curved dashed line connecting A and B is a more realistic
representation of the trajectory than a straight line from A to
B兲. This becomes important when the scoring grid is not the
same as the underlying geometry grid or when a single condensed history step traverses more than one geometrical region as in some of the fast MC codes specialized for use in
radiotherapy.35–39 This consideration highlights another important aspect of a condensed history simulation, namely the
way the transport is performed in the vicinity of or across
boundaries between different regions. The EGSnrc code, for
instance, utilizes single scattering 共i.e., analog兲 simulation
within a certain perpendicular distance from an interface.40
Although this approach is necessary for accurate simulations
of certain types of geometries, it is generally not needed for
typical radiotherapy calculations.
Although the condensed history technique makes use of
practical MC simulations possible, it introduces the step size
as an artificial parameter. Dependencies of the calculated results on the step size have become known as step-size
artifacts.41 Step-size artifacts were a major factor in the early
years of most general purpose MC codes. Due to significant
theoretical developments in the nineties the condensed history technique is now well understood.42,43 This has lead to
the development of high accuracy condensed history
implementations40,44 and faster MC codes that can compute
dose distributions with accuracy comparable to traditional
MC packages in a small fraction of the time.35–39,45
With charged particle transport one stops tracking the particle’s movement at some low-energy cutoff and the choice
of the cutoff can affect the calculation in two important
ways. The higher the value of the cutoff, the faster the calculation; this can improve the calculation speed significantly.
On the other hand, unless great care is taken, stopping at too
high a cutoff energy can distort the dose distribution since
the “stopped” charged particle might have deposited energy
some distance from where its trajectory was terminated.
Thus care must be taken in selecting an energy cutoff.
Medical Physics, Vol. 34, No. 12, December 2007

4823

FIG. 2. Illustration of the components of a typical Varian linear accelerator
treatment head in photon beam mode. Phase space planes for simulating
patient-dependent and patient-independent structures are also represented.
For other manufacturers, component structures 共such as the jaws, MLC, etc.兲
may be in different locations, thereby potentially requiring a change in the
placement of the phase space scoring planes.

II.C. Overview of Monte Carlo-based radiotherapy
dose calculations

It is possible to carry out a single MC simulation in which
one starts with the electron exiting from the accelerator
structure, follows it and its descendants 共e.g., bremsstrahlung
photons, knock-on electrons兲 through the fixed elements of
the head 共targets or scattering foils, primary collimators,
monitor chambers, flattening filters, etc.兲, the various beam
shaping devices which are patient specific 共jaws, multileaf
collimator 共MLC兲, applicators, cutouts, wedges, compensators兲, and finally the patient as specified by a CT or some
other data set. This tracking of the initial particle and all of
its descendants is referred to as a history. As discussed further in Sec. III D 1.1, it is important to include all particles
associated with a single initiating electron as part of the same
history.
Due to significant improvements in the efficiency of photon beam treatment head simulations,46 the speed of the complete simulation is such that it is feasible to consider performing the entire calculation for each patient.47 However,
there have been a variety of strategies for dividing such calculations into several steps. The first step, transporting particles through the patient-independent elements, can be inefficient without the use of advanced variance reduction
techniques 共see Sec. II D兲. This is especially true for photon
beams, since many bremsstrahlung photons generated in the
target will strike the primary collimator and not contribute to
the beam reaching the patient. One approach to improve the
simulation efficiency is to first perform the simulation of the
patient-independent structures and to store what is called a
phase-space file at a plane just below the fixed elements of
the accelerator head 共see phase-space plane 1 in Fig. 2兲. The
phase-space file contains phase-space parameters for all particles as they cross the scoring plane. The phase-space parameters consist of the energy, position, direction, charge,
and possibly other information such as the region/s of cre-

4824

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

ation or interaction of particles. The advantage of this approach is that this part of the calculation can be reused as
often as necessary. Particles are then transported through the
patient specific collimation system and are either stored in
another phase-space file at the base of the accelerator 共see
phase-space plane 2 in Fig. 2兲 or tracked through the patient
in the same simulation. Storing a second phase-space may be
more efficient when open fields 共e.g., 10⫻ 10 cm2 fields兲 are
used for treatment, however, more commonly, when MLCs
are used for beam shaping, the latter approach is likely to be
more efficient.
As we will discuss in Sec. III C, the entire phase-space
data for the accelerator may also be generated using beam
modeling 共virtual source model兲 approaches which do not
require direct MC simulation of the accelerator for each
treatment. One class of virtual source models is based on
characterizing the results of a MC simulation of the accelerator head and another class is based solely on measured
beam data such as depth-dose curves, profiles and output
ratios. In either case, the patient-dependent components 共e.g.,
the MLC兲 are simulated using either explicit transport methods or approximate transport methods before detailed transport in the patient.
As with conventional planning methods, experimental
verification forms an integral part of the clinical implementation of a MC dose calculation algorithm. MC algorithms
will benefit from similar experimental verification procedures as conventional systems, and as such should follow the
commissioning procedures detailed in the AAPM TG-53
report48 and other relevant publications.49,50 Experimental
verification in more complex fields and/or heterogeneous geometries is useful to verify the expected improved accuracy
associated with MC calculations in these situations.

II.D. Variance reduction techniques and efficiency
enhancing methods

The efficiency, epsilon 共␧兲, of a MC calculation is defined
as: ␧ = 1 / s2T, where s2 is an estimate of the true variance 共␴2兲
of the quantity of interest and T is the CPU time required to
obtain this variance. Since both Ns2 and T / N are approximately constant, the efficiency is roughly independent of N,
the number of histories simulated. There are two ways to
improve the efficiency of a given calculation: either decrease
s2 for a given T or decrease T for a given N while not changing the variance. Techniques which improve the efficiency by
changing the variance for a given N while not biasing the
result 共i.e., not changing the expectation value which is the
value expected in an infinitely long run兲 are called variance
reduction techniques. Variance reduction techniques often increase the time to simulate a single history and are only
useful if the overall efficiency is improved. A given technique may increase the efficiency for some quantities being
scored and decrease it for others. In contrast to variance reduction techniques, there are a variety of ways to speed up a
given calculation by making an approximation which may or
may not affect the final result in a significant way.
Medical Physics, Vol. 34, No. 12, December 2007

4824

Bremsstrahlung splitting and Russian roulette of secondary particles are widely used variance reduction techniques
which are especially useful in simulating an accelerator treatment head.23,46 In the various forms of bremsstrahlung splitting, each time an electron is about to produce a bremsstrahlung secondary, a large number of secondary photons with
lower weights are set in motion, the number possibly depending on a variety of factors related to the likelihood of
them being in the field. If the number of photons created is
selected to minimize those that are not directed toward the
patient plane, then there is a further saving in time. Russian
roulette can be played whenever there is little interest in a
particle resulting from a specific class of events. The low
interest particles are eliminated with a given probability, but
to ensure an unbiased result, the weights of the surviving
particles are increased by the inverse of that probability. A
common example is to play Russian roulette with secondary
electrons created from photon interactions in treatment head
structures. Another variance reduction method, photon forcing, may sometimes be used to enhance the production of
electrons in the air downstream of the accelerator. In a photon forcing scheme, the parent photon is forced to interact in
a given geometric region and the weights of the resulting
particles are adjusted accordingly to maintain an unbiased
result.
Range rejection and increasing the energy at which electron histories are terminated 共energy cutoffs兲 are examples of
methods which, when used correctly, improve efficiency by
decreasing the time per history without significantly changing the results. In range rejection, an electron’s history is
terminated whenever its residual range is so short that it cannot escape from the current region or reach the region of
interest. In most implementations this ignores the possible
creation of bremsstrahlung photons while the electron loses
energy which means this is an approximate technique. When
applied to electrons below a certain energy threshold, this
form of range rejection produces the same results in a reduced computing time.23 It is also possible to implement
range rejection in a manner which properly accounts for
bremsstrahlung production and thus make it an unbiased
variance reduction technique. By stopping tracking of electrons at a higher energy, efficiency can be improved, but this
may have an effect on the dose distribution if too high a
threshold is used. Playing Russian roulette with particles at
energies below a relatively high transport cutoff or with
range-rejected particles is a comparable variance reduction
technique for reducing the simulation time. However, its
implementation is typically more difficult and this has favored the use of range rejection and high transport cutoffs in
situations where it is easy to demonstrate that the resulting
error is sufficiently small.
There are other variance reduction and efficiency enhancing techniques which collectively have allowed substantial
increases in the speed of a calculation. These methods include the reuse of particle tracks,37 and other adaptations of
particle track reuse, such as the simultaneous transport of
particle sets 共STOPS兲 approach of Kawrakow,36 which is a
variance reduction technique. For a more comprehensive re-

4825

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

view of variance reduction and efficiency enhancing techniques, readers are referred to a chapter by Rogers and
Bielajew51 and the papers by Rogers et al.23 and Kawrakow
et al.46,52 Other useful references on the influence of variance
reduction methods in the context of phantom and patient
treatment planning are provided in the articles by Ma et al.53
and Kawrakow and Fippel.45
In summary, variance reduction techniques are an important requirement for the use of MC calculations in the clinical setting; without them, calculation times would still be too
long for use in most situations. However, inappropriate use
of a variance reduction technique can reduce calculation efficiency, thus increasing calculation time. In principle variance reduction techniques, implemented correctly, do not alter the physics and thereby produce unbiased results. Other
efficiency improving techniques can significantly alter the
accuracy of the calculation if applied inappropriately. Improper implementations can lead to unpredictable results in
either case.
It is incumbent upon the medical physicist to understand,
at a minimum, those techniques that the user can adjust in a
clinical MC algorithm. In addition, tests must be done to
show correct implementation of those techniques over the
range of clinical situations. Vendors should provide adequate
documentation for users to understand the techniques employed and how the implementation was validated.
III. MONTE CARLO SIMULATION OF RADIATION
TRANSPORT IN ACCELERATORS AND
PATIENTS
III.A. Review of current Monte Carlo codes

A large number of general purpose MC algorithms have
been developed for simulating the transport of electrons and
photons. Perhaps the most widely used of these in medical
physics is the EGS code system.12,16,17,40,44 There are several
other comparable general purpose systems used in medical
physics such as the ITS 共Refs. 54 and 55兲 and MCNP
systems11,32 both of which have incorporated the electron
transport algorithms from ETRAN 共Refs. 10 and 56兲 which
was developed at NIST by Berger and Seltzer following the
condensed history techniques proposed by Berger.9 Other
newer general purpose systems include PENELOPE 共Ref. 34兲
and GEANT4.33 The EGS and ITS/ETRAN and MCNP systems are
roughly of the same efficiency for calculations in very simple
geometries when no variance reduction techniques are used,
whereas the other systems tend to be considerably slower. An
important special purpose code is the EGS user code,
23,57–60
BEAM.
The BEAM code is optimized to simulate the
treatment head of radiotherapy accelerators and includes a
number of variance reduction techniques to enhance the efficiency of the simulation.46 Comprehensive reviews of MC
simulation of radiotherapy beams from linear accelerators
are available elsewhere.24,25
While the accuracy of these general-purpose codes can be
roughly the same as long as they are carefully used, these
codes are considered too slow for routine treatment planning
purposes. Several groups have published on the use of parMedical Physics, Vol. 34, No. 12, December 2007

4825

allelization of MC techniques over multiple computers to
provide more reasonable turn-around times for simulation in
clinical research.61–63 Specific to radiation therapy, there
have been a variety of MC codes developed to improve the
calculation efficiency, especially in the patient simulation.
The PEREGRINE system 共North American Scientific: Nomos
Division兲 was developed at the Lawrence Livermore National Laboratory and has been benchmarked against
measurements.27 The PEREGRINE electron transport algorithm
is a modified version of the EGS4 condensed history implementation. PEREGRINE uses the random hinge approach64 for
electron transport mechanics. Several efficiency enhancing
and variance reduction techniques are implemented in PEREGRINE, including source particle reuse, range rejection, Russian roulette and photon splitting. Parallelizing the calculation on several computer processors is also implemented to
reduce the overall dose calculation time. The system decouples the scoring zones from the transport geometry.
Source modeling in PEREGRINE is achieved by performing a
full MC simulation of the accelerator head using the BEAM
code23 and using the output to create a source model65 from
which source particles are regenerated above the patientdependent beam modifiers. PEREGRINE uses several approximations when transporting the beam through the patient specific beam modifiers, followed by transport through a
patient’s CT data set.66 The PEREGRINE system was the first
MC algorithm to receive FDA 510-K approval and represents the first commercially available photon beam treatment
planning system in the United States.
Several commercial MC implementations currently available or under development are based on the Voxel Monte
Carlo 共VMC兲 series of codes. The initial version37 of VMC was
only applicable to electron beams and involved several approximations in the modeling of the underlying interaction
processes. Improved treatment of multiple elastic scattering67
was incorporated in 1996, PENELOPE’s random hinge method
in 1997,68 and all remaining approximations removed in
2000.45 A photon transport algorithm was added in 1998,35
which included precalculated interaction densities in each
voxel similar to approaches developed previously.69,70 The
resulting code was named XVMC. In 1999, a series of advanced variance reduction techniques were developed and
incorporated into XVMC which brought an additional factor
of 5–9 increase in simulation speed. Treatment planning applications and experimental verification of VMC-based systems have been reported in several articles.71–75 Separate versions of the VMC code were subsequently developed by
Fippel 共XVMC兲 共Refs. 45 and 76 and Kawrakow 共VMC++兲36.
XVMC is being incorporated into the Monaco 共CMS兲, PrecisePlan 共Elekta兲, and iPlan 共BrainLab兲 treatment planning
systems. VMC++ includes additional refinements in the physics models, such as the exact Kawrakow–Bielajew multiple
scattering formalism,77 including relativistic spin effects,17
and the STOPS method 共mentioned in Sec. II D兲. VMC++ is
the basis for the first commercial electron MC algorithm
from Nucletron and is being incorporated into the Masterplan 共Nucletron兲 and Eclipse 共Varian兲 treatment planning
systems for photon beam dose calculations. The VMC/XVMC/

4826

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

VMC++ code systems have also been integrated into several

MC-based research systems including those at the University
of Tubingen, McGill University, and the Virginia Commonwealth University.
Another MC code that has reached commercial implementation is the Macro Monte Carlo 共MMC兲 method38,78 for
electron beam treatment planning. MMC uses the MC technique, but is very different from the standard simulation of
radiation transport. MMC uses a precalculated database from
EGSnrc simulations of electron transport through small
spheres of varying sizes and materials and follows a random
walk through the CT phantom based on these precalculated
values. The commercial implementation of MMC, eMC,
共Eclipse, Varian兲 makes use of some precalculated
accelerator-specific information; however, fluence intensities
arising from the various subsources are fitted to the user’s
measured data.79 More details on the performance of the
eMC system for clinical electron dose calculations is available elsewhere.80
There are several institutions currently engaged in developing MC radiotherapy applications for clinical and/or research related purposes. MCDOSE 共Ref. 53 and 81兲 is among
the first of these types of systems. MCDOSE is based on EGS4
and includes fundamental changes in some aspects of the
electron transport in order to improve speed. MCDOSE has
been shown to give results very similar to EGS4.53 It performs
particle tracking through the beam modifiers in conjunction
with the patient calculation and has built-in capability to
handle various models of the incident beam. The speed ups
have been obtained by using various techniques 共bremsstrahlung splitting, photon forcing, track repetition,37 and range
rejection兲.
The MCV 共Monte Carlo Vista兲 82 code is used for clinical
IMRT planning and verification61 as well as for a variety of
research related applications. MCV interfaces photon-electron
MC dose algorithms to the Pinnacle 共Philips Radiation Oncology Systems, Madison, WI兲 commercial planning system,
and calculations are performed in a parallel environment using multiple Unix-based processors.82 Treatment head simulation is accomplished using a modified version of the BEAM
code, with calculations divided into two stages, based on the
patient-dependent83 and patient-independent component
structures.82 Patient and phantom calculations 共within MCV兲
are completed using DOSXYZnrc,58 VMC++ 共described
above兲, or MCVRTP, a C++ MC code developed by Philips
that uses many of the algorithms of EGS4.82 MCV utilizes
variance reduction techniques inherent to the subcodes it
uses, and achieves speed by use of multiple processors.82
Another major research code is the dose planning
method39 共DPM兲 code system developed initially for performing electron beam dose calculations in a voxelized geometry.
DPM utilizes the Kawrakow–Bielajew multiple scattering
formalism77 and the random hinge approach for transport
mechanics.64 Particles do not stop at boundaries39 as is the
case with other fast codes. DPM has been integrated into the
University of Michigan’s in-house treatment planning system
共UMPlan兲 and is currently being used for a variety of photon
beam treatment planning studies.84,85
Medical Physics, Vol. 34, No. 12, December 2007

4826

An MCNP 共Monte Carlo N-particle兲-based code, RT_MCNP
共Ref. 86兲 has been in use for treatment planning research at
UCLA. There have been a series of publications related to
the use of RT_MCNP for a variety of applications, from radiosurgery to IMRT planning using a micromultileaf
collimator.86–91 Finally, treatment planning studies using the
92–94
95
GEANT,
PENELOPE, gamma electron positron transport
96,97
and ORANGE 共Ref. 98兲 共MCNP-based兲
system 共GEPTS兲,
MC codes have also been reported.
In an effort to quantify the speed and accuracy for the
phantom component of the calculations by the various MC
codes being used for research and/or clinical planning purposes, Rogers and Mohan99 proposed what came to be
known as the ICCR benchmark. The tests and geometries for
the ICCR benchmark comparisons were as follows:99 共a兲
speed test: phantom of dimensions 30.5⫻ 30.5⫻ 30 cm with
共5 mm兲3 voxels filled either randomly with one of 4 materials 共water, aluminum, lung, and graphite兲 or with water
alone, 6 MV photons 共spectrum兲 from a point source at 100
cm SSD and collimated to 10⫻ 10 cm2 at the phantom surface, 共b兲 accuracy test: heterogeneous phantom as defined in
共a兲 with 5 ⫻ 5 ⫻ 2 mm voxels 共2 mm along the depth axis兲,
18 MV photons 共spectrum兲 from a point source at 100 cm
SSD and collimated to 1.5⫻ 1.5 cm2 at the phantom surface.
Beam spectra268 were provided for these comparisons in order to standardize the beam model used in the dose calculations. Statistical uncertainties were to be reported as the relative uncertainty in the dose for voxels with a dose greater
than some arbitrary lower limit, such as 50% of the maximum dose.99 Results for the ICCR benchmark are summarized in Table I. Some timing results have been added recently. Timing values have been scaled to that on a single
Intel P-IV 3.0 GHz processor.
The reader should be aware that the timing results reported in Table I are susceptible to large variations 共on the
order of at least 20%兲 due to variations in compilers,
memory size, cache, etc.99 Timing comparisons for more
clinically relevant treatment plans are presented in Sec.
III E 4. These results have been reported by medical physicists using commercial MC systems for treatment planning.
III.B. Accelerator treatment head simulation

III.B.1. Sensitivity of simulations to electron beam
and other parameters
In general one does not know all the details of the clinical
accelerator. For example, the characteristics of the incident
electron beam are only known approximately. Knowledge of
the sensitivity of MC simulation results to input parameters,
such as the position, direction, and energy of the initial electron beam exiting the accelerator and to details of the geometry of the treatment head, is important. A sensitivity analysis
is indispensable in determining which source and geometry
parameters to adjust and by how much in order to improve
agreement with user-specific measurements.
Factors influencing the characteristics of a photon beam
are the energy, spatial, and angular distributions of the electrons incident on the target 共or exiting the waveguide兲, and

4827

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

4827

TABLE I. Summary of timing and accuracy results from the ICCR benchmark. Timing comparisons were
performed using 6 MV photons, 10⫻ 10 cm2 field size, and those for the accuracy test, using 18 MV photons
and a 1.5⫻ 1.5 cm2 field size, as detailed in the ICCR benchmark 共Ref. 99兲. All times have been scaled to the
time it would take running on a single, Pentium IV, 3 GHz processor. Readers should be aware that the timing
results, as well as the method used to scale the times, are subject to large uncertainties due to differences in
compilers, memory size, cache size, etc.
Monte Carlo code

Time estimate
共min兲

ESG4/PRESTA/DOSXYZ

43
0.9
1.1a
1.6
22
7.3b
60c

VMC++
XVMC
MCDOSE 共modified ESG4/PRESTA兲
MCV 共modified ESG4/PRESTA兲
DPM 共modified DPM兲
MCNPX

PEREGRINE
GEANT4 共4.6.1兲

43d
193e

% mean difference relative to ESG4/PRESTA/DOSXYZ

0, benchmark calculation
±1
±1
±1
±1
±1
Maximum difference of 8% at Al/lung interface
共on average ±1% agreement兲
±1
±1 for homogeneous water and water/air interfaces

a

Results not originally part of the ICCR benchmark study, from Ref. 76.
Results not originally part of the ICCR benchmark study, reported independently by author I.J.C. for the
modified version of DPM developed for clinical planning calculations.
c
Timing results not originally part of the ICCR benchmark study, reported independently by author J.J.D.
Calculations were performed using the *F8 共energy deposition兲 tally.
d
Timing and accuracy results not originally part of the ICCR benchmark study, reported independently by
author D.S.-B.
e
Timing and accuracy results not originally part of the ICCR benchmark study. Estimated independently by
author Seuntjens based on Poon and Verhaegen 共Ref. 94兲 and ICCR type speed-test dose calculations 共Ref. 270兲.
Timing results are for the standard physics model; the low-energy and the PENELOPE model lead to a factor of
2 more CPU time. The accuracy result reported is derived from the interface perturbation studies in Poon and
Verhaegen 共Ref. 94兲, applies to 1.25 MeV monoenergetic photon beams and represents the difference with
EGSnrc using PRESTA-II electron step algorithm and “exact” boundary crossing. For a water/Pb interface and
1.25 MeV photons, the maximum difference with EGSnrc increases to 6% 共Ref. 94兲.
b

the dimensions, materials, and densities of all the components interacting with the beam 共the target, primary collimator, flattening filter共s兲, monitor chamber, collimating devices,
such as blocks or MLCs, and beam modifying devices such
as wedges兲. Several investigators have reported on the sensitivity of megavoltage beam simulations to the electron
beam striking the target and other treatment head
parameters.19,100–103 Faddegon et al.,19 in simulating Siemens
accelerators, showed that the key parameters are the mean
energy and focal spot size of the electron beam incident on
the exit window, the material composition and thickness profile of the exit window, target, flattening filter, primary collimator, and the position of the primary collimator relative to
the target. Bieda et al.101 showed that the accelerator simulation for 20 MeV 共Varian-produced兲 electron beams was
very sensitive to the distance between the scattering foils
and, to a lesser extent, to the width of the shaped secondary
scattering foil. Changes to the primary or secondary foil
thickness were found to significantly alter the falloff and
bremsstrahlung components of the depth-dose curve.101
Sheikh-Bagheri and Rogers102 performed calculations of “inair” off-axis ratios and depth-dose curves and compared
these with measurements to derive estimates for the parameters of the electron beam incident on the target, and to study
the effects of some mechanical parameters, such as target
width, primary collimator opening, flattening filter material,
and density. Their study102 included several different photon
Medical Physics, Vol. 34, No. 12, December 2007

beam energies from accelerators produced by different
manufacturers 共Varian, Siemens, and Elekta兲. The electron
beam radial intensity distribution was found to influence the
off-axis ratios to a great extent. The greater the width of the
electron-beam radial intensity distribution, the relatively
more intense is the photon beam on the central axis.102 Figure 3 shows the influence of the electron-on-target energy
and radial intensity FWHM on 40⫻ 40 cm2 field profile
doses from Tzedakis et al.103 The calculated profiles are observed to be quite sensitive to these parameters. The central
axis depth dose curves are also strongly influenced by the
electron-on-target energy.102 However, the central-axis
depth-dose curves are quite insensitive to variation in the
radial intensity distribution of the electron beam striking the
target, because the dose along the central axis is deposited
primarily by particles in the vicinity of the central axis. The
divergence of the electron beam incident on the target also
needs to be considered as it may affect large field profiles.
Regarding the influence of individual treatment head
components, Sheikh–Bagheri and Rogers102 共see Table II兲
showed that even small changes 共0.01 cm兲 in the primary
collimator’s upstream opening can affect in-air off-axis ratios
by restricting the number of bremsstrahlung photons contributing to the scattered photon fluence reaching off-axis points
downstream. Dose profiles are quite sensitive to the composition and density of the flattening filter as noted in Fig. 4,
where two different flattening filter materials were used for

4828

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

4828

chamber is being taken into account. The ion chamber and
mirror are, however, potentially important structures in electron beam simulations. The collimating jaws have no significant effect on the energy and angular photon
distributions.14,107,108 Changing the composition of the secondary collimators from pure tungsten to an alloy containing
50% tungsten by weight does not significantly affect the calculated dose.102
Even in those cases for which the beam model includes an
explicit simulation of the accelerator head, end users of MC
treatment planning algorithms will probably have little control over parameters affecting the treatment head simulation.
It will be incumbent upon vendors to provide accurate beam
models 共verified by measurements兲 for treatment planning
purposes. Vendors and developers should be aware of potential difficulties associated with accurate specification of the
treatment head component structures. Such issues include
difficulty in obtaining proprietary information from accelerator manufacturers, incorrect proprietary information provided by the manufacturers,101,102,104 undocumented accelerator updates, and large uncertainties in important
parameters needed for accurate simulation, such as the
electron-on-target energy. Accelerator vendors are encouraged to make accurate, detailed information of their accelerators accessible in formats easy to implement in MC simulation, as established for instance by Siemens.109
III.B.2. Electron beam specifics

FIG. 3. 共a兲 The lateral dose-profile curves as a function of the FWHM of the
radial intensity distribution for a monoenergetic, 6 MV, electron beam. The
measured profile and five calculated dose profile curves are presented; each
curve is normalized to the central axis. 共b兲 The influence of electron energy
on dose-profile curves. The energy was varied from monoenergetic 5.4 to
6.6 MeV. For clarity only four calculated and measured profiles are presented; each curve is normalized to the central axis. The FWHM of the
radial intensity distribution was 0.3 cm FWHM in all cases. Reprinted from
Tzedakis et al. 共Ref. 103兲 with permission.

the calculations.102,104 The careful specification of the geometry and materials within the MC code is an important consideration. This includes verification of the input of the component geometric specifications, for example, by using the
listing files available with the BEAM 共Ref. 23兲 system. Moreover, for complicated components, such as the flattening filter, independent attenuation calculations of these structures,
using monoenergetic photons, may be helpful to verify their
thickness profiles.105,106 Attenuation of the photon beam by
the monitor ion chamber and the field mirror is negligible
and these structures are often omitted from MC simulations
of photon beams, except when backscatter to the monitor
Medical Physics, Vol. 34, No. 12, December 2007

Simulation of the passage of electron beams through the
treatment heads of accelerators has figured prominently in
MC radiotherapy calculations for many years. The first application of the BEAM code23 was to simulate electron beams
for a wide range of accelerators. A variety of publications
have demonstrated the accuracy of this technique for computing dose distributions and output ratios.24,110,111 Recent
work has established the methodology to achieve high accuracy in matching calculated and measured dose distributions
for even the largest fields, including asymmetries and the
bremsstrahlung tail.112
The procedure for simulating the electron beam treatment
head is quite similar to that of x rays. The components generally important for electron beam therapy treatment head
simulations are shown in Table III. Photon beam components
are also presented for comparison. For electrons, accelerators
from the major vendors use a pair of scattering foils to flatten
the beam with minimal bremsstrahlung contamination. A
low-scatter monitor chamber may be employed and the mirror may be retracted from the beam. The jaw position is
generally fixed for a given applicator and energy such that
the relative output ratio depends only on the custom insert.
The critical parameters for electron beam simulation are
different than those for x rays. Sensitivity analyses provide
quantitative evidence of these differences.100,101,113 Due to
the sensitivity of the beam range to the primary electron
energy 共a 0.2 MeV change in electron energy corresponds
with a 1 mm change in beam range兲, the incident electron
energy is the primary tuning parameter for electron beam

4829

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

4829

TABLE II. A summary of the findings of Sheikh-Bagheri and Rogers 共Ref. 102兲.
Parameter in the linac model
Mean energy of the incident electron intensity
distribution 共assumed Gaussian兲

Gaussian width of the incident electron
energy distribution

Gaussian width of the incident electron radial
intensity distribution

Divergence of the incident electron beam
共at a given intensity distribution FWHM兲
Radius of the upstream opening of the primary
collimator
Density and material of the flattening filter

Impact on in-air off-axis factors

Impact on central-axis depth dose values

Decrease with increasing primary electron energy,
e.g., −0.105± 0.007/ MeV at 15 cm off-axis for a
Siemens KD 6 MV beam. A 0.2 MeV mean energy
change produces an observable effect.
Show little or no dependence, e.g., widening of the
FWHM from 0% to 20% resulted in no change, for a
Siemens KD 6 MV beam. Asymmetrical energy
distribution has a small effect, e.g., an asymmetric
Gaussian with 14% FWHM on the LHS of the peak and
3% FWHM on the RHS of the peak causes a change of
2% for a Siemens KD 18 MV beam.
Decrease quadratically with increasing Gaussian
width, e.g., a change in FWHM from 0.01 to 0.15 cm
leads to 7% decrease at 15 cm off-axis for a Varian 18
MV beam.
Show little or no effect up to 0.5°; at 1° show a
decrease of 1% at 15 cm off axis at 100 cm SSD, for
an 18 MV Varian beam.
Sensitive to small changes, e.g., varying the upstream
opening by 0.01 cm produces a 1% change at 15 cm
off-axis for a Varian 18 MV beam.
Show strong dependence, e.g., reducing tungsten
density by 1 g cm−3 causes a 6% reduction at 15 cm
off axis for a Varian 15 MV beam. Using the incorrect
material has a very large effect, primarily because of
the density change.

A 0.2 MeV change in mean energy
causes an observable change 共2% or 3␴
with 0.7% or 1␴ dose uncertainty兲.

simulations. However, electron distributions are very sensitive to all the materials in the beam, especially the scattering
foils and may also be affected by the monitor chamber if it
has thick walls. Hence, accurate geometric descriptions of all
components in the beam path are required for the simulation
of electron beams. Asymmetries are evident in electron dose

Show weak dependence in the dose
buildup region and at large depths, e.g.,
an asymmetric Gaussian with 14% FWHM
on the LHS of the peak and 3% FWHM
on the RHS of the peak increases buildup
dose by up to 1.5% for a Siemens KD
18 MV beam.
Little or no observable effect
considering statistical uncertainties.

No observable effect up to a few
degrees considering statistical uncertainties
共1% or 1␴兲.
No observable effect.

Not reported.

distributions and parameters to adjust include angle of the
incident beam and the lateral position of shaped scattering
foils and the monitor chamber.
III.C. Modeling of the linear accelerator treatment
head

III.C.1. General schemes
A beam model in the context of MC treatment planning is
any algorithm that delivers the location, direction, and energy of particles to the patient dose-calculating algorithm.
The direct MC simulation of a beam is one form of a beam
model but for clarity we refer to it as a beam simulation
rather than as a beam model. Accurate beam modeling is an
important prerequisite for accurate dose calculation within
the patient. Beam models use one of three possible apTABLE III. Components in the treatment head and other beam modifying
devices for x ray and electron beams.

FIG. 4. MC calculated profiles in a water phantom 共modified DPM, University of Michigan/UMPlan兲 for a 15 MV 共10⫻ 10 cm2兲 at 10 cm depth in
water. Input for the profile calculations were the phase space simulations of
the Varian 21-EX treatment head, performed using BEAMnrc, with two
different material compositions specified for the flattening filter. Open
circles represent the MC profile with a copper flattening filter 共␳
= 8.933 g / cm3兲 and open triangles that with the tungsten filter 共␳
= 19.30 g / cm3兲. Ion chamber measurements are shown in the solid line.
Calculations and measurements are each normalized to the central axis 共Ref.
104兲.
Medical Physics, Vol. 34, No. 12, December 2007

X rays

Electrons

Exit window and target
Primary collimator
Flattening filter
Monitor chamber
Mirror
Asymmetric jaws and MLC
Wedge, blocks, graticule
Bolus

Exit window and primary scattering foil
Primary collimator
Secondary scattering foil may be present
Monitor chamber 共low scatter兲
Mirror
Jaw position fixed for each applicator
Applicator with insert
Bolus, shielding on or below patient surface

4830

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

FIG. 5. The three “routes” for accelerator beam model specification: 共a兲
solid line—direct use of phase-space information from simulation of the
accelerator treatment head, 共b兲 dashed line—multiple 共virtual兲 source models derived from the phase-space information with or without enhancements
from measured data, and 共c兲 dotted line—development of other models derived from measurements 共measurement-driven models兲.

proaches 共see Fig. 5兲: 共i兲 direct use of phase-space information from the accelerator treatment head simulation, 共ii兲 development of virtual, multiple-source models reconstructed
from the treatment head simulation with or without enhancement from measurements, or 共iii兲 development of other models derived exclusively from measurements 共measurementdriven models兲.
While the utilization of direct phase-space information
provides details on the physical interactions within the treatment head, it may not be practical for routine clinical
application.65,93,114–116 Some of the limitations include: 共a兲
generation and quality assurance of phase-space information
requires MC simulation expertise, 共b兲 accurate phase-space
simulation is dependent upon accurate input parameters
共such as the incident electron energy兲 as well as detailed
geometric and material specifications of the accelerator components, which may be subject to inaccuracies, as well as
proprietary issues, 共c兲 storage requirements are large—
typical MC simulation may require up to 109 phase-space
particles for multiple photon beams,115 which may amount to
tens or hundreds of gigabytes of computer disk space for an
accelerator with two photon energies and five electron energies with five different applicator sizes,117 and 共d兲 due to the
much slower pace of speed increase in hard drives and networks compared to CPU speed development, reading the
phase-space data can be a bottleneck in the calculation. It is
therefore clear that a more concise, accurate characterization
of radiation interactions in the treatment head is necessary
for performing routine clinical MC dose calculation.
Another method for beam model specification, initially
Medical Physics, Vol. 34, No. 12, December 2007

4830

proposed by Ma et al.,114 is based on the development of
multiple-source models with parameters derived from the
original simulated phase-space data.65,88,93,114,116–120 In a
multiple-source model, source particles are grouped by the
location of their last interaction prior to being scored at the
phase-space plane, resulting in subsources representing the
major components of the treatment head. Fluence distributions for each subsource may be reconstructed from the
phase-space data in the form of correlated histogram
distributions,65,93,114 thereby approximately retaining correlation of the particle’s position, energy and direction. Although
the development of accurate multiple-source models is also
reliant upon simulation parameters and geometric and material specifications of the component structures, sub-sources
may be “adjusted” 共without redoing the simulations兲, based
on measurements to optimize agreement between calculations and measured data, An example of such an approach
consists of adjusting the spatial or energy boundaries of the
planar fluence and energy distributions for each subsource to
produce agreement with measured dose profiles and depthdose curves, respectively, for a range of square field shapes,
starting with fluence distributions reconstructed from phasespace data for one field size.117,121 For instance, one changes
the range of energies sampled from the discrete energy distribution as a function of radius, to provide a match with
measurements, without having to redo the entire treatment
head simulation. This method has been extended to MCbased commissioning of electron beams.111,121 Models developed for reference accelerators were used to accurately commission 共within 2% / 2 mm of measurements in the high
dose/high gradient profile regions兲 electron beams from other
machines of similar design by adjusting a few parameters in
the model. Implementation of photon and electron beam
multiple-source models has been reported for a variety of
accelerator
manufacturers
including,
Varian,122,123
73,124,125
73,86,88
Siemens,
Elekta,
Novalis 共BrainLab兲,87,89 and
126
Cyberknife.
A possibly more practical approach to beam modeling involves derivation of the model parameters from a standard
set of measurements. The advantage of such measurementdriven models is that they may be developed without dependence on the details of the accelerator treatment head. Fluence distributions in measurement-driven models may be
developed starting with analytical models whose parameters
are optimized based on minimization of the differences between calculations and measurements.100,125,127–131 Information for the model can be deconvolved from measured
data.100,127 Similar methods have been reported for beammodel specification using conventional dose calculation algorithms with good agreement established between calculations and measurements in water phantoms.132–135 The same
beam modeling criteria for conventional dose algorithms
should also be applicable to the MC method although differences in the technical details such as source parameterization
and software implementation are expected. The use of
measurement-driven beam models eliminates the need for
phase-space simulation and, as the model parameters are derived from measurements, may provide an added level of

4831

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

confidence in the accuracy of the model in homogeneous
phantoms. Moreover, specification of beam models is similar
to that with conventional dose algorithms, and does not require expertise with MC accelerator simulation. However,
rigorous verification of measurement-driven models in heterogeneous phantoms is necessary to validate the 共empirically derived兲 fluence distributions. It has been shown that,
in addition to the use of measurements in water phantoms,
test cases in heterogeneous phantoms under conditions of
electronic disequilibrium may be necessary to determine the
correct energy spectrum unambiguously.136
III.C.2. Patient-specific beam modifiers
Transport through the patient-dependent components
共such as the field-defining collimators and the MLC兲 may be
classified into one of the following three schemes, which we
will term: 共a兲 explicit transport, 共b兲 explicit-approximate
transport, and 共c兲 pseudo-explicit transport. In an explicit
transport scheme, all particles 共with appropriate energy cutoff values兲 are transported using MC techniques through the
components; all details of the design geometry 共such as
rounded leaf ends, interleaf spacing, etc. for a MLC兲 should
be included in the geometry modeling.72,115,137 With explicitapproximate transport, approximations are employed in the
MC photon/electron tracking scheme to improve the efficiency of the calculation.83,87,138,139 An example is the approach of Siebers et al.,83 in which only first Compton scattered photons are transported through the MLC. The method
of Tyagi et al.139 includes simulation through the detailed
MLC geometry accounting for all Compton scattered photons, however, ignores the secondary electrons, i.e., assumes
they deposit their energies locally. In a pseudo-explicit transport scheme, beam fluence distributions are reconstructed
from the phase-space simulation to develop subsources for
characterizing components, such as the field defining
jaws,93,120 electron applicators,114 and the MLC.88 Although
the need for time-intensive, explicit transport is obviated
with the use of multiple subsources, the ability to incorporate
detailed geometric characteristics of components like the
MLC may be difficult with this approach. Appropriate
benchmarking must be performed by developers and vendors
to evaluate the tradeoffs between speed and accuracy related
to the use of various beam model approaches in MC-based
modeling of patient-specific beam modifiers.
III.C.3. Output ratios
The output ratio 共or relative output factor兲 is the ratio of
dose per monitor unit in a phantom for an arbitrary field size
to that for a reference collimator setting, the latter usually
10⫻ 10 cm2 at a SAD 共or SSD兲 of 100 cm for a depth of 10
cm for x-ray beams.140 Output ratios over the range of clinically useful field sizes are heavily influenced by the amount
of head scattered radiation impinging on the phantom.140,141
Radiation generated by clinical accelerators can be characterized by a primary photon source generated through the
bremsstrahlung process, and other extrafocal sources accounting for scattered photons arising primarily from the
Medical Physics, Vol. 34, No. 12, December 2007

4831

flattening filter and primary collimator, typically 3% − 8% of
the energy fluence in a 10⫻ 10 cm2 field. The primary
source is a narrow sharp source normally a few millimeters
in diameter, while the extrafocal sources tend to be much
broader, more diffuse and bell-shaped in nature.142,143 The
output ratio is affected by the size and geometry of these
sources. The collimators 共jaws and MLCs兲 block the extrafocal source when the field size is sufficiently small 共⬍3
⫻ 3 cm2兲 and for smaller fields the primary source starts
being blocked by the collimators. The combination of extrafocal source and primary source cutoffs cause the output
ratios to fall off sharply at small field sizes.143,144 Accurate
source modeling of small fields is especially important in
IMRT planning where multiple, small field, off-axis segments are often used.61,87,145 For medium sized fields 共10
⫻ 10 cm2 – 20⫻ 20 cm2兲, output ratios are more likely affected by the extrafocal sources as the collimators are large
enough to expose the entire primary source, however, small
enough to eclipse the extrafocal sources. In large fields, beyond 20⫻ 20 cm2, the extrafocal sources are nearly completely exposed—the increase in output ratios in these situations is primarily a result of phantom scatter, lack of
backscatter from the collimator jaws to the monitor chamber,
and stray radiation from the treatment head.146,147 Depending
on the location of the jaws relative to the transmission chamber 共which varies among the different linear accelerator
types兲, radiation backscattered from the jaws into the chamber can also have an effect on the output ratios. Relative to
large field sizes 共40⫻ 40 cm2兲, backscattered radiation increases by 2% − 3% at small field sizes 共3 ⫻ 3 cm2兲 for 15
MV photons on a Varian 共21EX兲 linear accelerator, for example. Studies for photon beam MC algorithms have shown
calculated output ratios to be within 1.5% of measurements
over a range of field sizes when accounting for backscattered
radiation.27,139,148,149 MC calculated electron beam output ratios 共for field size-specific applicators兲 have also been reported to agree with measurements within 1% – 2%.26,110
III.C.4. Dose buildup
There has been considerable discussion on discrepancies
between MC calculations and measurements in the dose
buildup region. Hartmann-Siantar et al.27 observed MC dose
deficits of up to 5 mm distance-to-agreement versus measurements and attributed these discrepancies to a source of
electrons in the accelerator head not fully accounted for in
the treatment head simulation with BEAM. It has been shown
that arbitrarily increasing the electron contamination by a
significant amount removes the discrepancy.27,88,125 As the
result of further investigation, Ding150 concluded that the discrepancy could not be explained by the electron source hypothesis and postulated that contaminant neutrons emerging
from the treatment head might be the cause. However, Ding
et al.151 subsequently refuted this neutron hypothesis by
measuring minimal neutron component in the dose buildup
region. Abdel-Rahman et al.,152 who performed MC calculations 共using EGSnrc兲 and a comprehensive set of measurements with multiple detectors, again found significant differ-

4832

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

ences between measurements and calculations in the buildup
region for 18 MV photons even when completely simulating
the response of the detectors. They ruled out the following
possible causes of the discrepancy: 共a兲 an unknown electron
source in the accelerator head simulation, 共b兲 contaminating
neutrons, 共c兲 inaccurate cross section data, and 共d兲 共gamma,
p兲 reactions. They also showed that explicit modeling of triplet production interactions influences the dose buildup for an
18 MV beam. However, work by Kawrakow153 showed that
a more accurate triplet production model does not remove
the discrepancies. Benchmarking of the NRCC accelerator
photon beams has shown agreement well within 1%, for field
sizes up to 10⫻ 10 cm2, at all depths154; it should be noted
that the NRCC accelerator 共20 MV photons兲 uses a sweeping
beam technique154 as opposed to a flattening filter to flatten
the beam. These comparisons explicitly accounted for
stopping-power ratio variation with depth.
More recently, Kawrakow,155 in performing detailed ion
chamber simulations using the EGSnrc code system, showed
that the relationship between measured ionization and dose
for relative photon beam dosimetry depends on details of the
chamber design, including cavity length, mass density of the
wall material, size of the central electrode, and cavity radius,
in addition to the beam quality and field size. When the
correct ionization-to-dose relationship was used with the experimental data155 and a variety of other improvements in the
head simulations were made 共e.g., using a larger diameter
primary collimator opening and including the effects of extra
shielding upstream of the jaws or MLC,156 correcting a bug
in the JAWS component of the BEAMnrc code, including an
angular spread in the incident electron beam and several
small effects in the simulation153兲, the discrepancies in the
build-up region were reduced to an acceptable level. Chibani
and Ma showed that resolving inaccuracies in the modeling
of the primary collimator for a Varian 18 MV accelerator as
well as including virtual sources for the lead shield and mirror frame, resulted in significantly better agreement between
calculations and measurements in the dose buildup region.156
Other sources of inaccuracy associated with detectors for
dose buildup measurements are presented in Sec. III E 3.3.

deposition in the phantom. Using an already calculated
phase-space file, the statistical uncertainty in the dose calculated in a phantom by reusing the particles from the phasespace file 共i.e., assuming they are independent and ignoring
correlations between them兲, will approach the finite, latent
variance associated with the phase space data, regardless of
the number of times the phase space is reused. The use of
source models derived from phase space simulation will tend
to smooth out point fluctuations in the phase space.114 However, if the latent variance is large enough to introduce systematic bias then this will be propagated in the reconstructed
phase space 共source model兲. Beam models derived exclusively from measurements, on the other hand, are analogous
to those generated using conventional 共analytical兲
algorithms—latent variance 共as defined above兲 is not a concern for such models, but other systematic uncertainties in
the beam model will be present. In estimating the statistical
uncertainty in the patient dose calculation, it is necessary to
account for the latent variance from the phase-space calculation as well as the random uncertainty from the patient calculation. To make this possible in practice, more work is
needed to develop tools to assess the role of latent variance
in patient dose calculations. Should latent variance be a significant factor in the total uncertainty, more independent
phase-space particles need to be used in the patient simulations. It must be emphasized that all beam models are subject
to systematic uncertainties, which are analogous to those introduced by the latent variance. For measurement-driven
models, these uncertainties will be related to inaccuracies in
the measurement data. Both types of models are subject to
systematic uncertainties due to inadequacies in the model
itself.
There are two common methods for calculating statistical
uncertainties: the batch method and the history-by-history
method. In the batch method, the estimate of uncertainty
共standard error of the mean, sx̄兲 of a scored quantity, X, is
given by

sx̄ =
III.D. Treatment planning: MC-based patient
calculations

III.D.1. Statistical uncertainties
III.D.1.a. Latent variance and statistical estimators. For
a finite number of independent simulated histories 共N兲, the
dose calculated using the MC method is subject to statistical
uncertainty. By invoking the central limit theorem,157 one
can show that the statistical uncertainty in dose is proportional to 1 / 冑 N, in the limit of infinite 共large兲 N. There are
generally two sources of statistical uncertainty in MC calculations of patient dose—those resulting from the simulation
of the accelerator treatment head and those arising from fluctuations in the phantom/patient dose calculation. Sempau et
al.95 coined the term, “latent variance” to describe the uncertainty due to statistical fluctuations in the phase-space as
opposed to the uncertainty due to the random nature of dose
Medical Physics, Vol. 34, No. 12, December 2007

4832

冑

n

共Xi − X̄兲2
兺
i=1
n共n − 1兲

共3a兲

,

where n is the number of independent batches, Xi is the
scored quantity 共such as dose兲 in batch i, and X̄ is the mean
value of X over all the batches. The sample size is therefore
given by the number of batches, where each batch is a calculation of the same quantity carried out with independent
phase-space file inputs and random number sequences. In the
history-by-history method, Xi represents the scored quantity
in history i 共rather than batch i兲 so that the standard error of
the mean can be recast 共in a mathematically equivalent form兲
as follows:
sx̄ =

冑 冉
1
N−1

兺i=1 X2i
N

N

冉 冊冊
兺i=1 Xi
N

−

N

2

,

共3b兲

where N is the number of primary 共independent兲 histories, Xi
the contribution to the scored quantity by independent his-

4833

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

tory, i. An issue evident with the batch approach 关Eq. 共3a兲兴 is
that the sample size, n, is given by the number of batches. As
n is usually small 共on the order of ten or less兲 there is statistical fluctuation in the uncertainty itself. Advantages of the
history-by-history method have been detailed elsewhere.158
An important consideration when calculating uncertainties is to take into account the correlation between a primary
particle and all its secondaries, especially in the case of
bremsstrahlung splitting where a large number of photons
may all come from a single electron. Thus, to be strictly
correct, these secondaries must be treated as part of the same
history. If this correlation is not taken into account one can
underestimate the uncertainty in a dose calculation, as the
secondaries will be treated as independent particles thereby
reducing the uncertainty erroneously. Another important case
of correlation is when a single particle is being used several
times as a source particle. In this situation it is important to
recycle the particles, i.e., use them multiple times, all at once
and treat them as part of the same history. If one were to
restart the phase-space file multiple times, one would lose
the correlation between particles which are all part of the
same history. These secondaries would then be treated as
independent particles causing the uncertainty to be underestimated. A more comprehensive review of the implications of
recycling and restarting phase-space particles is provided in
the paper by Walters et al.158
III.D.1.b. Influence of statistical uncertainties on dose distributions.
For radiation therapy dose distributions, sDi
⬀ 冑Di, where sDi is an estimate of the standard error of the
mean 共standard deviation/ 冑 N兲 of the dose in voxel i and Di
is the dose in that voxel.159–161 The fractional 共or relative兲
uncertainty in dose, FDi = sDi / Di ⬀ 1 / 冑Di. In other words, the
fractional uncertainty in dose in a voxel decreases as the dose
increases. This relationship provides a useful rule of thumb
when viewing dose distributions since it implies that the relative uncertainty in the dose in high-dose regions will be
smaller than in low-dose regions, even though the absolute
uncertainty is usually larger.
From Eq. 共3b兲 we see that the uncertainty is roughly proportional to 1 / 冑 N. Since, the simulation time T ⬀ N, it can be
seen that achieving absolute precision 共sD = 0兲 with MC
simulation requires an infinite calculation time. Fortunately,
absolute precision is not required in dose calculation results.
This section concerns the precision required for MC simulation and the impact of a lack of precision on MC dose distribution quantities.
Radiation therapy dose distributions contain many voxels
in which the dose is computed 共for example, a cubic volume
with sides of 10 cm contains 15 625 voxels with sides of 0.4
cm兲. Since the subvolume receiving a therapeutic dose can
be highly variable, a standardized method to specify the statistical uncertainty for such a distribution is necessary. Although the statistical uncertainty can be specified for a single
voxel in a dose distribution 共such as that at the isocenter or at
the maximum dose voxel, Dmax兲, as described below, these
voxels are poor measures for the uncertainty of a MC computed plan. Alternatively, the statistical uncertainty over
Medical Physics, Vol. 34, No. 12, December 2007

4833

some volume, such as a planning target volume or some dose
volume, such as the volume receiving greater than X% of the
treatment dose, can be computed from the square root of the
average variance of each constituent voxel. For example, the
fractional uncertainty in the average dose for voxels with
dose values greater than 50% of the maximum dose,
F̄D⬎0.5Dmax as suggested by Kawrakow, and Rogers and
Mohan99 could be used

F̄D⬎0.5Dmax =

冑

1

兺

冉 冊
s Di

KD⬎0.5Dmax D⬎0.5Dmax Di

2

,

共4兲

where Di is the dose estimate in the ith voxel, sDi is its
uncertainty, and the summation runs over the K voxels with
dose greater than 50% of Dmax. For clarity in communication, this report recommends that quantities, such as
F̄D⬎0.5Dmax or F̄PTV 共or F̄PRV兲 for doses to the specific volumes, planning target volume 共PTV兲 or planning risk volume
共PRV兲, be adopted as a standard method of reporting statistical uncertainties in dose averaged over the relevant volume.
The use of uncertainties to voxels, such as the maximum
dose should be avoided. In situations where doses in single
voxels are important, such as the maximum dose to a “serial”
organ like the spinal cord, users are reminded to also consider the statistical uncertainty of that dose voxel.162 In such
instances, it may be necessary to simulate a large enough
number of histories so that sDi is very small.162 This will
ensure that the absolute uncertainty in the highest dose voxel
will also be small. The statistical precision required for dose
estimates in single voxels should be decided upon with guidance from the clinician. Users should also note that for a
constant number of source particles, the statistical uncertainty also depends upon the size of the dose voxel. Reducing the volume to achieve a “point-like” voxel will require
increasing the number of particles simulated to achieve constant statistical precision.
To varying degrees, statistical uncertainties affect all measures of the dose distribution, including output ratios, isodose profiles, dose-volume histograms, dose response parameters such as equivalent uniform dose and TCP/NTCP. In a
uniform dose distribution, the dose metrics most sensitive to
statistical uncertainties are the maximum and minimum dose
voxels. These extreme values are by definition the voxels
that have the greatest deviation from the mean dose. If one
desires a region of uniform dose 共e.g., within the PTV兲, that
dose will not be uniform using a MC-based calculation, due
to statistical fluctuations between adjacent dose voxels. The
reported minimum and maximum dose voxels will differ
from the mean of the idealized dose distribution by up to
several standard deviations if many voxels are present in the
distribution.45,163 For example, in a uniform dose distribution
with 15 625 voxels computed with MC algorithms, due to
statistical fluctuations, there is a 63% probability that the
dose in at least one voxel differs from the mean by more than
four standard deviations.45 With regard to dose prescriptions,
the specification of the maximum dose to a single voxel
when there is a desired volume of uniform dose 共e.g., the

4834

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

PTV兲, will result in an underdosage to this volume. Similarly, dose prescription to the minimum dose voxel will result
in an overdose to the relevant volume. Isodose contours are
also sensitive to statistical noise. For well-defined fields,
such as rectangular fields used in beam commissioning, even
1% 共1s兲 statistical uncertainty causes observable jitter in isodose contours. For patient fields that have irregular shapes,
the acceptable amount of statistical uncertainty for isodose
viewing is a matter of personal preference and should be
agreed upon by the planner and the physician. It has been
suggested that 2% statistical uncertainty on the Dmax voxel is
adequate for isodose evaluation.160 When viewing statistical
jitter in MC isodose distributions, the physicist should remind observers that overall dose delivery accuracy is limited
to within a few percent; therefore there is uncertainty in the
actual location of an isodose surface even when dose is computed with non-MC algorithms. From this point of view, the
planning team can use MC isodose jitter as a mechanism to
open the dialog on realistic dose uncertainty in actual treatment delivery.
Integrated dose quantities, such as dose volume histograms 共DVHs兲 are less sensitive to statistical
uncertainty.159–165 DVHs computed with the MC method represent the actual DVH 共that computed with a hypothetical
0% statistical uncertainty simulation兲, convolved with a statistical uncertainty distribution. With this realization, Sempau and Bielajew159 and Jiang et al.165 reported that the effect of the “statistical noise” on DVHs could be removed by
deconvolving the uncertainty from the DVH, allowing substantial decrease in the required number of histories used,
depending on the complexity of the DVH. In general, the
blurring effect due to statistical noise is greatest for steep
DVHs, such as those for PTVs, while shallow DVHs, such as
those for critical structures are less affected.
The sensitivity of quantities such as TCP and NTCP to
statistical noise depends upon the parameters used by the
model164 and on the magnitude of the noise. Kawrakow161
has shown for general dose-based cost functions that the uncertainty in the cost function decreases more rapidly than the
individual dose uncertainties when the plan is close to optimum as expressed by the cost function. This implies that
during IMRT optimization, where plan updates are based
upon evaluation of such cost functions, larger statistical uncertainty might be acceptable.
A method to reduce the effect of statistical uncertainties in
MC dose distributions is to postprocess the dose distribution.
These methods have been termed denoising or smoothing
techniques. Various methods related to digital filtering,166,167
wavelet thresholding,168,169 adaptive anisotropic diffusion,170
and denoising based on a minimization problem171 have been
proposed. A detailed comparison of these methods is presented in the article by El Naqa et al.172 Denoising is an
approximate, efficiency enhancing method 共i.e., it is not a
variance reduction technique兲 since it can introduce systematic bias into the calculation. Nonetheless, denoising techniques are useful as they can reduce the overall 共systematic
+ random兲 uncertainty when the random component deMedical Physics, Vol. 34, No. 12, December 2007

4834

creases more than the systematic component increases.
Kawrakow presented a series of tests to evaluate the suitability of MC dose distribution denoising algorithms.167 These
tests are based on the fact that one can determine the “correct” dose distribution by simulating many histories 共for a
very high precision兲 and then comparing the denoised distribution from a simulation with a much smaller number of
histories to the high precision results. The tests include:
• visual inspection of isodose contours,
• evaluating root-mean-square difference between dose
distributions,
• evaluating the maximum dose difference,
• comparisons of dose-volume histograms with and without denoising, and
• comparing the fraction of voxels failing an x% / y mm
test.
Denoising methods reduce the number of particles 共and,
hence, the calculation time兲 required to achieve a given uncertainty by a factor of 3–10. Denoising techniques require
proper validation under the full range of clinical circumstances before they are used with MC dose algorithms.
III.D.2. Dose prescriptions and monitor unit
calculation
The stochastic nature of the MC method raises questions
for prescribing dose. It is common clinical practice to prescribe dose to a single voxel or to base the dose prescription
on the maximum or minimum dose voxels. However, as discussed above 共Sec. III D 1.2兲, in an approximately uniform
dose distribution, the outliers 共the maximum and minimum
dose voxels兲 are subject to the largest statistical fluctuation
and even other single voxel doses may lack the precision for
monitor unit calculations. Standard treatment planning analysis methods using isodose distributions and dose-volume histograms rely on dose averaged over a volume. It is logical to
extend this practice to the prescription of dose, thereby
avoiding precision issues in doses calculated in small volumes. For example, dose may be prescribed to an isodose
surface, to a region of uniform dose 共averaged over many
voxels兲 about the isocenter, or to a single point on a dose
volume histogram. The practice is emerging to calibrate the
calculated dose distribution by performing a calculation in
the standard geometry where the accelerator is set to deliver
a given dose per monitor unit, 共e.g., 1 cGy/MU兲 at a given
voxel. In this case, the dose at the calibration point may be
calculated to high precision by averaging over a large number of voxels in a uniform dose region.
The issue of monitor unit calculations to specific single
voxels within the target volume 共e.g., the isocenter兲 for routine clinical planning may be confounded by large statistical
fluctuations in the doses to individual voxels. Although the
treatment planning practice is quickly moving toward
volume-based dose prescriptions, particularly for IMRT planning, the ability to perform second MU checks for plan verification purposes is an important component of the standard
practice. Until more efficient solutions are available, MU cal-

4835

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

culations based on single-voxel-dose prescriptions should be
performed with very high precision. That said, this task
group encourages a shift in paradigm from point-based toward volume-based dose prescriptions, which we feel will
soon become the standard method for prescribing doses in
radiotherapy planning. The task group strongly discourages
vendors from using the Dmax or Dmin dose voxels or other
single voxel doses for dose prescription and monitor unit
calculations in their MC-based treatment planning systems.
Current users of MC algorithms are encouraged to find ways
of circumventing point-based dose prescriptions if their systems are not flexible enough to allow otherwise. To obviate
the concerns of dose prescription based on a single voxel,
one institution 共author J.E.C., Ottawa Hospital兲 has developed the following “work around” method for MC-based
electron beam calculations: A dose distribution is calculated
using 100 MU; this dose distribution in absolute terms is
equivalent to a relative isodose distribution normalized to the
standard calibration conditions 共10⫻ 10 applicator, 100 cm
SSD, dmax depth兲. For dose prescription, the physician
chooses the isodose line that encompasses the target. The
dose prescription point is then positioned on this isodose line
along the central axis of the beam, and the treatment MUs
are determined. A second calculation is performed as a check
of the MUs and the final dose distribution.
For multiple 3D-CRT or IMRT fields, the procedure for
generating monitor units is similar to that for single fields.
For example, a given isodose line 共such as the 95% line兲 can
be selected for dose prescription and, for a given field, the
dose contribution to a single voxel 共e.g., the projected field
cax point兲 along this line is determined from the treatment
plan. For a calibrated MC algorithm, the absolute dose contribution from the given field in this voxel 共on the selected
isodose line兲 will be computed in units of cGy/MU, from
which the monitor units for the beam can be calculated. A
complete formalism for MU calculations for the different
types of treatment deliveries has been provided by Ma et
al.173
III.D.3. CT-to-material conversions
For conventional algorithms, electron densities extracted
from the CT image are used to scale the influence of primary
and, ideally, also secondary radiation interactions. MC algorithms utilize material density and the material atomic composition when performing particle transport. The differing
atomic compositions of patient materials 共e.g., soft tissue,
bone, lung, air兲 result in different cross sections for the various radiation interactions. While material compositions cannot be determined solely from a single energy CT, they can
be indirectly approximated by estimating the mass density
from the electron density followed by assigning a material to
each voxel.37,86,174–176 For some MC codes, explicit material
specification is circumvented by directly relating the CT
关Hounsfield 共HU兲兴 numbers to material interaction coefficients, based upon parameterization of materials representative of the patient,37 for example those tabulated in ICRU
Report No. 46.177
Medical Physics, Vol. 34, No. 12, December 2007

4835

To ensure proper correspondence between HU and materials 共or material interaction coefficients兲, correspondence
between these quantities must be established during the CT
and treatment planning system commissioning process. To
ensure appropriate material specifications, it may be desirable to have several conversion tables, whose selection is
based upon knowledge of the particular patient’s characteristics. Use of multiple calibration curves reduces the volume
of inappropriate tissues specified in given regions, such as
lung tissue within a prostate gland, however. Although the
importance of exact material specification has been established in other studies,178 more work in this area of research
relevant to clinical treatment planning is necessary. Other
information about the patient may also be helpful. For example, in a patient with a hip implant, it may be impossible
to distinguish if the implant is titanium, steel, or a composite
based solely on the CT numbers. In this case, material assignment based on knowledge of the material implanted in
the patient would be beneficial. A recent evaluation of the
influence of material compositions on dose distributions178
showed dose errors of up to 10% for 6 and 15 MV photons,
and 30% for 18 MeV electrons due to media and/or mass
density misassignment, when comparing dose distributions
between a known phantom and a CT-imaged phantom with
compositions and densities assigned by a conversion process.
The use of conversion techniques based purely on mass density 共e.g., assuming the only patient material is water, but
with varying density兲, as employed in conventional algorithms, is discouraged with MC simulation because most of
these methods ignore dependencies of particle interactions
on the materials, which can lead to notable discrepancies in
high atomic number materials.176
CT number artifacts caused by issues such as beam hardening in the CT scanning process or by high density structures, such as dental fillings are potentially important in MC
dose calculation. Other artifacts may arise, for example,
when the CT scanner encounters a sharp edge, such as the
surface of a rectangular solid phantom, where a blurred edge
may result after image reconstruction. In one observed case,
the resultant contour showed 3 mm of additional phantom,
causing the MC-calculated percentage depth dose curves to
be shifted 3 mm toward the surface.269 Such issues are of
relevance to both MC- and non-MC-based algorithms and
will need to be taken into consideration in order to perform
accurate dose calculations in the dose buildup region.
As with any dose algorithm, testing should be performed
to evaluate the effect of artifacts on the accuracy of the MC
dose calculation.179,180 It must be emphasized that the accuracy of CT-number to material conversions affects all dose
calculation algorithms, both MC- and non-MC-based methods.

III.D.4. Dose-to-water and dose-to-medium
Historically, radiotherapy dose measurements and calculations have been performed in, or specified in terms of the
absorbed dose to water 共Dw兲. With MC-based algorithms,

4836

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

4836

FIG. 6. MC-based 共MCV system兲 dose-to-medium 共Dm兲
and dose-to-water 共Dw兲 results for a typical head and
neck IMRT treatment plan: 共a兲 Dm, 共b兲 Dw, and 共c兲
DVH comparison. Reprinted from Dogan et al. 共Ref.
181兲 with permission.

particle transport simulations occur in materials representative of patient media; dose is therefore specified to the patient medium 共Dm兲. For tissues with densities near
1.0 g / cm3, the difference between Dw and Dm for megavoltage photon beams is small 共1% − 2%兲, however, for higher
density materials, such as cortical bone, the difference can be
as large as 15%,176 since the stopping powers of water and
these higher-density materials differ more significantly.
Therefore, there is a systematic difference between the dose
computed using conventional analytical algorithms and MC
Medical Physics, Vol. 34, No. 12, December 2007

simulation. Figure 6 shows the dose and DVH differences
between plans calculated with Dw and Dm for a typical head
and neck IMRT treatment plan.181
To use MC simulation in the current clinical practice so as
to be able to compare Dm with historical Dw results, requires
a conversion of Dm to Dw for dose prescriptions, isodose
coverage, dose-volume histograms, and any other dose related metrics. In this context, the converted Dw represents the
dose to a small volume of water embedded in the actual
medium. Whether one should eventually use Dm in place of

4837

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

4837

Dw directly in clinical prescriptions remains the subject of
debate.182 Arguments in favor of using Dw for dose specifications include:
• Historical clinical experience has been derived based on
Dw, hence, Dw allows direct compliance with previous
clinical experience and with conventional dose algorithms. Doses reported in clinical trials are based on Dw,
hence, therapeutic and normal tissue tolerance doses are
based on Dw.
• Accelerator and ionization chamber calibration protocols are Dw based.
• Tumor cells embedded within a medium are more
water-like than medium-like, e.g., a tumor cell embedded in a bone matrix.
Arguments in favor of using Dm for dose specification
include:
• Dm 共or the dose to the tissues of interest兲 is the quantity
inherently computed by MC dose algorithms. This may
be of more clinical relevance than the doses on which
historical clinical experience is based, which are approximate estimates of the true dose in the first place.
• Converting Dm back to Dw may involve additional complexity and introduce additional dose uncertainty.
• The difference between Dm and Dw for tissue equivalent
materials is rather small and is likely to have minimal
impact in clinical practice.
• It is known that, due to organ and target motion, the
dose actually delivered in the course of a treatment may
be significantly different from the planned dose. Conversion of Monte Carlo computed doses to Dw may
analogously necessitate discussions on conversion to
“dose to a static patient,” should 4D planning and delivery techniques become routinely used in the clinic.183
The conversion of Dm to Dw or vice versa requires an
w
,
application of Bragg–Gray cavity theory: Dw = Dm共S̄ / ␳兲m
w
where 共S̄ / ␳兲m is the unrestricted water-to-medium mass collision stopping power averaged over the energy spectra of
primary electrons at the point of interest. One method to
accomplish this conversion176 is to utilize the fact that for
w
is approximately invariant
patient-like materials, 共S̄ / ␳兲m
throughout a photon radiation therapy field 共within 1%兲,
w
can be used as a post-processing step to conhence, 共S̄ / ␳兲m
vert Dm to Dw. However, this requires that a sufficient number of materials be specified so that the material-dependent
dose conversion approximates a continuous function.184
Rather than postprocessing the dose conversion, one can
multiply the energy deposited by primary and secondary
electrons on each electron energy-loss step by the factor
w
, the ratio of the restricted mass collision stopping
共L / ␳兲m
powers of water to local medium for the current energy of
the electron. This is done in the MC transport code, thereby
directly obtaining Dw. Alternatively, material interaction data
may be evaluated over continuously parameterized space
with cross sections and stopping powers for specific materials scaled relative to water.35,37 Figure 7 shows a parameterMedical Physics, Vol. 34, No. 12, December 2007

FIG. 7. Mass collision stopping power divided by the mass collision stopping power of water as a function of density normalized to water. A comparison of the fit function to the ICRU data 共Ref. 177兲 for body tissues for
electron energies of 5, 15, and 30 MeV is shown. The few points outside the
curve are materials like urinary stones, which are considered to have negligible effects. Reprinted from Kawrakow et al. 共Ref. 37兲 with permission.

ization of the mass collision stopping power as a function of
tissue density for different electron beam energies.37 The fit
is shown to be in good agreement with ICRU data177 for
body tissues. The advantage of this approach is that it circumvents the potential misassignment of media at material
boundaries37 which arises when the human tissue mass density range is divided into bins representing different tissues,
especially when the number of material bins is small.184
Until further studies indicate clinical justification for selecting Dm or Dw, it is the consensus of this task group that
MC dose results should: 共a兲 explicitly indicate the material to
which the dose is computed and 共b兲 allow conversion between Dm and Dw using one of the methods discussed above,
or other methods as developed in future investigations.
III.D.5. IMRT dose calculation and optimization
A strength of the MC method is its ability to accurately
compute dose for complex dose delivery scenarios such as
encountered in IMRT. IMRT often involves large intensity
gradients and is usually delivered using a sequence of small
static or dynamically shaped MLC segments. Under these
circumstances, the assumptions used in conventional algorithms regarding scatter equilibrium and output ratio variation with field size often break down.185 Additionally, in
IMRT a significant fraction of dose to structures of interest
共particularly dose limiting critical structures兲 is due to radiation scattered from or transmitted through the MLC.186 MC
simulation circumvents these limitations since it makes no
assumptions regarding radiation equilibrium and can transport particles through the detailed MLC leaf
geometry87,137,187 to include MLC leakage radiation, even for
dynamic MLC leaf sequences.138,188,189

4838

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

In using MC calculation in IMRT, a consideration is the
method used to incorporate the MLC into the dose calculation. Intensity modulation has been incorporated into MC
simulation using the conventional planning system’s intensity matrix,190 independently generated fluence modification
matrices,87,92,191,192 or direct transport through the MLC.61,189
Note that errors introduced by fluence approximations used
during the MC dose calculation will be propagated through
to the prediction of the patient’s dose. Thus, when a fluence
matrix approach is used for MC dose calculations, differences with respect to a conventional algorithm’s heterogeneity correction will be detected, but fluence prediction errors
may go undetected, particularly if the same fluence matrix is
used both for the conventional and MC calculations. However, when MC simulation is used to transport directly
through the detailed MLC geometry, these fluence errors
should be detected. Accounting for geometric details in the
MLC geometry, such as interleaf leakage is possible using a
fluence matrix approach, however, will require a very high
resolution calculation matrix, which may be a limiting factor.
Moreover, the energies of the scattered particles through the
MLC using such an approach will be approximate. Whether
or not modeling the intricate details of the MLC 共versus
more approximate fluence matrix approaches兲 will lead to
clinically significant differences in IMRT treatment planning
is not a fully resolved issue. More treatment planning studies
in this area of research are necessary to better understand the
associated clinical implications.
Application of the MC method for IMRT QA has been
demonstrated by several research groups61,87,139,190,192–194 using MC simulation to recompute dose distributions optimized with the conventional dose planning algorithm. When
using MC calculations as the reference plan and ignoring
statistical fluctuations, dose differences between conventional and MC algorithms can be considered systematic.195
Ma et al.191 found dose errors in excess of 5% and 20%
共relative to the prescribed dose兲 in targets and critical structures respectively due to patient heterogeneities, in comparing MC calculations 共employing an independent fluence matrix兲 with a pencil-beam model. In comparing MC
calculations with a conventional planning system’s 共pencilbeam model兲 intensity matrix for head and neck and lung
cases, Wang et al.190 found a 20% lower V95 共volume receiving at least 95% of the target dose兲 for a lung plan, and a 9%
lower D95 共dose delivered to at least 95% of the target volume兲 for a head and neck plan. Average agreement among all
head/neck and lung cases in this study, however, was quite
good.190 Regarding the transport of particles through the
MLC, Siebers and Mohan61 showed fluence-based IMRT
dose underestimates of 4.5% in V95 and heterogeneity-based
dose overestimates of 5% in V15 in the same treatment plan.
In intercomparing MC codes, Reynaert et al.196 reported deviations of up to 10% in DVHs between PEREGRINE and
BEAMnrc calculations. These discrepancies were attributed
to differences in modeling of the Elekta 共SLi-plus兲 MLC, not
caused by the particle transport in the patient. This study
further illustrates the importance of careful modeling of the
details of the MLC in IMRT treatment planning.
Medical Physics, Vol. 34, No. 12, December 2007

4838

MC-based IMRT plan optimization is limited by the clinical availability of MC calculation as a whole and the large
calculation time required to perform the multiple IMRT dose
calculations required for optimization. MC simulation during
optimization allows the optimizer to account for heterogeneity induced dose perturbations, as well as for MLC leakage
and scattered radiation. Inaccurate dose algorithms used during optimization can result in convergence errors195 in which
the optimized fluence pattern differs from that corresponding
to the optimal dose distribution.
Studies demonstrating the use of the MC method in IMRT
optimization include the work of Laub et al.,197 who utilized
a MC algorithm to evaluate the cost function during optimization but a pencil beam to compute the cost function derivatives used by the optimizer. Jeraj et al.,195 reported on convergence and systematic errors in the IMRT inverse planning
process 共for lung cancer兲 resulting from the use of
convolution/superposition and pencil beam algorithms, versus the Monte Carlo method. A similar study for treatment
planning of head and neck cancers was published by Dogan
et al.198 Another study by Siebers et al.199 demonstrated the
use of correction-based schemes to produce convergence of
doses computed by conventional algorithms with MC calculations. Bergman et al.200 reported on the use of an EGSnrcbased MC beamlet dose distribution matrix for IMRT planning using a direct aperture optimization algorithm. The goal
of their work was to assess the improvement in accuracy
over conventional algorithms in using MC methods for both
the final dose calculation as well as in the inverse planning
process.200 Combining these methods with statistical smoothing and denoising techniques,166–172 after comprehensive
benchmarking, may allow introduction of MC-based IMRT
optimization into routine clinical practice, particularly since
it has been shown that cost functions converge faster than
individual dose uncertainties.161 For a review of other studies, the reader is referred to the article by Verhaegen and
Seuntjens.25
III.D.6. Voxel size effects
As is the case with any dose calculation algorithm, calculated dose is affected by the size of the scoring voxel. For
MC calculations, typical values in the scoring dimension are
voxel sides of 2–5 mm for field sizes greater than 3
⫻ 3 cm2 and 1–2 mm for field sizes less than 3 ⫻ 3 cm2. For
calculations where geometric details of the MLC are included in the modeling, scoring voxel sizes no larger than
1–2 mm will be necessary to diminish volume averaging of
dose from inter- and intraleaf leakage. As with conventional
algorithms, MC-based IMRT calculations should be performed using voxel sizes of 2–3 mm or less in the high
gradient regions.201,202 In addition to affecting the spatial
resolution, the statistical uncertainty will be influenced by
the voxel size; reducing the voxel size will increase the relative uncertainty for a fixed number of source particles because fewer particles deposit dose in the smaller volume.
Increasing the voxel size 共and, hence, volume兲 will reduce
the relative uncertainty but may introduce errors due to re-

4839

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

duced spatial resolution. An example of the influence of
volume-averaging effects resulting from the use of larger
voxel sizes 共⬃0.5 cm on each side兲 in MC electron calculations is discussed in Sec. III E 3.5.
III.D.7. Cross sections
The uncertainties in photon interaction cross section data
in the energy range from 5 keV to a few MeV is of the order
of 1% − 2%.203 Although many MC codes use the incoherentscattering-factor approximation 共which assumes scattering of
photons from stationary, free electrons兲, this approximation
is found to be accurate in the mega-voltage energy regime,
where the energy of the incident photon is much higher than
that of the electron K-shell binding energy.204 An excellent
review of the cross sections for bremsstrahlung production
and electron-impact ionization has been provided by
Seltzer.205 It is shown that, in general, calculated cross sections for the various electron interaction processes are in
agreement with measurements within the combined experimental and theoretical uncertainties.205 It is felt that cross
section and electron data in the megavoltage energy range
are sufficiently accurate,206 assuming that sampling of these
cross sections is done accurately within a given code. These
same effects will be present in doses computed with the
convolution/superposition algorithm.

4839

rithms, such as the convolution and MC methods, can be
used to produce more accurate results. More recently, Arnfield et al.213 found large differences 共up to 10%兲 between
collapsed cone convolution and MC 共PEREGRINE兲 calculations in an 8 cm lung-equivalent slab embedded within solid
water and irradiated by a 4 ⫻ 4 cm2, 18 MV photon beam.
Their work included film and ion chamber detectors and
showed that MC calculations were in good agreement with
measurements.213
With respect to patient planning, studies91,115,214–219 have
pointed out major differences between MC calculation and
conventional methods, such as the 3D pencil beam and
convolution/superposition algorithms. Over the past ten
years, there has been a growing interest in the use of the MC
method in clinical treatment applications with many institutions around the world actively involved in the development
and testing of such systems. Many experiments in homogeneous
and
heterogeneous
phantoms26,27,71,75,82,84,86,93,96,115,119,194,213,220–225 have been
directed toward verification of MC algorithms for clinical
planning applications. The interested reader is referred to
these and other related publications for a comprehensive review of the various types of experimental testing of MC
treatment planning algorithms.
III.E.3. Types of verification experiments

III.E. Experimental verification

III.E.1. Introduction
In this report experimental verification of the MC algorithm deals with how accurately the algorithm performs under different test conditions within a phantom. As with any
algorithm, verification and testing is a necessary step to ensure safety of use in the clinical setting. It is the consensus of
this task group that verification of a MC algorithm should be
similar to that of any model-based dose calculation algorithm, such as convolution/superposition. The clinical commissioning and acceptance testing of dose calculation algorithms has been reported.48–50 Additional testing to confirm
the accuracy of the MC algorithm in situations of electronic
disequilibrium will be helpful. Quantification of benchmark
cases 共such as the ICCR benchmark99兲 should be performed
by either the user, or the vendor. The intent of this section is
to provide some examples of additional types of testing that
may be included to assure the accuracy of the MC algorithm.
The specification of required measurements for acceptance
testing and commissioning of the MC algorithm and the criteria for algorithmic agreement with measurements is beyond
the scope of this report.
III.E.2. Previous work
Toward the goal of verification of dose calculation algorithms, there have been a variety of studies related to measurements in heterogeneous media. These investigations 共see,
for example, Refs. 207–212兲 have usually focused on establishing limitations of conventional dose algorithms in heterogeneous media and on how the use of physics-based algoMedical Physics, Vol. 34, No. 12, December 2007

Experimental verification of a MC algorithm should include testing to assess the accuracy of: 共a兲 the beam model
共be it measurement-driven or based on treatment head simulation兲 and 共b兲 the radiation transport algorithm in homogeneous and heterogeneous phantoms. The former is part of
routine commissioning of dose calculation algorithms,
whereas the latter is likely to have significantly more involvement from developers and vendors.
III.E.3.a. The beam model. The purpose of verification
of the beam 共treatment head兲 model is to ensure that parameters, such as the incident beam energy 共if used兲 are correctly
“tuned” to produce dose distributions in agreement with
measurement. Such verification is the same as that for any
dose algorithm and may best be performed with measurements in a homogeneous 共water兲 phantom. These tests
should include the acquisition of depth and profile doses in a
water phantom for a range of field sizes, as is routinely performed for conventional algorithmic verification, and documented in the AAPM TG-53 report.48–50 In addition, the use
of measured in-air off axis ratios may be useful for benchmarking the beam model. Calculated in-air off-axis ratios
have been shown to be very sensitive to the incident electron
beam parameters 共e.g., mean energy, intensity distribution,
etc.兲, as well as the dimensions and densities of other structures, such as the primary collimator and flattening filter.102
The multileaf collimator (MLC). Experiments to benchmark the MLC transport have ranged from arbitrarily shaped
AP fields designed to verify overall penumbral and transmission dose88 to more complicated MLC shapes designed to
test modeling of detailed effects, such as transport through
tongue-and-groove
the
rounded
leaf
ends,83,87,226

4840

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

effect,27,72,83,87,137 and intra/interleaf transmission.27,72,83,87,137
The complexity of MLC verification experiments will depend on the usage of the MC algorithm in the clinical setting.
For the purposes of 3D conformal radiotherapy 共3D-CRT兲,
the shaped field cases provided in Fig. A3–1 of the AAPM
TG-53 共Ref. 48兲 report are good examples of tests designed
to test overall MLC transmission and penumbral effects. In
the context of 3D-CRT planning, the accurate modeling of
details of the MLC and the influence of these effects on leaf
transmission and penumbra may be of reduced clinical importance to the target doses 共for an appropriate CTV-to-PTV
margin兲 as these issues affect the dose at the field edges and
outside the field.227 For IMRT, it is now well established that
the accurate modeling of MLC transmission and penumbra is
critical.61,227 A stringent test of the ability of the MLC model
to accurately handle intra/interleaf transmission is presented
in Fig. 8共a兲, for a Varian, Millenium 120-leaf MLC. In this
example, the calculated MLC leakage radiation is compared
with film measurements in a direction perpendicular to the
leaf motion.83 Figure 8共b兲 shows a comparison between MC
calculations and film measurements for a MLC “picket
fence” shape where the field is blocked by even numbered
MLC leaves with odd numbered leaves retracted behind the
jaws.83 This test is useful in evaluating how accurately the
tongue-and-groove effect is handled.
In designing a test suite for verification of the MLC transport accuracy, the clinical physicist should give special consideration to the detailed specifications of the MLC, particularly if the MC model is to be used for IMRT planning.
These details include: density and composition of the MLC
leaves, rounded leaf-end dimensions, intra/interleaf gaps, and
tongue-and-groove dimensions. Discrepancies between MC
calculations and measurements deemed significant by the
physicist should be reported to the vendor; modification of
the relevant parameters influencing the model accuracy, such
as the MLC geometric model should be performed by the
vendor to establish acceptable agreement between calculations and measurements.
Other beam modifying devices. The accuracy of MC
simulation of beam modifying devices, such as wedges and
blocks may be benchmarked using methods similar to that
for conventional algorithms.48 A publication on the experimental verification of the PEREGRINE MC system27 included
the acquisition of large wedged field profiles 共40⫻ 20 cm2兲
at various depths 共see Fig. 13 of Hartmann-Siantar et al.27兲.
The purpose of large field testing is to ensure that radiation
transport through the wedge 共or other beam modifying device兲 is in acceptable agreement with measurements across
the entire physical range of the device. Unacceptable differences between calculations and measurements should be reported to the vendor—appropriate action should be taken by
the vendor to help resolve these differences.
III.E.4. Verification of the Monte Carlo transport
algorithm in phantom
Given the improvement in the accuracy of MC simulation
over conventional algorithms, particularly under circumMedical Physics, Vol. 34, No. 12, December 2007

4840

FIG. 8. 共a兲 Measured 共solid line兲 and calculated 共dashed line兲 MLC leakage
radiation perpendicular to the direction of MLC leaf motion for a 10
⫻ 10 cm2 MLC-blocked field for 6 and 18 MV beams. Dose calculation and
measurement for the 6 MV beams occurred at 5 cm depth, 95 cm SSD, and
the 18 MV data at 10 cm depth, 90 cm SSD. One should note that the dose
due to leakage radiation 共under the closed leafs兲 typically accounts for 2%
− 3% of the open field dose. The discrepancy noted for the 18 MV comparison is roughly 0.1% of the open field dose and is most likely to a small
difference in the MLC density used in the calculations 共Ref. 83兲. Reprinted
from Siebers et al. 共Ref. 83兲 with permission. 共b兲 Measured 共solid line兲 and
calculated 共dashed line兲 doses for 6 and 18 MV 10⫻ 10 cm2 field 共a兲
blocked by even numbered MLC leaves with odd numbered MLC leaves
retracted behind the jaws. One should note that the dose due to leakage
radiation 共under the closed leafs兲 typically accounts for 2% − 3% of the open
field dose. Reprinted from Siebers et al. 共Ref. 83兲 with permission.

stances of electronic disequilibrium, verification of the MC
algorithm should include testing under these types of conditions to confirm the expected accuracy. Although reports,
such as the AAPM TG-53 共Ref. 48兲 and others,49,50 recommend testing in heterogeneous phantoms, issues related to
electronic disequilibrium are generally excluded. This task
group strongly encourages that verification testing of the MC
algorithm include experiments emphasizing electronic disequilibrium effects, in addition to standard tests in heteroge-

4841

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

FIG. 9. Measured percent depth ionization and Monte Carlo calculated percent depth dose in the dose buildup region in water with the IC-10 cylindrical ionization chamber and the Roos parallel-plate ionization chamber in
water for a 10⫻ 10 cm2 field and SSD of 100 cm, for an 18 MV x-ray
beam. For the IC-10 ion chamber, the effective point of measurement was
1.8 mm upstream from the chamber center. Reprinted from Abdel-Rahman
et al. 共Ref. 152兲 with permission.

neous phantoms as documented in other reports.48–50 This
type of testing is needed to exploit the advantages of MCbased simulation to its full potential.
Verification measurements in slab phantoms with embedded low density inserts and irradiated by high energy photons are useful in assessing the transport accuracy under conditions of electronic disequilibrium.84,213,220 Effects of
penumbral broadening of the dose distribution resulting from
lateral electron transport may be evaluated using such
phantoms.84,213,220
Dose measurements at various locations 共depths and offaxis distances兲 both within and outside a high-density heterogeneity provide a benchmark to evaluate the perturbation of
the photon and electron fluence due to the presence of the
heterogeneity.225 Dosimetric effects at interfaces 共e.g., due to
backscattering at bone/tissue interfaces53,225兲, transport
within the heterogeneity, and the doses outside the heterogeneity may all be assessed with careful positioning of measurement devices within the heterogeneous phantom.
Experimental verification should also be performed in
more clinically relevant situations. Examples of such geometries include thorax phantoms,228 and mediastinal229 and
tumor-like phantoms.229,230
Verification experiments for algorithmic verification have
also included the use of anthropomorphic 共Rando兲 phantoms,
where TLDs are most often used for the measurements.225,231
With anthropomorphic phantoms, calculated patient treatment plans may be verified under a range of clinical circumstances. However, measurements must be carried out carefully with appropriate experimental techniques, theoretical
interpretation, and reproducibility.
III.E.5. Dose buildup region
It is challenging to make accurate measurements in the
dose buildup region. A recent study by Abdel-Rahman et
al.152 showed significant differences 共see Fig. 9兲 in the dose
buildup region 共⬍1 cm兲 between the response of a parallel
Medical Physics, Vol. 34, No. 12, December 2007

4841

plate 共Roos兲 and cylindrical ion chambers 共IC-10, Scanditronix兲 in both 6 and 18 MV photon beams. Similar differences were found between a cylindrical ion chamber and a
parallel plate chamber 共P11兲 and a stereotactic diode 共Scanditronix兲 by Yokoyama et al.232 who measured dose buildup
regions for IMRT fields. Based on the available literature, it
is therefore recommended that dose buildups be carefully
measured with either a parallel plate chamber, an extrapolation chamber, or with methods such as TLD extrapolation.233
Diode detectors may also be considered for dose buildup
measurements234 but should be cross referenced with other
detectors, such as parallel plate ion chambers. As pointed out
by Kawrakow155 共see Sec. III C 4兲, the relationship between
the measured ionization and dose is sensitive to details of the
ion chamber design and needs to be accounted for in dose
buildup measurements.
III.E.6. Output ratios
MC calculations of output should be performed in a
measurement-like geometry, usually consisting of a central
axis point dose estimate at a fixed depth 共dmax, 10 cm or
other兲 in a water phantom for square field sizes defined by
the collimating jaws. If the backscattered radiation into the
monitor chamber is correctly modeled, it is possible to calculate output ratios to within 1% − 2% agreement with measurements over a range of square field sizes, with sides from
3 to 40 cm.146 In addition, comprehensive verification of output ratios should include testing for small segmental fields
located off-axis, which are commonly used in IMRT planning. Output ratios should be verified against measurements
of specially designed IMRT fields, such as junction narrow
slit fields, in which the effects of small field dosimetry are
magnified. Examples of such fields have been
reported.83,87,145,187
III.E.7. Electron beams
Careful experimental verification is especially necessary
for electrons because the tolerance of parameters, such as the
electron energy and the treatment head structure constituents
are much tighter than for photons. Accurate measurements
are a prerequisite to accurate simulation. Care must be taken
in measurement of the central axis depth-dose curve used to
define the beam energy. Profiles in large fields need to be
included to determine geometry details such as the distance
between the scattering foils, the thickness of these foils, and
the lateral position of shaped scattering foils, if present. Measurement of dose profiles in the bremsstrahlung tail are helpful to validate the photon component of the beam model.112
Comparison to measured output ratios and dose distributions
over the full clinical range of field sizes and SSDs is necessary for each applicator and beam energy, to rigorously validate the dose calculation. Further measurements, such as
dose measured in an anthropomorphic phantom,221 should be
performed to validate the beam model for the specific MCbased application.
Comprehensive verification for electron beam MC simulation should include measurements in heterogeneous phan-

4842

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

FIG. 10. Trachea and spine phantom: measured and Monte Carlo 共Masterplan, Nucletron, based on VMC++兲 calculated crossplane dose profiles at
various depths for: 共a兲 9 and 共b兲 20 MeV. SSD= 100 cm, 10⫻ 10 cm2 applicator.
Monte
Carlo
simulations
were
performed
with
50 000 histories/ cm2 and a voxel size of 0.49 cm. 100 MU were used for
the calculations. The relative uncertainty in the calculations is about 1%
− 1.5%. The phantom geometry is shown in the inset. Differences between
measurements and calculations in this example were attributed to the volume averaging effects of a large voxel size 共⬃0.5 cm兲 共Ref. 26兲. Reprinted
from Cygler et al. 共Ref. 26兲 with permission.

toms, such as those reported in the Electron Collaborative
Working Group report235 and its update.236 Cygler et al.26
performed experimental benchmarks using a variety of heterogeneous phantoms, including a 1D slab geometry with an
aluminum slab insert, a 2D geometry with cortical boneequivalent inserts 共“ribs” geometry兲, a 3D cylindrical geometry with an “air” insert, and a complex trachea and spine
equivalent geometry. Figure 10 shows the example trachea
and spine phantom used in their study.26 Differences between
measurements and calculations in this example were shown
to be due to the volume averaging effects of a large voxel
size 共⬃0.5 cm兲.26 The MC calculations are found to underestimate the measurements because the large voxel size averages the density distribution in the vicinity of the heterogeneity, effectively reducing the calculated dose across the
low-density heterogeneity.26
Careful measurements in such heterogeneous phantoms
will provide rigorous benchmark data for verification of the
MC algorithm, and as such should be strongly considered for
testing purposes.
III.E.8. Measurement uncertainties
Making dose measurements is fraught with problems if
the aim is to verify calculations at the 2% or better level,
Medical Physics, Vol. 34, No. 12, December 2007

4842

particularly in nonuniform dose regions. It is important to
take into account point of measurement effects, variations in
stopping power ratios for ion chambers, and beam quality
dependence in general for other detectors 共e.g., the well
known over-response of film in regions of low mean photon
energy兲, polarity effects, ion recombination effects, and
chamber perturbation effects. Specific detectors may be required for accurate measurements under specific conditions;
for example, properly constructed parallel plate chambers
may be favored over ion chambers for measurements in the
dose buildup region or at material interfaces. Uncertainties
due to improper detector positioning must also be quantified
as these measurements are often performed in regions of
high dose gradients.
When using modern IMRT techniques there can be strong
perturbation effects or corrections needed with ion chamber
and other detector measurements. However, as with other
algorithms, detector perturbations are generally not accounted for in verification of MC-based treatment planning
algorithms. MC methods may be used to model the physical
details of the detectors to provide a better understanding of
measurements performed under nonequilibrium conditions.
These approaches are available to developers of MC techniques but further advancement and investigation of this
technology is necessary before specific recommendations
can be made. Measurements form the basis for benchmarking the accuracy of dose calculation algorithms in clinical
radiotherapy. It is therefore important that the uncertainties
in the measuring techniques be accounted for.
III.E.9. Example experimental tests
Example tests for verification of MC dose algorithms are
provided in Table IV. These tests, intended as a supplement
to those provided in the AAPM TG 53 report,48 aim to evaluate the various components of the MC algorithm.
III.E.10. Timing issues
The issue of calculation time is of considerable importance in the clinical treatment planning process. To provide a
perspective on this subject, users of commercial MC dose
algorithms were asked to submit calculation times for photon
and electron treatment plans. The treatment plans ranged in
complexity from simple AP beams to dynamically delivered
IMRT plans. These results are summarized in Table V. As
noted in Table V, photon beam calculations with PEREGRINE
are approximately a factor of 2–3 times slower than those for
conventional planning systems. However, these times will be
reduced using faster, currently available processors 共
⬎2 GHz versus 800 MHz兲. Electron beam calculations with
VMC++ 共Nucletron兲 are roughly equivalent in processing
times to conventional systems. The timing comparisons provide good justification of the fact that significant processing
times are no longer a concern for routine clinical MC dose
calculation. MC calculations for a plan with one beam take
the same time as that for a plan with multiple beams 共of
approximately the same field size兲, for the same statistical
uncertainty to the PTV. This is because the statistical uncer-

4843

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

4843

TABLE IV. Partial listing of example specific tests, phantom designs, and detector measurements for Monte Carlo treatment planning systems. These tests are
intended as a supplement to those detailed in the AAPM TG-53 共Ref. 48兲 and other related publications 共Refs. 49 and 50兲 for algorithmic verification. Note
that extreme care should be taken when performing many of these measurements as they are, in some instances, highly sensitive to the measurement setup
conditions.
Test description
• Water depth doses and profiles—emphasis on
large open field sizes, 共⬎30⫻ 30 cm2兲
• 2D planar dose perpendicular to the beam cax
for large open fields
• 2D planar dose perpendicular to the beam cax
of large MLC-shaped fields 共see Fig. A3–1 of
the AAPM TG 53 report兲a
• Dose profiles under the closed MLC leaves,
perpendicular to the direction of motion 共see Fig. 7兲.b

Reason

Phantom design

To evaluate the beam
model accuracy—test is sensitive to
structures like the flattening filter
and other parameters, such as the
electron-on-target energy.
To evaluate the accuracy of the MLC
model, leaf-tip penumbra
and leaf transmission.

• Depth doses and profiles at
multiple depths measured in
a water phantom using a cylindrical
ion chamber.• 2D planar dose at multiple depths
in solid water using film.
• 2D planar dose at multiple depths
in solid water using film.
• Dose profiles under closed MLC leaves
measured with film or small volume
detector 共diode, TLD, pinpoint chamber,
diamond detector兲.
• Depth doses in a layered phantom
共see Fig. 8 and Fig. 1 of Rice et al.兲c
consisting of solid water and low density
material 共lung equivalent or cork兲
measured with small volume detector
共diode, TLD, pinpoint chamber, diamond
detector, at multiple point depths兲 or with film.
Beam is directed perpendicularly to the slabs.
• 2D penumbral measurements with film in planes
perpendicular to the beam cax at depths above, below,
and within the low density slab in the layered phantom.
Beam should also be directed parallel to the slabs to
evaluate interface effects.d
• Depth doses in a layered phantom consisting of solid
water and high density material 共cortical bone
equivalent兲 measured with small volume detector 共diode,
TLD, pinpoint chamber, diamond detector兲 for smaller
field sizes, or with film.
See, for example, Fig. 1 of Ref. 230. Dose measured
with film or with small volume detector, where possible,
at incremental depths, for example, 0.2, 0.5, 1.0, 2.0, and
5.0 cm anterior/posterior to the medial and proximal
tissue/lung equivalent and tissue/bone-equivalent
interfaces.
• Dose measured with small
volume detectors within
inserts of different materials,
ranging from air to cortical
bone-equivalent. Plans designed should
include simple, intermediate, complex static and IMRT
beam arrangements. Anthropomorphic phantoms should
be CT-imaged for planning purposes.

• Small field 共1 ⫻ 1 cm2 − 4 ⫻ 4 cm2兲 depth doses
in low density media; larger field sizes should
also be tested.
• Penumbral broadening; lateral dose spreading
in lung assessed over a range of field sizes
共2 ⫻ 2 − 30⫻ 30 cm2兲.

To evaluate the transport
algorithm accuracy—use of
high energies 共⬎10 MV兲
and low density media emphasizes
electronic disequilibrium effects.

• Depth doses in high density media over a range
of field sizes, 3 ⫻ 3 − 30⫻ 30 cm2.

To evaluate the transport algorithm
accuracy in high density media, such
as cortical-bone equivalent slabs.

• Point doses in the vicinity of tissue interfaces 共tissue/
lung and tissue/bone兲, over a range of field sizes, 3 ⫻ 3
− 30⫻ 30 cm2.

To evaluate the algorithmic
accuracy in
the perturbed dose field at tissue
interfaces.

• Dose evaluation in clinical treatment planning, for
To assess the accuracy of dose
simple, intermediate and complex static treatment plans calculation to points located within
as well as IMRT plans, in anthropomorphic phantoms. structures of different
densities and receiving different
doses based on the treatment plan.

a

See Ref. 48.
See Ref. 83.
c
See Ref. 229.
d
See Ref. 222.
b

tainty is determined by the number of particles passing
through a volume, and this number can be held constant
when performing a MC plan with multiple beams. This is a
distinct advantage over conventional algorithms where computational time scales linearly with the number of beams.
IV. CLINICAL IMPLICATIONS OF MONTE
CARLO-CALCULATED DOSE DISTRIBUTIONS
IV.A. Introduction

In spite of our confidence in the improved dose calculation accuracy with a suitably commissioned clinical MC alMedical Physics, Vol. 34, No. 12, December 2007

gorithm, we are confronted with the following clinical question: What is the effect of more accurate MC dose
distributions on patient clinical outcome? To answer this
question, we will need to investigate the correlation of MC
calculated dose distributions with clinical outcome 共in terms
of tumor control and normal tissue toxicity兲.
To date the evidence directly correlating the improved
accuracy of MC-calculated dose distributions with clinical
outcome is scant. Investigations by De Jaeger et al.,237
共which included convolution but not MC calculations兲,
Chetty et al.,238 and Lindsay et al.239 are among the first

4844

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

4844

TABLE V. Summary of timing results for clinical treatment plans from currently available commercial Monte Carlo systems. Data for photon beams were
provided by author G.E., performed using the PEREGRINE 共Nomos division, North American Scientific兲 system and those for electrons by author J.E.C.,
conducted with Nucletron. The 共1␴兲 relative statistical uncertainty was approximately 2% in the maximum dose voxel for the Nomos calculations and roughly
1% − 1.5% 共in the average depth dose along the central axis兲 for the Nucletron electron beam calculations. Eclipse calculations were reported with an
uncertainty of 1% − 2% in the mean dose of all voxels receiving more than 50% of the maximum dose within the body of the contour. Readers should be
cautioned that the timing results are subject to large uncertainties due to differences in compilers, memory size, cache size, etc.
Monte Carlo code/configuration

Description of treatment plan

Time estimate
共min兲

PEREGRINE 共Nomos, North American Scientific兲 16

AP beam, 6 MV photons, 10⫻ 10 cm2 in a water
48
phantom, cubic voxels with 2 mm sides
89
5 field, 6 MV CRT prostate plan, ⬃7 ⫻ 11 cm2, cubic
voxels with ⬃2.4 mm sides
71
5 field, 6 MV prostate plan with modulation delivered
with DMLC 共exposed field ⬃4 ⫻ 8 cm2兲, cubic voxels
with ⬃2.4 mm sides
4.2
Masterplan 共VMC++, Nucletron兲, single CPU Pentium IV AP beam, 6 MeV electrons, 10⫻ 10 cm applicator,
XEON, 2.2 GHz
water phantom, cubic voxels with 4.9 mm sides
AP beam, 17 MeV electrons, 10⫻ 10 cm applicator,
8.2
water phantom, cubic voxels with 4.9 mm sides
AP beam, 20 MeV electrons, 15⫻ 15 cm applicator,
21
water phantom, cubic voxels with 3.9 mm sides
Breast boost treatment plan: 2 fields, 11 MeV electrons,
8.6 共both fields兲
⬃3 ⫻ 3 cm cutouts, cubic voxels with 5.4 mm sides
eMC 共MMC, Eclipse, Varian兲 single CPU Pentium IV
AP beam, 6, 12, 18 MeV electrons, 10⫻ 10 cm
⬃3, 4, 4 共6, 12, 18 MeV, respectively兲
XEON, 2.4 GHz
applicator, water phantom, cubic voxels with 5.0 mm
sides
processors 共8-dual兲, Pentium III, 800 MHz

studies evaluating the influence of improved dose distributions on outcome observed in patients treated with lung cancer. The study by De Jaeger et al.,237 in which lung cancer
treatment plans were retrospectively recalculated using a
convolution/superposition 共CS兲-based algorithm 共initially
calculated with an equivalent-path-length 共EPL兲 algorithm兲,
showed clinically significant differences between calculated
and observed incidences of radiation pneumonitis. They
demonstrated that the calculated incidence of radiation pneumonitis correlated better with observed incidence when using
dose distributions calculated with CS rather than EPL
algorithms.237 Although this study was carried out using a CS
algorithm, it provides strong support that the dose-response
relationships determined with correction-based algorithms
will be different than those computed with model-based
methods.237 With the sometimes large differences observed
between the doses calculated with CS and MC algorithms,240
the MC method is likely to add a higher degree of accuracy
to the dose-effect relationships, and will be instrumental in
putting these relationships on a more solid footing.
There is clearly a need for more studies addressing the
clinical impact of MC-calculated dose distributions. The use
of retrospective data may provide a useful means to perform
such studies. Retrospective dose assessments of already existing local tumor control and normal tissue complications,
using doses recalculated with MC algorithms, may give an
early indication of the clinical utility of the MC method, and
may also help physicians determine how to use the new MCcalculated doses.206 Retrospective analyses should eventually
show us how to make use of this information in a prospective
way.206
Medical Physics, Vol. 34, No. 12, December 2007

IV.B. Clinical examples

In reviewing the literature on clinical treatment planning,
one should keep in mind that the dose differences found
between MC-based and conventional algorithms will be
highly dependent on the beam arrangements, field sizes,
beam energies, tumor size, and location. This is particularly
true in anatomical sites where the target is situated near tissues with widely varying densities, such as the lung and
head/neck. For example, due to electron transport issues, differences found in a lung CRT treatment plan using small
field sizes and 15 MV photons may be much larger than
those found with a standard AP/PA lung plan, using large
field sizes and 6 MV photon beams. The reader should therefore be advised that, although there is a general consensus on
the importance of the MC method in sites such as the lung,
the dosimetry in many of the reported studies is based on
specific conditions. The following literature review will focus on treatment planning in the lung and head and neck
since differences between MC-based and conventional algorithms are likely to be smaller in other external beam treatment sites. This does not include the potential for improvement in dose estimates in any site from accurate simulation
of beam modifiers, in particular, the MLC for delivering
IMRT. More studies using MC-based dose calculation techniques in clinical treatment planning are warranted to better
quantify the dosimetric and clinical benefits of these algorithms.

4845

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

FIG. 11. Opposed, oblique field treatment plan 共15 MV photons兲 showing
the 100% isodose coverage for MC 共modified DPM, University of Michigan/
UMPlan兲 in the solid line, and an equivalent path length 共EPL, University of
Michigan/UMPlan兲 algorithm in the dashed line. The PTV is demarcated in
white.

An excellent review of MC-based dose calculation methods in clinical planning for various treatment sites, including
the breast and prostate is provided in the article by Reynaert
et al.241
IV.B.1. Photon beam treatment planning
IV.B.1.a. Lung Perhaps the strongest motivation for the
need for MC dose calculation comes from treatment planning for lung cancer. This is because electron transport issues, not accounted for accurately with conventional algorithms, are exacerbated in the low density tissues. A
consequence of electronic disequilibrium in the lung is the
underdosage of the PTV, as shown in Fig. 11. The penumbral
widening in the dose distribution as a result of the increased
electron scattering in the lung is illustrated for a conformal
lung plan in Fig. 12. Depending on the location and size of
the tumor, and the beam energy, underdosage of the PTV in
lung planning may be significant. In addition to the target
coverage, dose to normal tissues, particularly the normal
lung, may be equally affected. Numerous lung planning studies have shown sometimes substantial differences 共10%
− 20%兲
between
conventional
and
MC
algorithms.117,190,192,214,216,242–246

FIG. 12. Isodose distributions for a 3D conformal lung plan 共15 MV photons兲 calculated using an equivalent path length 共EPL, University of
Michigan/UMPlan兲 algorithm on the left and a MC calculation 共modified
DPM, UMPlan兲 on the right. A distinct penumbral broadening in the MCbased dose distribution 共on the right兲 is observed due to the increased electron scattering in the lung tissue. This effect is not as pronounced in the
EPL-calculated dose distribution.
Medical Physics, Vol. 34, No. 12, December 2007

4845

Due to the complicated dosimetric issues associated with
treatment planning in the lung, more studies and comparisons using the MC method are encouraged. The utilization of
advanced techniques, such as extracranial stereotactic radiotherapy using 10–24 Gy fractions,247 for the treatment of
early stage lung cancer, may increase the importance of accurate dosimetry and the clinical importance of MC calculated doses. One of the important next steps must be to
evaluate how the improved MC dose distributions will clinically impact outcome for tumors and normal tissues.
IV.B.1.b. Head and neck There have been numerous
studies on MC head and neck CRT and IMRT
planning.190,192,193,214,248–250 These studies have shown in
general that dose differences between convolution and MC
algorithms are dosimetrically insignificant. However, it has
also been shown that dose differences for tumors located in
the presence of air cavities can be significant due to inaccurate calculation of the photon/electron energy fluence inside
and around air cavities using Batho and ETAR methods214 as
well as a collapsed cone convolution algorithm.250,251
IV.B.1.c. Other treatment sites Readers are encouraged
to review articles published on MC-based treatment planning
in other anatomical sites, which include: brain,89,91,219,252–254
breast,216,255 and prostate.193,214,216,256,257
IV.B.2. Electron beam treatment planning
There have been numerous studies on the use of MC calculations
in
electron
beam
treatment
planning.26,111,115,121,258–262 In some instances, significant differences between pencil beam dose distributions and MC calculations have been demonstrated, particularly in regions in
or near air cavities and lung or bone tissues.115,263 Large
differences have also been observed for small irregular
fields, beams with oblique incidence, and for extended SSD
treatments.115,263 The use of the MC method represents a
significant improvement in accuracy for electron beam dose
calculation compared with conventional algorithms. Electron
MC calculations require far fewer primary histories to
achieve a given uncertainty on the dose being calculated because electrons deposit their energy in a more continuous
manner, in a smaller volume and mostly starting from the
same location 共the patient surface兲. This timing advantage
has allowed the development of commercial electron beam
MC algorithms which are time efficient 共taking on the order
of minutes per plan兲 even on a single processor.26
From phantom and routine patient planning calculations
based on experience with a commercial electron beam MC
algorithm 共VMC++, currently Nucletron兲, Cygler et al.26 have
reported that MC-generated monitor unit 共MU兲 values may
differ from the homogeneous 共water phantom兲 values by as
much as 10%, depending on surface irregularities and inhomogeneities present in the irradiated volume. This situation
is frequently encountered for head and neck sites, especially
in the region of the nasal cavities. In such cases, surface
irregularities and missing tissue lateral to the air cavity necessitate larger MUs to deliver the same prescribed dose versus flat surface anatomies. As is the case with photon beams,

4846

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

it is important that the statistical uncertainties in the single
voxel MU calculations be reported.
IV.C. Association of Monte Carlo calculated dose
distributions with clinical outcome

As with other changes to the therapy treatment process,
with the implementation of a new dose calculation algorithm
such as the MC method, users should correlate doses and
prescriptions with respect to previous clinical experience.
Chetty et al.238 studied dose-effect relationships 共for tumor and normal tissues兲 by recalculating dose distributions
retrospectively using the MC method for patients treated on a
nonsmall cell lung cancer 共NSCLC兲 dose escalation
protocol264—original plans were generated using an EPL algorithm. Follow-up data was evaluated from CT scans taken
six months to two years postradiation therapy. Follow-up CT
scans were fused with initial treatment planning scans and
the original and replanned dose distributions were mapped
onto the anatomy to establish associations between dose and
regions of local recurrence and normal lung damage
共radiation-induced pneumonitis兲.238 Preliminary results of
this study showed that the originally planned PTVs are
sometimes significantly underdosed with MC calculations
compared with the EPL algorithm.238 For normal lung tissue,
the correlation of dose with normal tissue complications was
also found to differ, but also showed that beam model differences 共not related to the dose calculation algorithm in the
patient兲 are important and must be considered for an unbiased comparison of dose calculated by different
algorithms.136,238,241,265
Lindsay et al.239 performed retrospective MC-based recalculations of a large group of lung cancer treatment plans and
showed significant differences in dose indices 共V20, maximum lung dose and mean GTV dose兲 between plans without
heterogeneity correction and MC calculations. Moreover,
correlations between V20 and observed radiation pneumonitis in this study were found to be different between plans
without heterogeneity correction and MC-based treatment
plans.239
Despite the preliminary 共and somewhat anecdotal兲 nature
of the evidence thus far, observations suggest that more accurate dose calculations will reveal inadequate target coverage or hot spots in certain areas of organs at risk that could
lead to differences in outcome. Complete MC recalculations
of delivered dose distributions that include the effects of
other factors, such as organ motion and patient setup errors,
will be required to refine these correlation studies. In addition, it should be noted that the efficacy of radiation therapy
is also dependent upon individual patient response.
The clinical evidence thus far, albeit preliminary and retrospective, provides support that dose delivery based on MC
treatment plans, particularly for lung cancer, have the potential to result in clinically significant changes. Kong et al.266
have shown that dose significantly impacts local control and
overall survival for NSCLC; local control was found to increase at a rate of 1.3% per gray above the conventional dose
fractionation scheme 共63–69 Gy in 2.0 Gy fractions兲. This
Medical Physics, Vol. 34, No. 12, December 2007

4846

suggests that even small differences in dose distributions, as
a result of inaccurate dose calculation, are likely to affect
local control and survival for patients with NSCLC. Further
studies of MC dose distributions in the lung and in other
sites, such as the head/neck, are necessary and are encouraged in order to unequivocally evaluate the clinical utility of
MC-calculated doses.
V. SUMMARY
We wish to reiterate that, from a clinical implementation
standpoint, the MC method should be treated as would any
conventional dose algorithm. Proper implementation will require the clinical physicist to understand, on some level, the
fundamentals of the algorithm as well as the possible pitfalls
associated with its clinical implementation, much as one
would for any dose algorithm. In addition to providing an
educational review of the MC dose calculation method, we
have identified issues that will need to be considered by developers, vendors, and end users of MC-based techniques,
ultimately to ensure that patient dose calculations are effected safely.
In conclusion, we present a summary of some of the issues which are important in the implementation and clinical
use of MC dose calculation algorithms. The recommendations summarized here are not meant to be prescriptive;
rather they are intended as a preliminary guide for medical
physicists to ensure thoughtful and safe implementation of
clinical MC algorithms. We anticipate that many of the areas
of concern will be studied in further detail in future, more
specific task group reports.
V.A. Treatment head simulation

共a兲

共b兲

Vendors of MC-based dose calculation systems should
be responsible for providing the necessary guidance
and assistance with the beam modeling and benchmarking process. Such guidance includes the tuning of
parameters such as the electron energy, or the adjustment of model parameters 共in measurement-driven
models兲 to ensure that the beam model meets the required specifications.
In reporting statistical uncertainties in the calculated
patient dose, vendors should properly account for latent
variance in the beam model if the model is based on
treatment head simulation. Further, if the latent variance is a significant contributor to the total variance the
number of phase-space particles in the beam simulation
should be increased.

V.B. Patient simulation

V.B.1. Statistical uncertainties
We recommend that quantities, such as FD⬎0.5Dmax, or
FPTV, or FPRV for doses to the specific volumes, PTV or PRV
respectively, be adopted as a standard method of reporting
fractional statistical uncertainties in dose averaged over the
relevant volume. The sole use of dose uncertainties to indi-

4847

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

vidual voxels, such as the maximum dose voxel, Dmax,
should be avoided. Additionally, reporting of single voxel
doses or doses over patient subvolumes should be accompanied by their respective statistical uncertainties. In situations
where doses in individual voxels are important, such as Dmax
to a serial organ like the spinal cord, it may be necessary to
simulate a large enough number of histories so that sDmax is
very small. This will ensure that the absolute uncertainty in
Dmax will also be small. The required statistical precision
required for individual voxel dose estimates should be decided upon with guidance from the clinical team.
V.B.2. Variance reduction techniques, efficiency
enhancing methods, and other parameters
Users should understand the influence on the dose accuracy of variance reduction implementations and approximate
methods used to improve the calculation efficiency, as well
as any other accessible parameters of importance to the MC
dose algorithm. Appropriate documentation on the methods
used and their influence should be made available to the user.
More studies on the influence of efficiency enhancing methods in clinical treatment planning are warranted, as it is
likely that the tradeoffs between speed and accuracy will not
be the same in different anatomical sites.267 Where possible,
vendors should provide users with the flexibility to adjust
parameter inputs for these efficiency enhancement techniques but implement default values which are conservative,
i.e., accurate in all situations.
V.B.3. Dose prescriptions
Vendors are strongly discouraged from using single voxel
共point兲 doses for dose prescription and monitor unit calculations in their MC-based treatment planning systems. Rather,
doses should be prescribed to volumes larger than a single
voxel, such as the volume contained by an isodose surface.
Current users of MC-based planning systems are encouraged
to find ways of circumventing point-based dose prescriptions
if their systems are not flexible enough to allow otherwise.
V.B.4. CT-to-material conversions
The use of conversion techniques based purely on mass
density 共i.e., assuming the only patient material is water, but
with varying density兲, as employed in conventional algorithms, is discouraged with MC simulation because these
methods ignore dependencies of particle interactions on the
materials, which can lead to notable discrepancies in high
atomic number materials. The conversions should include the
use of both mass density and the atomic compositions of the
materials. Appropriate documentation on the CT number-tomaterial conversion method used by the software should be
accessible to the user.
V.B.5. Dose-to-water and dose-to-medium
MC dose results should: 共a兲 explicitly indicate the material to which the dose is computed, 共b兲 allow conversion
between Dm and Dw using the methods discussed in Sec.
Medical Physics, Vol. 34, No. 12, December 2007

4847

III D 4, or other methods as developed in future investigations. It is strongly encouraged that appropriate documentation on the dose-to-water conversion method used by the
software be provided to the user.
V.C. Experimental verification

V.C.1. Examples of specific tests
In addition to the standard testing necessary for conventional dose algorithms, it is strongly recommended that additional tests 共e.g., as suggested in Sec. III E 3兲 be included
to evaluate the accuracy of MC calculations under situations
where the MC method is known to perform better than conventional algorithms.
V.C.2. Verification calculations
MC verification calculations should be performed under
the same conditions as the experiments. Phantoms used
should be CT-imaged for planning purposes. Statistical uncertainties for verification plans should be reported and included in the comparison of calculations with measurements.
More studies of the influence of detector perturbations using
MC calculations are encouraged.
V.C.3. Measurement uncertainties
It is important for the user to understand the limitations of
the various measurement devices as they are used in different
situations. It is recommended that realistic measurement uncertainties be assessed and included when evaluating MC
verification calculations against measurements.
Although the implementation of MC treatment planning
will require clinical physicists to once again understand a
new technology, one should view this in a positive light.
Properly implemented MC algorithms will provide dose calculation with sufficient accuracy 共in at least a single instance
of the patient geometry兲 such that dose calculation is no
longer a source of meaningful uncertainty in the radiotherapy
planning process. In addition, although the details are sometimes complex, the underlying idea of simulating the actual
transport of individual particles is simpler to understand than
many other algorithms because it is based on actual physical
processes familiar to the medical physicist. Finally, this may
well be the last new dose calculation algorithm that medical
physicists will need to learn since MC techniques provide the
highest level of accuracy for dose calculations in radiotherapy treatment planning.
ACKNOWLEDGMENTS
I.J.C. acknowledges the support of his colleagues, in particular, Dick Fraass, Daniel McShan, and Randy Ten Haken,
at the University of Michigan, Department of Radiation Oncology. Thanks to Neelam Tyagi and Mihaela Rosu for their
help with compiling references. We are grateful to Lesley
Buckley, Dan La Russa, and Randy Taylor of Carleton University for commenting on early versions of the manuscript.
I.J.C. is thankful to Alex Bielajew for helpful discussions on
various topics in this report. I.J.C. acknowledges the support

4848

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

of NIH Grant Nos. R01CA106770 共UNMC兲 and
P01CA59827 共previously at the University of Michigan兲.
D.W.O.R. is supported by the Canada Research Chairs program and the Natural Sciences and Engineering Research
Council of Canada. B.A.F. acknowledges the support of NIH
Grant No. R01CA104777. J.V.S. acknowledges the support
of NIH Grant No. R01CA98524. J. S. is a research scientist
of the National Cancer Institute Canada supported with funds
from the Canadian Cancer Society. Finally, we are indebted
to Alan Nahum for his careful review of this report which
helped us improve the pedagogical aspects and other topics
significantly.
a兲

Electronic mail: ichetty@unmc.edu
N. Papanikolaou, J. Battista, A. Boyer, C. Kappas, E. Klein, T. Mackie,
M. Sharpe, and J. Van Dyk, “AAPM Report No. 85: Tissue inhomogeneity corrections for megavoltage photon beams,” in AAPM Report No. 85
共Medical Physics, Madison, WI, 2004兲, pp. 1–135.
2
A. Dutreix, “When and how can we improve precision in radiotherapy?,”
Radiother. Oncol. 2, 275–292 共1984兲.
3
C. G. Orton, P. M. Mondalek, J. T. Spicka, D. S. Herron, and L. I. Andres,
“Lung corrections in photon beam treatment planning: Are we ready?,”
Int. J. Radiat. Oncol. Biol. Phys. 10, 2191–2199 共1984兲.
4
J. G. Stewart and A. W. Jackson, “The steepness of the dose response
curve both for tumor cure and normal tissue injury,” Laryngoscope 85,
1107–1111 共1975兲.
5
M. Goitein and J. Busse, “Immobilization error: Some theoretical considerations,” Radiology 117, 407–412 共1975兲.
6
http://eom.springer.de/B/b017750.htm
7
N. Metropolis, “The beginning of the MC Method,” Los Alamos Sci. 15,
125–130 共1987兲; see http://library.lanl.gov/la-pubs/00326866.pdf.
8
D. W. O. Rogers and A. F. Bielajew, in The Dosimetry of Ionizing Radiation, edited by B. Bjarngard, K. Kase, and F. Attix 共Academic, New
York, 1990兲, Vol. III, pp. 427–539.
9
M. J. Berger, in Methods in Computational Physics, edited by S. Fernbach, B. Alder, and M. Rothenberg 共Academic, New York, 1963兲, Vol. 1.
10
M. Berger and S. Seltzer, “ETRAN Monte Carlo code system for electron
and photon transport through extended media,” Radiation Shielding Information Center 共RSIC兲 Report CCC-107, Oak Ridge National Laboratory, Oak Ridge, TN, 1973.
11
J. F. Briesmeister, “MCNP—A general Monte Carlo N -particle transport
code, version 4A,” Report LA-12625-M, Los Alamos National Laboratory, Los Alamos, NM, 1993.
12
W. R. Nelson, H. Hirayama, and D. W. O. Rogers, “The EGS4 code
system,” Report SLAC-265, Stanford Linear Accelerator, Stanford, CA,
1985.
13
P. L. Petti, M. S. Goodman, T. A. Gabriel, and R. Mohan, “Investigation
of buildup dose from electron contamination of clinical photon beams,”
Med. Phys. 10, 18–24 共1983兲.
14
R. Mohan, C. Chui, and L. Lidofsky, “Energy and angular distributions of
photons from medical linear accelerators,” Med. Phys. 12, 592–597
共1985兲.
15
M. Udale, “A Monte Carlo investigation of surface doses for broad electron beams,” Phys. Med. Biol. 33, 939–954 共1988兲.
16
R. L. Ford and W. R. Nelson, “The EGS code system—Version 3,” Report SLAC-210, Stanford Linear Accelerator, Stanford, CA, 1978.
17
I. Kawrakow and D. W. O. Rogers, “The EGSnrc code system: Monte
Carlo simulation of electron and photon transport,” Technical Report
PIRS-701, National Research Council of Canada, Ottawa, Ontario, 2000.
18
P. R. Almond, P. J. Biggs, B. M. Coursey, W. F. Hanson, M. S. Huq, R.
Nath, and D. W. O. Rogers, “AAPM’s TG-51 protocol for clinical reference dosimetry of high-energy photon and electron beams,” Med. Phys.
26, 1847–1870 共1999兲.
19
B. A. Faddegon, P. O’Brien, and D. L. Mason, “The flatness of Siemens
linear accelerator x-ray fields,” Med. Phys. 26, 220–228 共1999兲.
20
M. B. Tacke, H. Szymanowski, U. Oelfke, C. Schulze, S. Nuss, E. Wehrwein, and S. Leidenberger, “Assessment of a new multileaf collimator
concept using GEANT4 Monte Carlo simulations,” Med. Phys. 33, 1125–
1132 共2006兲.
1

Medical Physics, Vol. 34, No. 12, December 2007

21

4848

A. Ito, in Monte Carlo Transport of Electrons and Photons, edited by W.
R. Nelson, T. M. Jenkins, A. Rindi, A. E. Nahum, and D. W. O. Rogers
共Plenum, New York, 1988兲, pp. 573–598.
22
A. E. Nahum, in Monte Carlo Transport of Electrons and Photons, edited
by W. R. Nelson, T. M. Jenkins, A. Rindi, A. E. Nahum, and D. W. O.
Rogers 共Plenum, New York, 1988兲, pp. 3–20.
23
D. W. O. Rogers, B. A. Faddegon, G. X. Ding, C. M. Ma, J. We, and T.
R. Mackie, “BEAM: A Monte Carlo code to simulate radiotherapy treatment units,” Med. Phys. 22, 503–524 共1995兲.
24
C.-M. Ma and S. B. Jiang, “Monte Carlo modelling of electron beams
from medical accelerators,” Phys. Med. Biol. 44, R157–R189 共1999兲.
25
F. Verhaegen and J. Seuntjens, “Monte Carlo modelling of external radiotherapy photon beams,” Phys. Med. Biol. 48, R107–R164 共2003兲.
26
J. E. Cygler, G. M. Daskalov, G. H. Chan, and G. X. Ding, “Evaluation of
the first commercial Monte Carlo dose calculation engine for electron
beam treatment planning,” Med. Phys. 31, 142–153 共2004兲.
27
C. L. Hartmann Siantar, “Description and dosimetric verification of the
PEREGRINE Monte Carlo dose calculation system for photon beams incident on a water phantom,” Med. Phys. 28, 1322–1337 共2001兲.
28
P. Andreo, “Monte Carlo techniques in medical radiation physics,” Phys.
Med. Biol. 36, 861–920 共1991兲.
29
D. E. Raeside, “Monte Carlo principles and applications,” Phys. Med.
Biol. 21, 181–197 共1976兲.
30
D. W. O. Rogers, “Fifty years of Monte Carlo simulations for medical
physics,” Phys. Med. Biol. 51, R287–R301 共2006兲.
31
J. E. Turner, H. A. Wright, and R. N. Hamm, “A Monte Carlo primer for
health physicists,” Health Phys. 48, 717–733 共1985兲.
32
F. B. Brown, “MCNP—A general Monte Carlo-particle transport code,
version 5,” Report LA-UR-03 1987, Los Alamos National Laboratory,
Los Alamos, NM, 2003.
33
S. Agostinelli, “GEANT4—A simulation toolkit,” Nucl. Instrum. Methods
Phys. Res. A 506, 250–303 共2003兲.
34
J. Baro, J. Sempau, J. M. Fernandez-Varea, and F. Salvat, “PENELOPE—An
algorithm for Monte-Carlo simulation of the penetration and energy-loss
of electrons and positrons in matter,” Nucl. Instrum. Methods Phys. Res.
A 100, 31–46 共1995兲.
35
M. Fippel, “Fast Monte Carlo dose calculation for photon beams based on
the VMC electron algorithm,” Med. Phys. 26, 1466–1475 共1999兲.
36
I. Kawrakow, “VMC++ , electron and photon Monte Carlo calculations
optimized for radiation treatment planning,” in Advanced Monte Carlo for
Radiation Physics, Particle Transport Simulation and Applications: Proceedings of the Monte Carlo 2000 Meeting Lisbon, edited by A. Kling, F.
Barao, M. Nakagawa, L. Tavora, and P. Vaz 共Springer, Berlin, 2001兲, pp.
229–236.
37
I. Kawrakow, M. Fippel, and K. Friedrich, “3D electron dose calculation
using a Voxel based Monte Carlo algorithm 共VMC兲,” Med. Phys. 23, 445–
457 共1996兲.
38
H. Neuenschwander and E. J. Born, “A macro Monte-Carlo method for
electron-beam dose calculations,” Phys. Med. Biol. 37, 107–125 共1992兲.
39
J. Sempau, S. J. Wilderman, and A. F. Bielajew, “DPM, a fast, accurate
Monte Carlo code optimized for photon and electron radiotherapy treatment planning dose calculations,” Phys. Med. Biol. 45, 2263–2291
共2000兲.
40
I. Kawrakow, “Accurate condensed history Monte Carlo simulation of
electron transport. I. EGSnrc, the new EGS4 version,” Med. Phys. 27,
485–498 共2000兲.
41
A. F. Bielajew and D. W. O. Rogers, in Monte Carlo Transport of Electrons and Photons, edited by W. R. Nelson, T. M. Jenkins, A. Rindi, A. E.
Nahum, and D. W. O. Rogers 共Plenum, New York, 1988兲, pp. 115–137.
42
I. Kawrakow and A. F. Bielajew, “On the condensed history technique for
electron transport,” Nucl. Instrum. Methods Phys. Res. B 142, 253–280
共1998兲.
43
E. W. Larsen, “A theoretical derivation of the condensed history algorithm,” Ann. Nucl. Energy 19, 701–714 共1992兲.
44
I. Kawrakow, “Accurate condensed history Monte Carlo simulation of
electron transport. II. Application to ion chamber response simulations,”
Med. Phys. 27, 499–513 共2000兲.
45
I. Kawrakow and M. Fippel, “Investigation of variance reduction techniques for Monte Carlo photon dose calculation using XVMC,” Phys. Med.
Biol. 45, 2163–2183 共2000兲.
46
I. Kawrakow, D. W. O. Rogers, and B. R. B. Walters, “Large efficiency
improvements in BEAMnrc using directional bremsstrahlung splitting,”
Med. Phys. 31, 2883–2898 共2004兲.

4849

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

47

I. Kawrakow and B. R. B. Walters, “Efficient photon beam dose calculations using DOSXYZnrc with BEAMnrc,” Med. Phys. 33, 3046–3056
共2006兲.
48
B. Fraass, K. Doppke, M. Hunt, G. Kutcher, G. Starkschall, R. Stern, and
J. Van Dyke, “American Association of Physicists in Medicine Radiation
Therapy Committee Task Group 53: Quality assurance for clinical radiotherapy treatment planning,” Med. Phys. 25, 1773–1829 共1998兲.
49
IAEA-Technical Report Series No. 430: Commissioning and quality qssurance of computerized planning systems for radiation treatment of cancer,” in International Atomic Energy Agency, Vienna, 2004.
50
J. Van Dyk, R. B. Barnett, J. E. Cygler, and P. C. Shragge, “Commissioning and quality assurance of treatment planning computers,” Int. J. Radiat.
Oncol. Biol. Phys. 26, 261–273 共1993兲.
51
D. W. O. Rogers and A. F. Bielajew, in Monte Carlo Transport of Electrons and Photons, edited by W. R. Nelson, T. M. Jenkins, A. Rindi, A. E.
Nahum, and D. W. O. Rogers 共Plenum, New York, 1988兲, pp. 407–419.
52
I. Kawrakow, “On the efficiency of photon beam treatment head simulations,” Med. Phys. 32, 2320–2326 共2005兲.
53
C.-M. Ma et al., “A Monte Carlo dose calculation tool for radiotherapy
treatment planning,” Phys. Med. Biol. 47, 1671–1689 共2002兲.
54
J. A. Halbleib, in Monte Carlo Transport of Electrons and Photons, edited
by W. R. Nelson, T. M. Jenkins, A. Rindi, A. E. Nahum, and D. W. O.
Rogers 共Plenum, New York, 1988兲, pp. 249–262.
55
J. A. Halbleib and T. A. Melhorn, “ITS: The integrated TIGER series of
coupled electron/photon Monte Carlo transport codes,” Sandia Report
SAND84–0573, Sandia National Laboratory, Albuquerque, NM, 1984.
56
S. M. Seltzer, in Monte Carlo Transport of Electrons and Photons, edited
by W. R. Nelson, T. M. Jenkins, A. Rindi, A. E. Nahum, and D. W. O.
Rogers 共Plenum, New York, 1988兲, pp. 153–182.
57
D. W. O. Rogers, B. Walters, and I. Kawrakow, “BEAMnrc Users
Manual,” NRC Report PIRS 509共a兲revH, 2004.
58
B. R. B. Walters and D. W. O. Rogers, “DOSXYZnrc Users Manual,”
NRC Report PIRS 794 共rev B兲, 2004.
59
D. W. O. Rogers, “The role of Monte-Carlo simulation of electrontransport in radiation-dosimetry,” Appl. Radiat. Isot. 42, 965–974 共1991兲.
60
T. R. Mackie, S. S. Kubsad, D. W. O. Rogers, and A. F. Bielajew, “The
OMEGA project: Electron dose planning using Monte Carlo simulation,”
Med. Phys. 17, 730 共abstract兲 共1990兲.
61
J. Siebers and R. Mohan, “Monte Carlo and IMRT,” in Intensity Modulated Radiation Therapy, The State of the Art, Proceedings of the 2003
AAPM Summer School, edited by T. R. Mackie and J. R. Palta 共Advanced
Medical, Madison, WI, 2003兲, pp. 531–560.
62
A. Leal, F. Sanchez-Doblado, R. Arrans, M. Perucha, M. Rincon, E.
Carrasco, and C. Bernal, “Monte Carlo simulation of complex radiotherapy treatments,” Comput. Sci. Eng. 6, 60–68 共2004兲.
63
N. Tyagi, A. Bose, and I. J. Chetty, “Implementation of the DPM Monte
Carlo Code on a parallel architecture for treatment planning applications,”
Med. Phys. 31, 2721–2725 共2004兲.
64
J. M. Fernandez-Varea, R. Mayol, J. Baro, and F. Salvat, “On the theory
and simulation of multiple elastic-scattering of electrons,” Nucl. Instrum.
Methods Phys. Res. B 73, 447–473 共1993兲.
65
A. E. Schach von Wittenau, L. J. Cox, P. M. Bergstrom, Jr., W. P. Chandler, C. L. Hartmann Siantar, and R. Mohan, “Correlated histogram representation of Monte Carlo derived medical accelerator photon-output
phase space,” Med. Phys. 26, 1196–1211 共1999兲.
66
A. E. Schach von Wittenau, P. M. Bergstrom, Jr., and L. J. Cox, “Patientdependent beam-modifier physics in Monte Carlo photon dose calculations,” Med. Phys. 27, 935–947 共2000兲.
67
I. Kawrakow, “Electron transport: Multiple and plural scattering,” Nucl.
Instrum. Methods Phys. Res. B 108, 23–34 共1996兲.
68
I. Kawrakow and A. F. Bielajew, “Recent improvements and accuracy
tests of the VOXEL Monte Carlo algorithm,” Med. Phys. 24, 1049 共abstract兲 共1997兲.
69
P. J. Keall and P. W. Hoban, “Superposition dose calculation incorporating Monte Carlo generated electron track kernels,” Med. Phys. 23, 479–
485 共1996兲.
70
L. Wang, C. S. Chui, and M. Lovelock, “A patient-specific Monte Carlo
dose-calculation method for photon beams,” Med. Phys. 25, 867–878
共1998兲.
71
R. Doucet, M. Olivares, F. DeBlois, E. B. Podgorsak, I. Kawrakow, and J.
Seuntjens, “Comparison of measured and Monte Carlo calculated dose
distributions in inhomogeneous phantoms in clinical electron beams,”
Phys. Med. Biol. 48, 2339–2354 共2003兲.
Medical Physics, Vol. 34, No. 12, December 2007

72

4849

M. Fippel, “Efficient particle transport simulation through beam modulating devices for Monte Carlo treatment planning,” Med. Phys. 31, 1235–
1242 共2004兲.
73
M. Fippel, F. Haryanto, O. Dohm, F. Nusslin, and S. Kriesen, “A virtual
photon energy fluence model for Monte Carlo dose calculation,” Med.
Phys. 30, 301–311 共2003兲.
74
M. Fippel, I. Kawrakow, and K. Friedrich, “Electron beam dose calculations with the VMC algorithm and the verification data of the NCI working
group,” Phys. Med. Biol. 42, 501–520 共1997兲.
75
M. Fippel, W. Laub, B. Huber, and F. Nusslin, “Experimental investigation of a fast Monte Carlo photon beam dose calculation algorithm,”
Phys. Med. Biol. 44, 3039–3054 共1999兲.
76
M. Fippel and F. Nusslin, “Evaluation of a clinical Monte Carlo dose
calculation code based on the ICCR benchmark test,” Med. Phys. 28, 1198
共abstract兲 共2001兲.
77
I. Kawrakow and A. F. Bielajew, “On the representation of electron multiple elastic-scattering distributions for Monte Carlo calculations,” Nucl.
Instrum. Methods Phys. Res. B 134, 325–336 共1998兲.
78
H. Neuenschwander, T. R. Mackie, and P. J. Reckwerdt, “MMC—A highperformance Monte Carlo code for electron beam treatment planning,”
Phys. Med. Biol. 40, 543–574 共1995兲.
79
C. Cris, E. Born, R. Mini, H. Neuenschwander, and W. Volken, “A scaling
method for multiple source models,” in Proceedings of the 13th ICCR,
edited by T. Bortfeld and W. Schlegel 共Springer-Verlag, Heidelberg,
2000兲, pp. 411–413.
80
P. Pemler, J. Besserer, U. Schneider, and H. Neuenschwander, “Evaluation of a commercial electron treatment planning system based on Monte
Carlo techniques 共eMC兲,” Z. Med. Phys. 16, 313–329 共2006兲.
81
C.-M. Ma, J. S. Li, T. Pawlicki, S. B. Jiang, and J. Deng, “MCDOSE—A
Monte Carlo dose calculation tool for radiation therapy treatment planning,” in Proceedings of the 13th ICCR, edited by T. Bortfeld and W.
Schlegel 共Springer-Verlag, Heidelberg, 2000兲, pp. 411–413.
82
J. V. Siebers, P. J. Keall, J. Kim, and R. Mohan, “Performance benchmarks of the MCV Monte Carlo System,” in Proceedings of the 13th
ICCR, edited by T. Bortfeld and W. Schlegel 共Springer-Verlag, Heidelberg, 2000兲, pp. 129–131.
83
J. V. Siebers, P. J. Keall, J. O. Kim, and R. Mohan, “A method for photon
beam Monte Carlo multileaf collimator particle transport,” Phys. Med.
Biol. 47, 3225–3249 共2002兲.
84
I. J. Chetty, P. M. Charland, N. Tyagi, D. L. McShan, B. A. Fraass, and A.
F. Bielajew, “Photon beam relative dose validation of the DPM Monte
Carlo code in lung-equivalent media,” Med. Phys. 30, 563–573 共2003兲.
85
I. J. Chetty, N. Tyagi, M. Rosu, P. M. Charland, D. L. McShan, R. K. Ten
Haken, B. A. Fraass, and A. F. Bielajew, “Clinical implementation, validation and use of the DPM Monte Carlo code for radiotherapy treatment
planning,” in Nuclear Mathematical and Computational Sciences: A Century in Review, A Century Anew, Gatlinburg, TN 共American Nuclear Society, LaGrange Park, IL, 2003兲, Vol. 119, pp. 1–17.
86
J. J. DeMarco, T. D. Solberg, and J. B. Smathers, “A CT-based Monte
Carlo simulation tool for dosimetry planning and analysis,” Med. Phys.
25, 1–11 共1998兲.
87
R. F. Aaronson, J. J. DeMarco, I. J. Chetty, and T. D. Solberg, “A Monte
Carlo based phase space model for quality assurance of intensity modulated radiotherapy incorporating leaf specific characteristics,” Med. Phys.
29, 2952–2958 共2002兲.
88
I. Chetty, J. J. DeMarco, and T. D. Solberg, “A virtual source model for
Monte Carlo modeling of arbitrary intensity distributions,” Med. Phys.
27, 166–172 共2000兲.
89
I. J. Chetty, J. J. DeMarco, T. D. Solberg, A. R. Arellano, R. Fogg, and A.
V. Mesa, “A phase space model for simulating arbitrary intensity distributions for shaped radiosurgery beams using the Monte Carlo method,”
Radiosurgery 3, 41–52 共2000兲.
90
T. D. Solberg et al., “A review of radiation dosimetry applications using
the MCNP Monte Carlo code,” Radiochim. Acta 89, 337–355 共2001兲.
91
T. D. Solberg, J. J. DeMarco, F. E. Holly, J. B. Smathers, and A. A. F.
DeSalles, “Monte Carlo treatment planning for stereotactic radiosurgery,”
Radiother. Oncol. 49, 73–84 共1998兲.
92
M. K. Fix, P. Manser, E. J. Born, R. Mini, and P. Ruegsegger, “Monte
Carlo simulation of a dynamic MLC based on a multiple source model,”
Phys. Med. Biol. 46, 3241–3257 共2001兲.
93
M. K. Fix, M. Stampanoni, P. Manser, E. J. Born, R. Mini, and P. Ruegsegger, “A multiple source model for 6 MV photon beam dose calculations using Monte Carlo,” Phys. Med. Biol. 46, 1407–1427 共2001兲.

4850

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

94

E. Poon and F. Verhaegen, “Accuracy of the photon and electron physics
in GEANT4 for radiotherapy applications,” Med. Phys. 32, 1696–1711
共2005兲.
95
J. Sempau, A. Sanchez-Reyes, and F. Salvat, “H. O. ben Tahar, S. B.
Jiang, and J. M. Fernandez-Varea, “Monte Carlo simulation of electron
beams from an accelerator head using PENELOPE,” Phys. Med. Biol. 46,
1163–1186 共2001兲.
96
O. Chibani and X. A. Li, “Monte Carlo dose calculations in homogeneous
media and at interfaces: A comparison between GEPTS, EGSnrc, MCNP, and
measurements,” Med. Phys. 29, 835–847 共2002兲.
97
O. Chibani and C. M. Ma, “Electron depth dose distributions in water,
iron and lead: The GEPTS system,” Nucl. Instrum. Methods Phys. Res. B
101, 357–378 共1995兲.
98
W. van der Zee, A. Hogenbirk, and S. C. van der Marck, “ORANGE: A
Monte Carlo dose engine for radiotherapy,” Phys. Med. Biol. 50, 625–
641 共2005兲.
99
D. W. O. Rogers and R. Mohan, “Questions for comparisons of clinical
Monte Carlo codes,” in Proceedings of the 13th ICCR, edited by T. Bortfeld and W. Schlegel 共Springer-Verlag, Heidelberg, 2000兲, pp. 120–122.
100
B. A. Faddegon and I. Blevis, “Electron spectra derived from depth dose
distributions,” Med. Phys. 27, 514–526 共2000兲.
101
M. R. Bieda, J. A. Antolak, and K. R. Hogstrom, “The effect of scattering
foil parameters on electron-beam Monte Carlo calculations,” Med. Phys.
28, 2527–2534 共2001兲.
102
D. Sheikh-Bagheri and D. W. O. Rogers, “Sensitivity of megavoltage
photon beam Monte Carlo simulations to electron beam and other parameters,” Med. Phys. 29, 379–390 共2002兲.
103
A. Tzedakis, J. E. Damilakis, M. Mazonakis, J. Stratakis, H. Varveris, and
N. Gourtsoyiannis, “Influence of initial electron beam parameters on
Monte Carlo calculated absorbed dose distributions for radiotherapy photon beams,” Med. Phys. 31, 907–913 共2004兲.
104
I. J. Chetty, P. M. Charland, N. Tyagi, D. L. McShan, B. Fraass, and A. F.
Bielajew, “Experimental validation of the DPM Monte Carlo code for photon beam dose calculations in inhomogeneous media,” Med. Phys. 29,
1351 共abstract兲 共2002兲.
105
B. Libby, J. Siebers, and R. Mohan, “Validation of Monte Carlo generated
phase-space descriptions of medical linear accelerators,” Med. Phys. 26,
1476–1483 共1999兲.
106
C. Bramoulle, F. Husson, and J. P. Manens, “Monte Carlo 共PENELOPE
code兲 study of the x-ray beams from SL Linacs 共Elekta兲,” Phys. Med. 16,
107–115 共2000兲.
107
E. L. Chaney, T. J. Cullip, and T. A. Gabriel, “A Monte Carlo study of
accelerator head scatter,” Med. Phys. 21, 1383–1390 共1994兲.
108
G. X. Ding, “Energy spectra, angular spread, fluence profiles and dose
distributions of 6 and 18 MV photon beams: Results of Monte Carlo
simulations for a Varian 2100EX accelerator,” Phys. Med. Biol. 47, 1025–
1046 共2002兲.
109
R. A. C. Siochi, “Requirements for manufacturer supplied data for Monte
Carlo simulation,” in Proceedings of the 15th International Conference
on the Applications of Accelerators in Research and Industry 共The American Institute of Physics, Melville, 1999兲, pp. 1060–1065.
110
G. G. Zhang, D. W. O. Rogers, J. E. Cygler, and T. R. Mackie, “Monte
Carlo investigation of electron beam output factors versus size of square
cutout,” Med. Phys. 26, 743–750 共1999兲.
111
J. A. Antolak, M. R. Bieda, and K. R. Hogstrom, “Using Monte Carlo
methods to commission electron beams: A feasibility study,” Med. Phys.
29, 771–786 共2002兲.
112
B. Faddegon, E. Schreiber, and X. Ding, “Monte Carlo simulation of
large electron fields,” Phys. Med. Biol. 50, 741–753 共2005兲.
113
E. C. Schreiber and B. A. Faddegon, “Sensitivity of large-field electron
beams to variations in a Monte Carlo accelerator model,” Phys. Med.
Biol. 50, 769–778 共2005兲.
114
C.-M. Ma, B. A. Faddegon, D. W. O. Rogers, and T. R. Mackie, “Accurate characterization of Monte Carlo calculated electron beams for radiotherapy,” Med. Phys. 24, 401–416 共1997兲.
115
C.-M. Ma, E. Mok, A. Kapur, T. Pawlicki, D. Findley, S. Brain, K. Forster, and A. L. Boyer, “Clinical implementation of a Monte Carlo treatment planning system,” Med. Phys. 26, 2133–2143 共1999兲.
116
C.-M. Ma and D. W. O. Rogers, “BEAM Characterization: A MultipleSource Model,” NRC Report PIRS-0509共C兲, 1995.
117
C.-M. Ma, “Characterization of computer simulated radiotherapy beams
for Monte-Carlo treatment planning,” Radiat. Phys. Chem. 53, 329–344
共1998兲.
Medical Physics, Vol. 34, No. 12, December 2007

118

4850

J. Deng, S. B. Jiang, A. Kapur, J. Li, T. Pawlicki, and C. M. Ma, “Photon
beam characterization and modelling for Monte Carlo treatment planning,” Phys. Med. Biol. 45, 411–427 共2000兲.
119
B. Faddegon, J. Balogh, R. Mackenzie, and D. Scora, “Clinical considerations of Monte Carlo for electron radiotherapy treatment planning,” Radiat. Phys. Chem. 53, 217–227 共1998兲.
120
M. K. Fix, H. Keller, P. Ruegsegger, and E. J. Born, “Simple beam models for Monte Carlo photon beam dose calculations in radiotherapy,”
Med. Phys. 27, 2739–2747 共2000兲.
121
S. B. Jiang, A. Kapur, and C. M. Ma, “Electron beam modeling and
commissioning for Monte Carlo treatment planning,” Med. Phys. 27,
180–191 共2000兲.
122
S. B. Jiang, J. Deng, J. Li, P. Pawlicki, A. Boyer, and C.-M. Ma, “Modeling and commissioning of clinical photon beams for Monte Carlo treatment planning,” in Proceedings of the 13th ICCR, edited by T. Bortfeld
and W. Schlegel 共Springer-Verlag, Heidelberg, 2000兲, pp. 434–436.
123
J. Deng, S. B. Jiang, P. Pawlicki, J. Li, and C.-M. Ma, “Electron beam
commissioning for Monte Carlo dose calculation,” in Proceedings of the
13th ICCR, edited by T. Bortfeld and W. Schlegel 共Springer-Verlag,
Heidelberg, 2000兲, pp. 431–433.
124
J. S. Li et al., “Source modeling and beam commissioning for Siemens
photon beams,” Med. Phys. 29, 1230 共abstract兲 共2002兲.
125
J. Yang, J. S. Li, L. Qin, W. Xiong, and C. M. Ma, “Modelling of electron
contamination in clinical photon beams for Monte Carlo dose calculation,” Phys. Med. Biol. 49, 2657–2673 共2004兲.
126
J. Deng, T. Guerrero, C. M. Ma, and R. Nath, “Modelling 6 MV photon
beams of a stereotactic radiosurgery system for Monte Carlo treatment
planning,” Phys. Med. Biol. 49, 1689–1704 共2004兲.
127
J. Deng, S. B. Jiang, T. Pawlicki, J. Li, and C. M. Ma, “Derivation of
electron and photon energy spectra from electron beam central axis depth
dose curves,” Phys. Med. Biol. 46, 1429–1449 共2001兲.
128
J. J. Janssen, E. W. Korevaar, L. J. van Battum, P. R. Storchi, and H.
Huizenga, “A model to determine the initial phase space of a clinical
electron beam from measured beam data,” Phys. Med. Biol. 46, 269–286
共2001兲.
129
S. Siljamaki, L. Tillikainen, H. Helminen, and J. Pyyry, “Determining
parameters for a multiple-source model of a linear accelerator using optimization techniques,” Med. Phys. 32, 2113 共abstract兲 共2005兲.
130
W. Ulmer, J. Pyyry, and W. Kaissl, “A 3D photon superposition/
convolution algorithm and its foundation on results of Monte Carlo calculations,” Phys. Med. Biol. 50, 1767–1790 共2005兲.
131
K. Aljarrah, G. C. Sharp, T. Neicu, and S. B. Jiang, “Determination of the
initial beam parameters in Monte Carlo linac simulation,” Med. Phys. 33,
850–858 共2006兲.
132
A. Ahnesjo and P. Andreo, “Determination of effective bremsstrahlung
spectra and electron contamination for photon dose calculations,” Phys.
Med. Biol. 34, 1451–1464 共1989兲.
133
A. Ahnesjo and A. Trepp, “Acquisition of the effective lateral energy
fluence distribution for photon beam dose calculations by convolution
models,” Phys. Med. Biol. 36, 973–985 共1991兲.
134
A. Ahnesjo, L. Weber, A. Murman, M. Saxner, I. Thorslund, and E.
Traneus, “Beam modeling and verification of a photon beam multisource
model,” Med. Phys. 32, 1722–1737 共2005兲.
135
A. Catala, P. Francois, J. Bonnet, and C. Scouarnec, “Reconstruction of
12 MV bremsstrahlung spectra from measured transmission data by direct
resolution of the numeric system AF = T ,” Med. Phys. 22, 3–10 共1995兲.
136
P. M. Charland, I. J. Chetty, L. D. Paniak, B. P. Bednarz, and B. A.
Fraass, “Enhanced spectral discrimination through the exploitation of interface effects in photon dose data,” Med. Phys. 31, 264–276 共2004兲.
137
E. Heath and J. Seuntjens, “Development and validation of a BEAMnrc
component module for accurate Monte Carlo modelling of the Varian
dynamic millennium multileaf collimator,” Phys. Med. Biol. 48, 4045–
4063 共2003兲.
138
H. H. Liu, F. Verhaegen, and L. Dong, “A method of simulating dynamic
multileaf collimators using Monte Carlo techniques for intensitymodulated radiation therapy,” Phys. Med. Biol. 46, 2283–2298 共2001兲.
139
N. Tyagi, J. M. Moran, D. W. Litzenberg, A. F. Bielajew, B. A. Fraass,
and I. J. Chetty, “Experimental verification of a Monte Carlo-based MLC
simulation model for IMRT dose calculation,” Med. Phys. 34, 651–663
共2007兲.
140
T. C. Zhu et al., “Output ratios in air: Report of the AAPM Task Group
No. 74,” Med. Phys. 共submitted兲.
141
T. C. Zhu and B. E. Bjarngard, “Head scatter off-axis for megavoltage x

4851

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

rays,” Med. Phys. 30, 533–543 共2003兲.
H. H. Liu, T. R. Mackie, and E. C. McCullough, “A dual source photon
beam model used in convolution/superposition dose calculations for clinical megavoltage x-ray beams,” Med. Phys. 24, 1960–1974 共1997兲.
143
M. B. Sharpe, D. A. Jaffray, J. J. Battista, and P. Munro, “Extrafocal
radiation: A unified approach to the prediction of beam penumbra and
output factors for megavoltage x-ray beams,” Med. Phys. 22, 2065–2074
共1995兲.
144
H. H. Liu, T. R. Mackie, and E. C. McCullough, “Calculating output
factors for photon beam radiotherapy using a convolution/superposition
method based on a dual source photon beam model,” Med. Phys. 24,
1975–1985 共1997兲.
145
M. R. Arnfield, J. V. Siebers, J. O. Kim, Q. Wu, P. J. Keall, and R.
Mohan, “A method for determining multileaf collimator transmission and
scatter for dynamic intensity modulated radiotherapy,” Med. Phys. 27,
2231–2241 共2000兲.
146
H. H. Liu, T. R. Mackie, and E. C. McCullough, “Modeling photon output caused by backscattered radiation into the monitor chamber from
collimator jaws using a Monte Carlo technique,” Med. Phys. 27, 737–744
共2000兲.
147
S. B. Jiang, A. L. Boyer, and C. M. Ma, “Modeling the extrafocal radiation and monitor chamber backscatter for photon beam dose calculation,”
Med. Phys. 28, 55–66 共2001兲.
148
G. X. Ding, “Using Monte Carlo simulations to commission photon beam
output factors—A feasibility study,” Phys. Med. Biol. 48, 3865–3874
共2003兲.
149
B. Parker, A. S. Shiu, and H. H. Liu, “Small-field dosimetry with multiple
detectors and Monte Carlo calculations,” Med. Phys. 29, 1372 共abstract兲
共2002兲.
150
G. X. Ding, “Dose discrepancies between Monte Carlo calculations and
measurements in the buildup region for a high-energy photon beam,”
Med. Phys. 29, 2459–2463 共2002兲.
151
G. X. Ding, C. Duzenli, and N. I. Kalach, “Are neutrons responsible for
the dose discrepancies between Monte Carlo calculations and measurements in the build-up region for a high-energy photon beam?” Phys. Med.
Biol. 47, 3251–3261 共2002兲.
152
W. Abdel-Rahman, J. P. Seuntjens, F. Verhaegen, F. Deblois, and E. B.
Podgorsak, “Validation of Monte Carlo calculated surface doses for
megavoltage photon beams,” Med. Phys. 32, 286–298 共2005兲.
153
I. Kawrakow, “Efficient photon beam treatment head simulations,” Radiother. Oncol. 81, 82 共abstract兲 共2006兲.
154
D. Sheikh-Bagheri, D. W. O. Rogers, C. K. Ross, and J. P. Seuntjens,
“Comparison of measured and Monte Carlo calculated dose distributions
from the NRC linac,” Med. Phys. 27, 2256–2266 共2000兲.
155
I. Kawrakow, “On the effective point of measurement in megavoltage
photon beams,” Med. Phys. 33, 1829–1839 共2006兲.
156
O. Chibani and C. M. Ma, “On the discrepancies between Monte Carlo
dose calculations and measurements for the 18 MV varian photon beam,”
Med. Phys. 34, 1206–1216 共2007兲.
157
W. Feller, An Introduction to Probability Theory and Its Applications, 3rd
ed. 共Wiley, New York, 1967兲, Vol. I.
158
B. R. B. Walters, I. Kawrakow, and D. W. O. Rogers, “History by history
statistical estimators in the BEAM code system,” Med. Phys. 29, 2745–
2752 共2002兲.
159
J. Sempau and A. F. Bielajew, “Towards the elimination of Monte Carlo
statistical fluctuation from dose volume histograms for radiotherapy treatment planning,” Phys. Med. Biol. 45, 131–157 共2000兲.
160
P. J. Keall, J. V. Siebers, R. Jeraj, and R. Mohan, “The effect of dose
calculation uncertainty on the evaluation of radiotherapy plans,” Med.
Phys. 27, 478–484 共2000兲.
161
I. Kawrakow, “The effect of Monte Carlo statistical uncertainties on the
evaluation of dose distributions in radiation treatment planning,” Phys.
Med. Biol. 49, 1549–1556 共2004兲.
162
I. J. Chetty, M. Rosu, M. L. Kessler, B. A. Fraass, R. K. Ten Haken, F. M.
Kong, and D. L. McShan, “Reporting and analyzing statistical uncertainties in Monte Carlo-based treatment planning,” Int. J. Radiat. Oncol. Biol.
Phys. 65, 1249–1259 共2006兲.
163
J. V. Siebers, P. J. Keall, and I. Kawrakow, in The Modern Technology of
Radiation Oncology, edited by J. Van Dyke 共Medical Physics, Madison,
WI, 2005兲, Vol. 2, pp. 91–130.
164
F. M. Buffa and A. E. Nahum, “Monte Carlo dose calculations and radiobiological modelling: Analysis of the effect of the statistical noise of the
dose distribution on the probability of tumour control,” Phys. Med. Biol.
142

Medical Physics, Vol. 34, No. 12, December 2007

4851

45, 3009–3023 共2000兲.
S. B. Jiang, T. Pawlicki, and C. M. Ma, “Removing the effect of statistical
uncertainty on dose-volume histograms from Monte Carlo dose calculations,” Phys. Med. Biol. 45, 2151–2161 共2000兲.
166
J. O. Deasy, “Denoising of electron beam Monte Carlo dose distributions
using digital filtering techniques,” Phys. Med. Biol. 45, 1765–1779
共2000兲.
167
I. Kawrakow, “On the de-noising of Monte Carlo calculated dose distributions,” Phys. Med. Biol. 47, 3087–3103 共2002兲.
168
J. O. Deasy, M. V. Wickerhauser, and M. Picard, “Accelerating Monte
Carlo simulations of radiation therapy dose distributions using wavelet
threshold de-noising,” Med. Phys. 29, 2366–2373 共2002兲.
169
S. J. Pollack and A. F. Bielajew, “Novel algorithms for smoothing global
Monte Carlo noise,” in Proceedings of the Current Topics in Monte Carlo
Treatment Planning: Advanced Workshop, Montreal, CN, edited by F.
Verhaegen and J. Seuntjens, 2004 共unpublished兲.
170
B. Miao, R. Jeraj, S. Bao, and T. R. Mackie, “Adaptive anisotropic diffusion filtering of Monte Carlo dose distributions,” Phys. Med. Biol. 48,
2767–2781 共2003兲.
171
M. Fippel and F. Nusslin, “Smoothing Monte Carlo calculated dose distributions by iterative reduction of noise,” Phys. Med. Biol. 48, 1289–
1304 共2003兲.
172
I. El Naqa et al., “A comparison of Monte Carlo dose calculation denoising techniques,” Phys. Med. Biol. 50, 909–922 共2005兲.
173
C. M. Ma, R. A. Price, Jr., J. S. Li, L. Chen, L. Wang, E. Fourkal, L. Qin,
and J. Yang, “Monitor unit calculation for Monte Carlo treatment planning,” Phys. Med. Biol. 49, 1671–1687 共2004兲.
174
F. C. du Plessis, C. A. Willemse, M. G. Lotter, and L. Goedhals, “The
indirect use of CT numbers to establish material properties needed for
Monte Carlo calculation of dose distributions in patients,” Med. Phys. 25,
1195–1201 共1998兲.
175
C.-M. Ma and D. W. O. Rogers, “BEAMDP Users Manual,” NRC Report
PIRS-0509共D兲, 1995.
176
J. V. Siebers, P. J. Keall, A. E. Nahum, and R. Mohan, “Converting
absorbed dose to medium to absorbed dose to water for Monte Carlo
based photon beam dose calculations,” Phys. Med. Biol. 45, 983–995
共2000兲.
177
ICRU-Report No. 46: Photon, electron, proton and neutron interaction
data for body tissues,” in International Commission on Radiation Units
and Measurements, 1992.
178
F. Verhaegen and S. Devic, “Sensitivity study for CT image use in Monte
Carlo treatment planning,” Phys. Med. Biol. 50, 937–946 共2005兲.
179
M. Bazalova, L. Beaulieu, S. Palefsky, and F. Verhaegen, “Correction of
CT artifacts and its influence on Monte Carlo dose calculations,” Med.
Phys. 34, 2119–2132 共2007兲.
180
C. Reft et al., “Dosimetric considerations for patients with HIP prostheses
undergoing pelvic irradiation. Report of the AAPM Radiation Therapy
Committee Task Group 63,” Med. Phys. 30, 1162–1182 共2003兲.
181
N. Dogan, J. V. Siebers, and P. J. Keall, “Clinical comparison of head and
neck and prostate IMRT plans using absorbed dose to medium and absorbed dose to water,” Phys. Med. Biol. 51, 4967–4980 共2006兲.
182
H. H. Liu, “Dm rather than Dw should be used in Monte Carlo treatment
planning. For the proposition,” Med. Phys. 29, 922–923 共2002兲.
183
M. Goitein, “The cell’s-eye view: assessing dose in four dimensions,” Int.
J. Radiat. Oncol. Biol. Phys. 62, 951–953 共2005兲.
184
M. Fippel and F. Nusslin, “Comments on ‘Converting absorbed dose to
medium to absorbed dose to water for Monte Carlo based photon beam
dose calculations’,” Phys. Med. Biol. 45, L17–L19 共2000兲.
185
J. Siebers, B. Libby, and R. Mohan, “Trust, but verify: Comparison of
MCNP and BEAM Monte Carlo codes for generation of phase space distributions for a Varian 2100C,” Med. Phys. 25, A143 共abstract兲 共1998兲.
186
R. Mohan, M. Arnfield, S. Tong, Q. Wu, and J. Siebers, “The impact of
fluctuations in intensity patterns on the number of monitor units and the
quality and accuracy of intensity modulated radiotherapy,” Med. Phys.
27, 1226–1237 共2000兲.
187
J. O. Kim, J. V. Siebers, P. J. Keall, M. R. Arnfield, and R. Mohan, “A
Monte Carlo study of radiation transport through multileaf collimators,”
Med. Phys. 28, 2497–2506 共2001兲.
188
P. J. Keall, J. V. Siebers, M. Arnfield, J. O. Kim, and R. Mohan, “Monte
Carlo dose calculations for dynamic IMRT treatments,” Phys. Med. Biol.
46, 929–941 共2001兲.
189
J. V. Siebers, M. Lauterbach, P. J. Keall, and R. Mohan, “Incorporating
multi-leaf collimator leaf sequencing into iterative IMRT optimization,”
165

4852

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

Med. Phys. 29, 952–959 共2002兲.
L. Wang, E. Yorke, and C. S. Chui, “Monte Carlo evaluation of 6 MV
intensity modulated radiotherapy plans for head and neck and lung treatments,” Med. Phys. 29, 2705–2717 共2002兲.
191
C.-M. Ma et al., “Monte Carlo verification of IMRT dose distributions
from a commercial treatment planning optimization system,” Phys. Med.
Biol. 45, 2483–2495 共2000兲.
192
T. Pawlicki and C. M. Ma, “Monte Carlo simulation for MLC-based
intensity-modulated radiotherapy,” Med. Dosim. 26, 157–168 共2001兲.
193
P. Francescon, S. Cora, and P. Chiovati, “Dose verification of an IMRT
treatment planning system with the BEAM EGS4-based Monte Carlo code,”
Med. Phys. 30, 144–157 共2003兲.
194
M. Rincon et al., “Monte Carlo conformal treatment planning as an independent assessment,” in Advanced Monte Carlo for Radiation Physics:
Proceedings of the Monte Carlo 2000 Meeting, Lisbon, edited by A.
Kling et al. 共Springer-Verlag, Berlin, 2001兲, pp. 565–570.
195
R. Jeraj, P. J. Keall, and J. V. Siebers, “The effect of dose calculation
accuracy on inverse treatment planning,” Phys. Med. Biol. 47, 391–407
共2002兲.
196
N. Reynaert et al., “The importance of accurate linear accelerator head
modelling for IMRT Monte Carlo calculations,” Phys. Med. Biol. 50,
831–846 共2005兲.
197
W. Laub, M. Alber, M. Birkner, and F. Nusslin, “Monte Carlo dose computation for IMRT optimization,” Phys. Med. Biol. 45, 1741–1754
共2000兲.
198
N. Dogan, J. V. Siebers, P. J. Keall, F. Lerma, Y. Wu, M. Fatyga, J. F.
Williamson, and R. K. Schmidt-Ullrich, “Improving IMRT dose accuracy
via deliverable Monte Carlo optimization for the treatment of head and
neck cancers,” Med. Phys. 33, 4033–4055 共2006兲.
199
J. V. Siebers, M. Lauterbach, S. Tong, Q. Wu, and R. Mohan, “Reducing
dose calculation time for accurate iterative IMRT planning,” Med. Phys.
29, 231–237 共2002兲.
200
A. M. Bergman, K. Bush, M. P. Milette, I. A. Popescu, K. Otto, and C.
Duzenli, “Direct aperture optimization for IMRT using Monte Carlo generated beamlets,” Med. Phys. 33, 3666–3679 共2006兲.
201
B. De Smedt, B. Vanderstraeten, N. Reynaert, W. De Neve, and H. Thierens, “Investigation of geometrical and scoring grid resolution for Monte
Carlo dose calculations for IMRT,” Phys. Med. Biol. 50, 4005–4019
共2005兲.
202
J. F. Dempsey, H. E. Romeijn, J. G. Li, D. A. Low, and J. R. Palta, “A
Fourier analysis of the dose grid resolution required for accurate IMRT
fluence map optimization,” Med. Phys. 32, 380–388 共2005兲.
203
J. H. Hubbell, “Review of photon interaction cross section data in the
medical and biological context,” Phys. Med. Biol. 44, R1–R22 共1999兲.
204
D. V. Rao, S. M. Seltzer, and P. M. Bergstrom, Jr., “Compton scattering
cross-sections for individual subshells for a few elements of biological
interest in the energy region 5 keV–10 MeV,” Radiat. Phys. Chem. 70,
479–489 共2004兲.
205
S. M. Seltzer, in Monte Carlo Transport of Electrons and Photons, edited
by W. R. Nelson, T. M. Jenkins, A. Rindi, A. E. Nahum, and D. W. O.
Rogers 共Plenum, New York, 1988兲, pp. 81–114.
206
B. A. Fraass, J. Smathers, and J. Deye, “Summary and recommendations
of a National Cancer Institute workshop on issues limiting the clinical use
of Monte Carlo dose calculation algorithms for megavoltage external
beam radiation therapy,” Med. Phys. 30, 3206–3216 共2003兲.
207
E. R. Epp, A. L. Boyer, and K. P. Doppke, “Underdosing of lesions
resulting from lack of electronic equilibrium in upper respiratory air cavities irradiated by 10 MV x-ray beams,” Int. J. Radiat. Oncol. Biol. Phys.
2, 613–619 共1977兲.
208
M. A. Hunt, G. E. Desobry, B. Fowble, and L. R. Coia, “Effect of lowdensity lateral interfaces on soft-tissue doses,” Int. J. Radiat. Oncol. Biol.
Phys. 37, 475–482 共1997兲.
209
E. E. Klein, L. M. Chin, R. K. Rice, and B. J. Mijnheer, “The influence of
air cavities on interface doses for photon beams,” Int. J. Radiat. Oncol.
Biol. Phys. 27, 419–427 共1993兲.
210
T. R. Mackie, J. W. Scrimger, and J. J. Battista, “A convolution method of
calculating dose for 15-MV x rays,” Med. Phys. 12, 188–196 共1985兲.
211
R. Mohan, C. Chui, and L. Lidofsky, “Differential pencil beam dose
computation model for photons,” Med. Phys. 13, 64–73 共1986兲.
212
C. X. Yu, J. W. Wong, and J. A. Purdy, “Photon dose perturbations due to
small inhomogeneities,” Med. Phys. 14, 78–83 共1987兲.
213
M. R. Arnfield, C. H. Siantar, J. Siebers, P. Garmon, L. Cox, and R.
Mohan, “The impact of electron transport on the accuracy of computed
190

Medical Physics, Vol. 34, No. 12, December 2007

4852

dose,” Med. Phys. 27, 1266–1274 共2000兲.
F. C. du Plessis, C. A. Willemse, M. G. Lotter, and L. Goedhals, “Comparison of the Batho, ETAR and Monte Carlo dose calculation methods in
CT based patient models,” Med. Phys. 28, 582–589 共2001兲.
215
A. O. Jones and I. J. Das, “Comparison of inhomogeneity correction
algorithms in small photon fields,” Med. Phys. 32, 766–776 共2005兲.
216
T. Knoos, E. Wieslander, L. Cozzi, C. Brink, A. Fogliata, D. Albers, H.
Nystrom, and S. Lassen, “Comparison of dose calculation algorithms for
treatment planning in external photon beam therapy for clinical situations,” Phys. Med. Biol. 51, 5785–5807 共2006兲.
217
M. Miften, M. Wiesmeyer, A. Kapur, and C. M. Ma, “Comparison of
RTP dose distributions in heterogeneous phantoms with the BEAM Monte
Carlo simulation system,” J. Appl. Clin. Med. Phys. 2, 21–31 共2001兲.
218
R. Mohan, “Why Monte Carlo?,” in Proceedings of the 12th ICCR, edited
by D. Leavitt 共Medical Physics, Salt Lake City, UT, 1997兲, pp. 16–18.
219
S. N. Rustgi, A. K. Rustgi, S. B. Jiang, and K. M. Ayyangar, “Dose
perturbation caused by high-density inhomogeneities in small beams in
stereotactic radiosurgery,” Phys. Med. Biol. 43, 3509–3518 共1998兲.
220
P. Carrasco et al., “Comparison of dose calculation algorithms in phantoms with lung equivalent heterogeneities under conditions of lateral electronic disequilibrium,” Med. Phys. 31, 2899–2911 共2004兲.
221
J. Coleman, C. Joy, J. E. Park, P. Villarreal-Barajas, P. L. Petti, and B.
Faddegon, “A comparison of Monte Carlo and Fermi–Eyges–Hogstrom
estimates of heart and lung dose from breast electron boost treatment,”
Int. J. Radiat. Oncol. Biol. Phys. 61, 621–628 共2005兲.
222
T. Krieger and O. A. Sauer, “Monte Carlo-versus pencil-beam-/collapsedcone dose calculation in a heterogeneous multi-layer phantom,” Phys.
Med. Biol. 50, 859–868 共2005兲.
223
W. U. Laub, A. Bakai, and F. Nusslin, “Intensity modulated irradiation of
a thorax phantom: Comparisons between measurements, Monte Carlo calculations and pencil beam calculations,” Phys. Med. Biol. 46, 1695–1706
共2001兲.
224
E. Spezi, D. G. Lewis, and C. W. Smith, “Monte Carlo simulation and
dosimetric verification of radiotherapy beam modifiers,” Phys. Med. Biol.
46, 3007–3029 共2001兲.
225
L. Wang, M. Lovelock, and C. S. Chui, “Experimental verification of a
CT-based Monte Carlo dose-calculation method in heterogeneous phantoms,” Med. Phys. 26, 2626–2634 共1999兲.
226
K. De Vlamynck, H. Palmans, F. Verhaegen, C. De Wagter, W. De Neve,
and H. Thierens, “Dose measurements compared with Monte Carlo simulations of narrow 6 MV multileaf collimator shaped photon beams,” Med.
Phys. 26, 1874–1882 共1999兲.
227
G. A. Ezzell et al., “Guidance document on delivery, treatment planning,
and clinical implementation of IMRT: Report of the IMRT Subcommittee
of the AAPM Radiation Therapy Committee,” Med. Phys. 30, 2089–2115
共2003兲.
228
C. G. Orton, P. M. Mondalek, J. T. Spicka, D. S. Herron, and L. I. Andres,
“Benchmark measurements for lung dose corrections for x-ray beams,”
Int. J. Radiat. Oncol. Biol. Phys. 10, 2191–2199 共1984兲.
229
R. K. Rice, B. J. Mijnheer, and L. M. Chin, “Benchmark measurements
for lung dose corrections for x-ray-beams,” Int. J. Radiat. Oncol. Biol.
Phys. 15, 399–409 共1988兲.
230
P. M. Charland, I. J. Chetty, S. Yokoyama, and B. A. Fraass, “Dosimetric
comparison of extended dose range film with ionization measurements in
water and lung equivalent heterogeneous media exposed to megavoltage
photons,” J. Appl. Clin. Med. Phys. 4, 25–39 共2003兲.
231
P. Dunscombe, P. McGhee, and E. Lederer, “Anthropomorphic phantom
measurements for the validation of a treatment planning system,” Phys.
Med. Biol. 41, 399–411 共1996兲.
232
S. Yokoyama, P. L. Roberson, D. L. Litzenberg, J. M. Moran, and B. A.
Fraass, “Surface buildup dose dependence on photon field delivery technique for IMRT,” J. Appl. Clin. Med. Phys. 5, 71–81 共2004兲.
233
T. Kron, A. Elliot, T. Wong, G. Showell, B. Clubb, and P. Metcalfe,
“X-ray surface dose measurements using TLD extrapolation,” Med. Phys.
20, 703–711 共1993兲.
234
B. E. Bjarngard, P. Vadash, and T. Zhu, “Doses near the surface in highenergy x-ray beams,” Med. Phys. 22, 465–468 共1995兲.
235
A. S. Shiu et al., “Verification data for electron beam dose algorithms,”
Med. Phys. 19, 623–636 共1992兲.
236
R. A. Boyd, K. R. Hogstrom, J. A. Antolak, and A. S. Shiu, “A measured
data set for evaluating electron-beam dose algorithms,” Med. Phys. 28,
950–958 共2001兲.
237
K. De Jaeger, M. S. Hoogeman, M. Engelsman, Y. Seppenwoolde, E. M.
214

4853

Chetty et al.: AAPM Task Group Report No. 105: Monte Carlo-based treatment planning

F. Damen, B. J. Mijnheer, L. J. Boersma, and J. V. Lebesque, “Incorporating an improved dose-calculation algorithm in conformal radiotherapy
of lung cancer: Re-evaluation of dose in normal lung tissue,” Radiother.
Oncol. 69, 1–10 共2003兲.
238
I. J. Chetty, M. Rosu, F.-M. Kong, C. Lopez, D. S. Tatro, D. L. McShan,
B. A. Fraass, and R. K. Ten Haken, “On the correlation of dose-volumeresponse using Monte Carlo dose calculation in conformal radiation
therapy of lung cancer,” in Proceedings of the 14th ICCR, edited by B.Y.
Yi, S. D. Ahn, E. K. Choi, and S. W. Ha 共Jeong, Seoul, Korea, 2004兲, pp.
457–460.
239
P. E. Lindsay, I. El Naqa, A. Hope, M. Vicic, J. Cui, J. Bradley, and J. O.
Deasy, “Retrospective Monte Carlo dose calculations with limited beam
weight information,” Med. Phys. 34, 334–346 共2007兲.
240
P. J. Keall, J. Siebers, and R. Mohan, “The impact of Monte Carlo dose
calculations on treatment outcomes,” in Proceedings of the 13th ICCR,
edited by T. Bortfeld and W. Schlegel 共Springer-Verlag, Heidelberg,
2000兲, pp. 425–427.
241
N. Reynaert et al., “Monte Carlo treatment planning for photon and electron beams,” Radiat. Phys. Chem. 76, 643–686 共2007兲.
242
A. Fogliata, E. Vanetti, D. Albers, C. Brink, A. Clivio, T. Knoos, G.
Nicolini, and L. Cozzi, “On the dosimetric behaviour of photon dose
calculation algorithms in the presence of simple geometric heterogeneities: Comparison with Monte Carlo calculations,” Phys. Med. Biol. 52,
1363–1385 共2007兲.
243
T. Knoos, A. Ahnesjo, P. Nilsson, and L. Weber, “Limitations of a pencil
beam approach to photon dose calculations in lung tissue,” Phys. Med.
Biol. 40, 1411–1420 共1995兲.
244
P. N. McDermott, T. He, and A. DeYoung, “Dose calculation accuracy of
lung planning with a commercial IMRT treatment planning system,” J.
Appl. Clin. Med. Phys. 4, 341–351 共2003兲.
245
M. F. Tsiakalos, K. Theodorou, C. Kappas, S. Zefkili, and J. C. Rosenwold, “Analysis of the penumbra enlargement in lung versus the quality
index of photon beams: A methodology to check the dose calculation
algorithm,” Med. Phys. 31, 943–949 共2004兲.
246
E. D. Yorke, L. Wang, K. E. Rosenzweig, D. Mah, J. B. Paoli, and C. S.
Chui, “Evaluation of deep inspiration breath-hold lung treatment plans
with Monte Carlo dose calculation,” Int. J. Radiat. Oncol. Biol. Phys. 53,
1058–1070 共2002兲.
247
R. Timmerman, L. Papiez, R. McGarry, L. Likes, C. DesRosiers, S. Frost,
and M. Williams, “Extracranial stereotactic radioablation: results of a
phase I study in medically inoperable stage I non-small cell lung cancer,”
Chest 124, 1946–1955 共2003兲.
248
L. Wang, E. Yorke, and C. S. Chui, “Monte Carlo evaluation of tissue
inhomogeneity effects in the treatment of the head and neck,” Int. J.
Radiat. Oncol. Biol. Phys. 50, 1339–1349 共2001兲.
249
C. Boudreau, E. Heath, J. Seuntjens, O. Ballivy, and W. Parker, “IMRT
head and neck treatment planning with a commercially available Monte
Carlo based planning system,” Phys. Med. Biol. 50, 879–890 共2005兲.
250
J. Seco, E. Adams, M. Bidmead, M. Partridge, and F. Verhaegen, “Headand-neck IMRT treatments assessed with a Monte Carlo dose calculation
engine,” Phys. Med. Biol. 50, 817–830 共2005兲.
251
C. Martens, N. Reynaert, C. De Wagter, P. Nilsson, M. Coghe, H. Palmans, H. Thierens, and W. De Neve, “Underdosage of the upper-airway
mucosa for small fields as used in intensity-modulated radiation therapy:
A comparison between radiochromic film measurements, Monte Carlo
simulations, and collapsed cone convolution calculations,” Med. Phys.
29, 1528–1535 共2002兲.

Medical Physics, Vol. 34, No. 12, December 2007

252

4853

F. Verhaegen, I. J. Das, and H. Palmans, “Monte Carlo dosimetry study of
a 6 MV stereotactic radiosurgery unit,” Phys. Med. Biol. 43, 2755–2768
共1998兲.
253
F. Sánchez-Doblado et al., “Ionization chamber dosimetry of small photon fields: A Monte Carlo study on stopping-power ratios for radiosurgery
and IMRT beams,” Phys. Med. Biol. 48, 2081–2099 共2003兲.
254
A. Chaves, M. C. Lopes, C. C. Alves, C. Oliveira, L. Peralta, P. Rodrigues, and A. Trindade, “A Monte Carlo multiple source model applied
to radiosurgery narrow photon beams,” Med. Phys. 31, 2192–2204
共2004兲.
255
J. S. Li et al., “Clinical implementation of intensity-modulated tangential
beam irradiation for breast cancer,” Med. Phys. 31, 1023–1031 共2004兲.
256
J. J. DeMarco, I. J. Chetty, and T. D. Solberg, “A Monte Carlo tutorial
and the application for radiotherapy treatment planning,” Med. Dosim.
27, 43–50 共2002兲.
257
A. Leal, F. Sanchez-Doblado, R. Arrans, J. Rosello, E. C. Pavon, and J. I.
Lagares, “Routine IMRT verification by means of an automated Monte
Carlo simulation system,” Int. J. Radiat. Oncol. Biol. Phys. 56, 58–68
共2003兲.
258
G. X. Ding, D. M. Duggan, C. W. Coffey, P. Shokrani, and J. E. Cygler,
“First macro Monte Carlo based commercial dose calculation module for
electron beam treatment planning—New issues for clinical consideration,” Phys. Med. Biol. 51, 2781–2799 共2006兲.
259
D. W. O. Rogers, A. F. Bielajew, and A. E. Nahum, “Monte Carlo calculations of electron beams in standard dose planning geometries,” in Proceedings of the 8th ICCR 共IEEE, New York, 1984兲, pp. 140–144.
260
C. Scherf, J. Scherer, and L. Bogner, “Verification and application of the
Voxel-based Monte Carlo 共VMC++兲 electron dose module of oncentratrade
mark MasterPlan,” Strahlenther. Onkol. 183, 81–88 共2007兲.
261
K. R. Shortt, C. K. Ross, A. F. Bielajew, and D. W. O. Rogers, “Electron
beam dose distributions near standard inhomogeneities,” Phys. Med. Biol.
31, 235–249 共1986兲.
262
E. Wieslander and T. Knoos, “A virtual-accelerator-based verification of a
Monte Carlo dose calculation algorithm for electron beam treatment planning in clinical situations,” Radiother. Oncol. 82, 208–217 共2007兲.
263
J. Cygler, J. J. Battista, J. W. Scrimger, E. Mah, and J. Antolak, “Electron
dose distributions in experimental phantoms: a comparison with 2D pencil beam calculations,” Phys. Med. Biol. 32, 1073–1086 共1987兲.
264
J. A. Hayman et al., “Dose escalation in non-small-cell lung cancer using
three-dimensional conformal radiation therapy: Update of a phase I trial,”
J. Clin. Oncol. 19, 127–136 共2001兲.
265
I. J. Chetty, M. Rosu, D. L. McShan, B. A. Fraass, and R. K. Ten Haken,
“The influence of beam model differences in the comparison of dose
calculation algorithms for lung cancer treatment planning,” Phys. Med.
Biol. 50, 801–815 共2005兲.
266
F. M. Kong, R. K. Ten Haken, M. J. Schipper, M. A. Sullivan, M. Chen,
C. Lopez, G. P. Kalemkerian, and J. A. Hayman, “High-dose radiation
improved local tumor control and overall survival in patients with
inoperable/unresectable non-small-cell lung cancer: Long-term results of
a radiation dose escalation study,” Int. J. Radiat. Oncol. Biol. Phys. 63,
324–333 共2005兲.
267
I. J. Chetty, “Monte Carlo treatment planning: The influence of ‘variance
reduction’ techniques 共ECUT, PCUT, ESTEP兲 on the accuracy and speed
of dose calculations,” Med. Phys. 32, 2018 共abstract兲 共2005兲.
268
www.irs.inms.nrc.ca/inms/irs/papers/iccr00/iccr00.html.
269
E. Heath, McGill University 共personal communication兲.
270
E. Poon and F. Verhaegen, McGill University 共personal communication兲.

